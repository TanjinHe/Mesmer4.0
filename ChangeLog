2015-May-06 Chris Morley

    Fix the use of the internal units (cm-1) when derivedFrom used
    in association with a units= attribute, as reported by Robin.

    * src/Rdouble.cpp,src/Rdouble.h:Add a m_units member to hold the internal units and convert 
    addand in Rdouble::SetUpLinkedVars() (when the value of both m_units is known.)

    * src/gDensityOfStates.cpp: initialize the m_units for ZPE.

    * src/plugins/ExponentialDown.cpp: initialize m_units for m_deltaEDown,
    although cm-1 is currently assumed and is unchecked.

2015-May-04 Struan Robertson

	* MESMER manual.docx: Documentation updates.

2015-May-04 Struan Robertson

	* SensitivityAnalysis.cpp: Improved appearance of data generated for external
	analysis.

2015-May-03 Struan Robertson

	* SensitivityAnalysis.cpp: Fixed incorrect vector allocation that was causing
	a crash.

	* IsomerizationReaction.cpp: Altered calculation of high pressure rate 
	coefficients to improve accuracy.

	* CollisionOperator.cpp: Minor change to data output.
	
	* Update of Win32 QA baselines.	

2015-April-30 Chris Morley

    * src/plugins/ThermodynamicTable.cpp: correct the check for there being
      enough temperature points to fit NASA polynomials.
      
    * mesmer1.xsl: format Cantera thermo in Firefox output for the case
      when there is only one fitted polynomial.

2015-April-28 Struan Robertson

	* Examples.bat/.sh: Update of test shell scripts to include sensitivity analysis
	tests.

2015-April-19 Struan Robertson

	* Marquardt.cpp, FittingUtils.cpp/.h: Removed code duplicate related to gaussian 
	parameter set distribution.

	* SecondOrderAssocReaction.cpp: Altered input so that it now adjusts zero
	point energy of dissociation fragment to reflect second order kinetics.

	* SecondOrderAssocReaction.cpp, MesmerFlags.h/.cpp, CollisionOperator.cpp:
	Added flag to prevent profile calculations for non-linear systems.

2015-April-19 Struan Robertson

	* SensitivityAnalysis.cpp, TMatrix.h: Implementation add to analysis correlated
	parameter input.

2015-April-13 Chris Morley

	* src/main.cpp: add -t and T to online documentation.

	* src/plugins/ExponentialDown.cpp: add "me:deltaEDownTActivation" as a second

	  temperature dependent parameter for deltaEDown.

	* Windows VC12/distribution/NSISScriptToCreateInstaller.nsi: update for v4

	* Windows VC12/distribution/ReadMe.txt: minor text changes

	* src/gDensityOfStates.cpp: add some XML elements used for enthalpy in 
      Openbabel.

2015-April-10 Struan Robertson

	* Various: Minor changes to reduce Linux compiler warnings.

2015-April-09 Struan Robertson

	* SensitivityAnalysis.cpp, TMatrix.h, UnitTests.cpp: Methods added to
	generate correlated sample data.

2015-March-31 Struan Robertson

	* SensitivityAnalysis.cpp: Reading in correlation matrix.

2015-March-29 Struan Robertson

	* SensitivityAnalysis.cpp: Refactoring of private classes.

2015-March-29 Struan Robertson

	* SensitivityAnalysis.cpp: Private class definitions added to help
	with the manipulation of orthogonal functions.

	* PseudoIsomerizationReaction.cpp: Altered to remove unnecessary warning.

2015-March-25 Struan Robertson

	* SensitivityAnalysis.cpp: Addition of Hermite functions.

	* MESMER manual.docx: Updates added on behalf of Chris.

2015-March-25 Chris Morley

    * SensitivityAnalysis.cpp: moved standardDeviation and R_squared in output
      XMLtree. Allow scientific formatting for concentration XML output.

    * examples\i-propyl - SA\pentyl_isomerization_SA.xml: cosmetic changes.
      (Still has a warning message.)

    * mesmer1.xsl: improved Sensitivity Analysis output.

2015-March-23 Struan Robertson

	* SensitivityAnalysis.cpp: Minor change to write out standard deviation
	of predicted quantity.

	* ...\examples\i-propyl - SA\pentyl_isomerization_SA.xml: New example
	added.

2015-March-18 Chris Morley

    * src/plugins/SensitivityAnalysis.cpp: 
    
      changed XML names to initial lc, e.g. me:sensitivityAnalysisSamples
      (but not R_Squared) and gave all the elements me: prefixes.
    
      made <me:sensitivityVarRedMethod> an optional input with a hard-wired
      default = RATIOCONTROL.
    
      moved output <me:R_Squared> to be child of <me:sensitivityAnalysisTable>

    * examples\i-propyl - SA\ipropyl_SA.xml, schemas\mesmerPlugins.xsd: update

    * defaults.xml: added defaults need checking

    * mesmer1.xsl: improved formatting for Sensitivity Analysis output.

2015-March-16 Chris Morley

    * src/gDensityOfStates.cpp,src/gDensityOfStates.h: correct algorithm for
    conversion between computational and thermodynamic. Correct units handling
    in ConvertEnergyConvention().

    * mesmer1.xsl: display for Sensitivity Analysis (unfinished)

2015-March-11 Chris Morley

    * src/gDensityOfStates.cpp: add missing NULL test.  
    
    * src/plugins/ThermodynamicTable.cpp: clear does not empty stringstreams!

    * defaults.xml: add missing default for me:ZPE

    * src/gStructure.cpp: bug in gStructure::GetConstituentAtomThermo()
      NOT YET FIXED 

2015-March-07 Struan Robertson

	* SensitivityAnalysis.cpp: Implementation of both additive and ration control
	variate methods for	variance reduction.

2015-March-04 Struan Robertson

	* SensitivityAnalysis.cpp: Initial implementation of additive control variate 
	method for variance reduction.

2015-March-03 Struan Robertson

	* SensitivityAnalysis.cpp: Refactoring of main sensitivity analysis method.

2015-March-01 Struan Robertson

	* Documentation: Updated "What's New".

2015-March-01 Struan Robertson

	* SensitivityAnalysis.cpp: Added implementation to write indices to
	output .xml.
	
2015-February-28 Struan Robertson

	* UnitTest.cpp: Fix for test break (roll back of 17-Feb-2015 change).

	* SensitivityAnalysis.cpp: R-squared statistic added.
	
2015-February-27 Struan Robertson

	* System.cpp: Fix for Chebyshev test break.
	
2015-February-22 Chris Morley

    * Windows VC12/Mesmer/Mesmer.vcxproj: Debug mesmer.exe now in
    \Windows VC12\Debug\  Release exe still in \Windows VC12\Mesmer\

    * src/plugins/HinderedRotorQM1D.cpp: use only one endl;

2015-February-21 Chris Morley

    * src/gDensityOfStates.cpp: Modify handling of energy conventions;
    thermodynamic298K now used only internally to aid conversion.

    * src/XMLPersist.cpp,src/XMLPersist.h: a default property attribute is
    now achieved by copying attributes; a slightly different entry in
    defaults.xml still allows copying a whole missing property.

    * MesmerQA/UnitTests/UnitTests.xml: Removed specification of the
    molecule energies in the datafile, which are unused. Baseline is
    unchanged.

    * src/gStructure.cpp,src/MoleculeManager.cpp: messages and formatting.

src/plugins/ThermodynamicTable.cpp

2015-February-19 Struan Robertson

	* System.h: Set micro properties re-calculation flag for sensitivity
	analysis.
	
2015-February-17 Struan Robertson

	* SensitivityAnalysis.cpp: Fix for old SA table generation method.
	
2015-February-17 Struan Robertson

	* SensitivityAnalysis.cpp, examples/ipropyl - SA: Baseline update.
	
	* UnitTest.cpp: Fix for multiple output of hindered rotor state values.	
	
2015-February-15 Struan Robertson

	* SensitivityAnalysis.cpp, examples/ipropyl - SA: Improved output text.
	
	* ThermodynamicTable.cpp: Fixed build breaks.	
	
2015-February-15 Chris Morley

    * src/plugins/ThermodynamicTable.cpp: do more in parse phase. Better info
    on why when NASA Polynomials are not produced.

    * src/gDensityOfStates.cpp,src/gDensityOfStates.h,
    src/MoleculeManager.cpp,src/MoleculeManager.h:rationalize energy
    convention by using Hf0 as intermediate. Emphasise a convention attribute
    on <moleculeList> as preferred way to specify.

    * src/System.cpp: set MoleculeManger's PersistPtr earier and handle the
    case when no moleculeList.

    *examples/Butyl_H_to_Butane/Butyl_H_to_Butane.xml,
    examples/i-propyl - SA/ipropyl_SA.xml,examples/i-propyl/ipropyl_LM.xml
    examples/Methoxymethyl/Chebyshev.xml,examples/OH_NO_to HONO/OH_NO_HONO_3Blks.xml
    MesmerQA/i-propyl/ipropyl_reservoir.xml: format and other minor changes

2015-February-08 Struan Robertson

	* SensitivityAnalysis.cpp, examples/ipropyl - SA: Implementation added
	to calculate second order sensitivity indices.	
	
2015-February-07 Chris Morley

    * src/plugins/ThermodynamicTable.cpp: now can output molecular thermo data
    after a normal calculation. Table now written to XML, not .test, file and
    includes enthalpy of formation when available.
    Generate NASA polynomials (from Hf) and the Cantera form of these; output to XML.
    Parse wider range of parameters and a no option default.
    
    * src/gDensityOfStates.cpp,src/gDensityOfStates.h: make mixed thermodynamic
    and computational energy inputs possible. Provide automatic conversion by
    new method. (Hopefully the reference states now correct, but needs checking.)
    Rationalize energy conventions but try not unnecessarybother the user with them.

    * src/gStructure.cpp,src/gStructure.h: rationalize by replacing CalcSumEMinusHf0()
    by GetElementalComposition() and GetConstituentAtomThermo(). Now uses enthalpies
    of formation of constituent atoms.

    * src/MolecularComponents.h,src/Molecule.cpp: static variable and method to
    store energyconvention.

    * src/MoleculeManager.h,src/MoleculeManager.cpp,src/System.cpp: read in
    convention attribute on <moleculeList>. Remove unnecessary check on each
    molecule's convention.

    * src/AssociationReaction.h,src/AssociationReaction.cpp,src/Reaction.h,
    src/ReactionManager.h: work around AssociationReaction changing the values
    of theZPEs of its reactants. Needs a virtual ReactionManager::finish()
    function.

    * src/unitsConversion.h, src/unitsConversion.cpp: add a general
    ConvertEnergy() function.

    * src/plugins/AnalyticalRepresentation.cpp: output result to both XML and
    log file.

    * MesmerQA/ThermodynamicTable/ThermodynamicTable.xml,
    MesmerQA/ThermodynamicTable/baselines/Win32/mesmer.test,
    examples/OH_NO_to HONO/OH_NO_HONO_3Blks.xml: examples for NASA polys etc.
    The mesmer.test file for ThermodynamicTable.xml has been changed to 
    some NASA polynomials - the end of the calculation chain. 

    * defaults.xml,librarymols.xml,mesmer1.xsl,mesmerDiag.xsl,
    schemas/mesmer.xsd,schemas/mesmerPlugins.xsd,schemas/CMLforMesmer.xsd:
    support for above.

2015-February-04 Struan Robertson

	* SensitivityAnalysis.cpp, examples/ipropyl - SA: Implementation added
	toward the calculation of sensitivity indices.	
	
2015-February-04 Chris Morley

    * MesmerGUI/MESMER_deployment: remove Apache files from our SVN files

2015-February-04 Chris Morley

    * MesmerGUI/MESMER_deployment: remove Django files from our SVN files

    * tinyxml/tinyxml.cpp: change default indent when writing from 
      4 to 2 spaces.
	
2015-February-02 Struan Robertson

	* SensitivityAnalysis.cpp, examples/ipropyk - SA: Initial revision of
	code to calculate alpha coefficients.
 	
2015-January-25 Struan Robertson

	* AnalyticalRepresentation.cpp, Reaction.h, Association.h, 
	SecondOrderAssocReaction.h: Methods added to adjust pseudo first order
	rate coefficients to obtain second order coefficients and applied to 
	the analytical representation method.
 	
2015-January-11 Struan Robertson

	* SensitivityAnalysis.cpp, examples/ipropyk - SA: Initial revision of 
	sensitivity analysis example added.
 	
2015-January-02 Struan Robertson

	* CollisionOperator.cpp: Initial implementation of phenomenological 
	rate equation integration method.
 	
2015-January-02 Struan Robertson

	* BoltzmannDistribution.cpp: Altered initial distribution method to 
	allow Boltzmann distribution to use a prescribed temperature. If 
	temperature not specified, the temperature specified by the condition 
	manager will be used.
 	
2014-December-29 Struan Robertson

	* SensitivityAnalysis.cpp: Added Legendre polynomials for the 
	RS-HDMR sensitivity analysis algorithm.
	
2014-December-19 Struan Robertson

	* gDensityOfStates.cpp/.h, QMRotors.cpp: Added warning that heavy 
	asymmetric top states are expensive to calculated using QM methods.
	
2014-October-19 Struan Robertson

	* CollisionOperator.cpp/.h: Added implementation of method to calculate
	equilibrium fractions for systems with a second order reaction.
	
	* ThermodynamicTable.cpp: ALtered so that enthalpy is measured relative to 
	298.15 K value, to allow comparison with JANAF tables.	 

	* Documentation: Content added regarding refReaction keyword.

2014-September-27 Struan Robertson

	* examples/Methyl_H_to_Methane: Added two test files (used in the 
	investigation of back reaction effects). 

2014-September-26 Robin Shannon

	* examples/Methyl_H_to_Methane/Methyl_H_to_Methane_ftst.xml: Restore previous 
	version of file

2014-September-25 Robin Shannon

	* src/MesmerMath.cpp, MesmerMath.cpp, TMatrix.h: Addition of cholesky 
	decomposition and inverse cumulative distribution methods.

	* src/plugins/FittingUtils.cpp, FittingUtils.h, Marquardt.cpp: Printing 
	correlated distribution from fitting marquardt fitting in xml output. 

2014-September-11 Chris Morley

	* src/MolecularComponents.cpp, defaults.xml: remove default ZPE and do
	not require sink products to have a value of ZPE and some other
	properties (unless ILT or some tunnelling).

	* src/BimolecularSinkReaction.cpp,src/IrreversibleExchangeReaction.cpp,
	src/IrreversibleUnimolecularReaction.cpp, src/MicroRate.cpp,mesmer1.xsd:
	No output of reverse canonical rates and Keq if no product energy.

	src/plugins/UnitTests.cpp: ensure DOS is actually calculated when
	calling getCellDensityOfStates().

2014-September-7 Struan Robertson

	* MolecularComponents.cpp/.h, CollisionOperator.cpp/.h, Reaction classes
	and the addition of gWellProperties.h/.cpp: Moved well properties out to
	own set of files as	the template structure was causing build problems on 
	Linux.

	* Updated Linux64 baselines.

2014-September-7 Struan Robertson

	* MolecularComponents.cpp/.h, CollisionOperator.cpp/.h, System.cpp: Changes 
	to allow matrix construction to be done at the specified precision.

2014-September-6 Struan Robertson

	* ThermodynamicTable.cpp: Minor change to thermodynamic table presentation.

2014-September-3 Struan Robertson

	* MolecularComponents.cpp: Corrected the volume factor in translational 
	partition function to give agreement with entropy in JANAF tables.

2014-August-31 Struan Robertson

	* System.cpp: Altered chi-squared method to account for second order 
	stoichiometry factors.

	* QMRotor.cpp, ClassicalRotor.cpp: Corrected calculation of electronic 
	partition functions.

	* Reaction classes: Removed commented TestRateCoeffHeader() code.

2014-August-26 Chris Morley

	* src/MicroRate.cpp: added XML output for me:canonicalRateList (changed
	from me:CanonicalRateList). Units (names also edited) calculated from
	number of reactants and products. Replaces virtual TestRateCoeffHeader().
	Using the reverse rate requires the energy of even sink products to
	be completely specified, which needs consideration.

	* mesmer1.xsl: updated for above

	* src/ReactionManager.cpp, src/Reaction.h: add reaction type names to log
	file.

	* Update Win32 baselines

2014-August-25 Struan Robertson

	* SecondOrderAssocReaction.h/.cpp: Implementation of second order association 
	reactions added.

2014-August-24 Struan Robertson

	* SecondOrderAssocReaction.h/.cpp: New class added to support second order
	reactions.

	* DefinedSumOfStates.cpp: Altered to allow for a variable cellsixe.

	* All reaction class tidied. 

2014-August-19 Struan Robertson

	* MicroRate.cpp, Reaction.h and derived classes: Replaced incorrect high
	pressure rate coefficient calculators in MicroRate.cpp with reaction 
	specific calculators.

	* AssociationRaction.cpp: Corrected cell offset method to account for 
	different cell sizes. 

2014-August-17 Struan Robertson

	* Reaction.h and derived classes: Removed redundant abstract methods from 
	reaction classes.

2014-August-17 Struan Robertson

	* MicroRate.cpp and all classes derived from Reaction.h: Output altered to 
	report reverse high pressure reaction rate coefficients calculated using 
	the equilibrium constant.

2014-Aug-08 Chris Morley

	* Documentation/Constructing a Datafile from Gaussian output.html,
	  examples/makedata.bat, examples/MesmerTemplate.text:
      update with some (but not all) of new datafile format.

	* src/calcmethod.h,src/Crossing.h,src/DensityOfStates.h,src/Distribution.h,
	  src/EnergyTransferModel.h,src/MicroRate.cpp,src/MicroRate.h,
	  src/ParseForPlugin.h,src/Tunneling.h: make typeID public(!) to
	  facilate reinstatement of list of possibilities in doubtful default entry.

	* schemas/mesmer.xsd,schemas/mesmerPlugins.xsd:update and tidy schemas

	* MesmerQA/QA.bat: add -q option in newer cases, for greater reassurance.

2014-August-02 Struan Robertson

	* MesmerILT.cpp, HinderedRotorCM1D.cpp, HinderedRotorQM1D.cpp, ClassicalRotor.cpp,
	DefinedStatesRotor.cpp, Morse.cpp Reaction.cpp/.h: Implementation of variable cell
	size facility to remaining DOS calculators and some micro-flux calculators.

2014-July-29 Struan Robertson

	* Marquardt.cpp. FittingUtil.cpp/.h, TMatrix.h: Fix Methy + H FTST
	example failure and removal of redundant linear algebra code.

	* CollisionOperator.cpp: Bug fix for incorrect counting of absorbed 
	eigenvalues.

2014-July-27 Struan Robertson

	* MesmerTools.cpp/.h, MesmerEnv.cpp and the association reaction classes: 
	Variable cell sizes introduced.

2014-July-20 Struan Robertson

	* MolecularComponent.cpp/.h and DOS classes: More preparatory work for 
	variable cell size implementation.

	* TMatrix.h: Altered so that the LU decomposition is the principal matrix 
	inversion method.

2014-July-13 Chris Morley

	* src/ConditionsManager.cpp,src/ConditionsManager.h,src/Reaction.cpp,
	  src/Reaction.h,src/ReactionManager.cpp,src/ReactionManager.h,src/System.cpp:
	  Option to specify excess reactant concentrations individually on
	  <PTPair>. Data structures are appropriate for the general case of specifying
	  excess reactant concs of different molecules for multiple reactions,
	  but the XML parsing using attributes on <PTPair> allows only a single
	  excess reactant, optionally restricted to specified reaction rather than
	  being applied to all reactions it is the excess reactant. The general case,
	  should it ever be necessary, will require sub-elements, rather than
	  attributes , on <PTPair>.

2014-July-13 Struan Robertson

	* PseudoIsomerizationReaction.cpp, IrreversibleExchangeReaction.cpp, 
	BimolecularSinkReaction.cpp, IrreversibleExchangeReaction: More changes to reaction 
	classes to improve precision.

	* MolecularComponents.cpp/.h: Minor tidy.

2014-July-12 Struan Robertson

	* MolecularComponents.cpp/.h, Associtation.cpp, IrreversibleUnimolecularReaction.cpp:
	Changes to reaction classes to improve precision.

2014-July-09 Struan Robertson

	* MolecularComponents.cpp/.h: Further qd_real changes to gWellProperties methods in
	order to improve precision of eigenvalues.

2014-July-06 Struan Robertson

	* CollisionOperator.cpp/.h, MolecularComponents.cpp/.h: gWellProperties methods altered
	so as to work with qdMatrix type.

2014-July-06 Struan Robertson

	* CollisionOperator.cpp/.h, MolecularComponents.cpp/.h: Further tidying/reduction 
	of gWellProperties methods.

2014-July-03 Struan Robertson

	* CollisionOperator.cpp/.h: Minor changes in preparation for the movement of collision
	matrix construction.

2014-July-03 Struan Robertson

	* MolecularComponents.cpp/.h: More tidying/reduction of gWellProperties methods.

2014-July-01 Struan Robertson

	* MolecularComponents.cpp/.h: Minor tidying of some gWellProperties methods.

2014-June-29 Struan Robertson

	* DensityOfStates.h and all derived classes: Initial plumbing for variable cell sizes.

2014-June-29 Struan Robertson

	* UnitTests.cpp: For the linear algebra test, initialized data within the correct 
	template type constructor to correct errors in the smallest eigenvalue for the 
	dd and qd types, which should both be much closer to zero than 1.e-15.

2014-June-17 Struan Robertson

	* SimpleILT.cpp: Altered the simple ILT method to allow flux to be calculated from 
	the product side.

2014-June-12 Struan Robertson

	* MolecularComponents.cpp/.h: Alterations to reduce the amount of DOS re-calculation.

2014-June-09 Chris Morley

	* src/ConditionsManager.cpp,src/ConditionsManager.h,src/System.cpp, src/System.h:
	Allow one version of System::calculate() to loop for each bath gas mentioned
	in any <conditions> block.
	
	* src/plugins/AnalyticalRepresentation.cpp, schemas/mesmerPlugins.xsd: extra 
	keyword to do the above for Chebyshev fitting.

2014-June-05 Chris Morley

	* src/MolecularComponents.cpp,src/MolecularComponents.h,
	src/plugins/HinderedRotorQM1D.cpp: add gStructure::exportToCML(). Extra
	parameters on various functions to pass in the PersistPtr where XML is written.
	Add ids to conformer molecules.

	* src/XMLPersist.h,src/Persistence.h,src/XMLPersist.cpp: add function to write
	an attribute containing a formatted number. Correct XLMWrite to write text
	when there is an empty element.

	* examples/Butyl_H_to_Butane/Butyl_H_to_Butane.xml: remove unused He to avoid
	error message.

	* schemas/mesmerPlugins.xsd: update

2014-June-01 Struan Robertson

	* MolecularComponents.cpp: Code added to suppress the in writing of the general
	inertia matrix. 
	* Miscellaneous changes relating to VC12.
	* Linux64 baseline updates.

2014-May-31 Struan Robertson

	* HinderedRotorQM1D.cpp, HinderedRotorUtils.cpp, MolecularComponents.cpp/.h:
	Added member datum to account for the phase difference between the configuration 
	coordinates and the potential in the input file. 

2014-May-25 Chris Morley

	* src/System.cpp,src/System.h:enable multiple conditions blocks 
	* src/ConditionsManager.cpp: me:bathgas not essential in a conditions block.
	* schemas/mesmer.xsd: updated

2014-May-18 Struan Robertson

	* MolecularComponents.cpp/.h: Refactoring of the internal rotation vector 
	method.

2014-May-18 Struan Robertson

	* HinderedRotorQM1D.cpp, HinderedRotorCM1D.cpp, MolecularComponents.cpp/.h, 
	MesmerMaths.cpp/.h: Altered to calculate the cosine Fourier coefficients of 
	the reciprocal internal moment of inertia and make them available to the 
	hindered rotor method.

2014-May-11 Struan Robertson

	* MolecularComponents.cpp/.h: Angle dependent GRIT calculated for a fixed 
	number of configurations.

2014-May-04 Struan Robertson

	* HinderedRotorQM1D.cpp, HinderedRotorCM1D.cpp, MolecularComponents.cpp/.h: 
	Refactoring of code between class gstructure and the hindered rotor classes 
	in order to simplify the calculation of an angle dependent GRIT.

2014-April-29 Chris Morley
	* src/plugins/HinderedRotorQM1D.cpp, src/plugins/HinderedRotorCM1D.cpp:
	accept both "useSineTerms" and "UseSineTerms" and "yes", "true", "1" for
	the positive value.

	* src/TMatrix.h: extra #include <cstring> which might help Linux build.
2014-May 15 Chris Morley
	 
	* src/plugins/PriorDistribution.cpp, AcetylPrior.xml: Tidy XML and
	allow EnergyExcess to be a range variable (no apparent problems)
	Still gves BW warning message.

	* schemas/mesmer.xsd, schemas/mesmerPlugins.xsd: update for above
	and extra guidance for names of calcMethods with no data.

2014-April-27 Struan Robertson

	* MolecularComponents.cpp/.h: Update of GRIT algorithm to account for 
	the relative rotation of fragments.

2014-April-26 Chris Morley

	* src/System.cpp, src/System.h: allow multiple <control> blocks. Use
	separate flags for each one, but <molecules>, <reactions>, <parameters>
	and <conditions> are all common.

	* examples/i-propyl/ipropyl_2ContrBlks.xml: example file with fitting and
	 then Chebeshev output.

	* schemas/mesmer.xsd: update schema

2014-April-22 Struan Robertson

	* MolecularComponents.cpp: Fix for bug no. 13 "Internal rotation projection 
	vector incorrect".

2014-April-21 Struan Robertson

	* HinderedRotorQM1D.cpp, HinderedRotorCM1D.cpp, MolecularComponents.cpp/.h, 
	DensityOfStates.h: Initial implementation of GRIT.

2014-April-14 Struan Robertson

	* HinderedRotorQM1D.cpp, HinderedRotorCM1D.cpp, MolecularComponents.cpp/.h: 
	Altered in preparation for the addition the generalized rotational inertia
	tensor.

2014-April-08 Chris Morley

	* src/ConditionsManager.cpp, src/ConditionsManager.h: 
	Windows VC10/Mesmer/Mesmer.vcxprojAdd ConditionsManager class to
	reduce size of System class.

	* src/System.cpp, src/System.h, src/unitsConversion.h: Move conditionSet
	struct and CandTpair. Make CandTpair a struct since now accessed only
	from ConditionsManager.

	* src/plugins/SensitivityAnalysis.cpp: only external change.

2014-March-25 Chris Morley

	* src/plugins/MesmerILT.cpp,src/Reaction.cpp,src/Reaction.h,
	schemas/mesmerPlugins.xsd: Allow <me:ExcessReactantConcentration>
	to be read as a child of MesmerILT as well as a child of Reaction to
	be consistent with old and new XML styles.

	* schemas/CMLforMesmer.xsd: ref and id attributes to have the same
	required regex (brackets in molecule names are acceptable).

2014-March-06 Struan Robertson

	* HinderedRotorQM1D.cpp: Minor changes in order to improve convergence.

	* MESMER manual.docx: Condition specification section (7.3.3) updated.

2014-March-19 Chris Morley

	* src/plugins/PriorDistribution.cpp: make co-fragment molecule during parse
	rather than during calculation - earlier error reporting.

	* MesmerQA/AcetylPrior/AcetylPrior.xml: minor format changes.

2014-March-17 Chris Morley

	* src/System.cpp: Allow attributes of <me:PTPair> and its sub-elements
	to be on the parent <me:PTs> to avoid much repetition. Allow multiple
	<me:PTs>s.

	* defaults.xml: Use the standard defaults method for the neglected <PTset>.

	* mesmer1.xsl, schemas/mesmer.xsd: consequent changes to schema and
	Firefox output.

	* src/main.cpp: log message to give the location of the Mesmer directory.
	It is changed in the Windows Installer via an environment variable.
	I could not understand why my changes to defaults.xml were having no effect.

2014-March-06 Struan Robertson

	* HinderedRotorQM1D.cpp: Further updates for angle dependent internal 
	rotation moment of inertia terms.

2014-March-02 Struan Robertson

	* HinderedRotorQM1D.cpp: Addition of angle dependent internal rotation 
	moment of inertia terms.

	* UnitTest.xml: updated to include ClOOCl example.

2014-March-01 Struan Robertson

	* HinderedRotorQM1D.cpp, HinderedRotorCM1D.cpp, HinderedRotorUtils.cpp/.h: 
	Changes to hindered rotor methods to allow the reading of kinetic energy 
	tensor components.

	* UnitTest.xml: updated to include HOOH example.

2014-March-01 Struan Robertson

	* MESMER manual.docx, System.h: Version changes.

	* Qa.bat, QA.sh: Updated to include AcetylPrior test.

2014-February-21 Robin Shannon

	* Examples\AcetylPrior: Example file added in order to demonstrate
        the prior distribution code

2014-February-16 Struan Robertson

	* MESMER manual.docx: Added content on examples, distribution plots and 
	convergent eigenvalues.

2014-February-14 Struan Robertson

	* CollisionOperator.cpp: Minor change to make eigenvalue convergence 
	warning more visible.

2014-February-09 Struan Robertson

	* MESMER manual.docx: Added documentation corrections from CM and RS.

2014-February-09 Struan Robertson

	* HinderRotorQM1D.cpp: Added methods to locate the minimum in a hindered
	rotor potential and shift the potential so that the minimum is at zero.

	* DensityOfStates.h, HinderRotorQM1D.cpp, Morse.cpp, BeyerSwineehart.cpp:
	Introduce methods for calculating the zero point energy.

2014-January-27 Struan Robertson

	* MESMER manual.docx: Added content on analytical representation and command 
	line options.

2014-January-26 Struan Robertson

	* AnalyticalRepresentation.cpp, System.cpp, unitsConvertsion.cpp/.h: Added 
	precision to analytical representation method.

2014-January-26 Struan Robertson

	* MesmerQA: Update of smoke tests and baseline files to use supported energy
	transfer model syntax.

2014-January-26 Struan Robertson

	* examples: Update of tests and baseline files to use supported energy
	transfer model syntax.

2014-January-21 Struan Robertson

	* src/plugins/AnalyticalRepresentation.cpp: Fix for inverse temperature
	bug.

2014-January-15 Chris Morley

	* src/plugins/AnalyticalRepresentation.cpp: rateUnits attribute on
	  <format> to choose units of output bimolecular rate constants.
	  Correct previous incorrect calculation of bimolecular rates.

	* examples/Methoxymethyl/ChebyshevCK.xml: now outputs in moles units
	* schemas/mesmerPlugins.xsd; update schema

2014-January-14 Struan Robertson

	* MESMER manual.docx: Added documentation for analytical representation.

2014-January-10 Chris Morley

	* src/error.h: StopCTestOutput works only when ErrorLevel is > obDebug,
	  i.e. ctest output is enabled with -w5 option in command or 
	  ChangeErrorLevel e(obDebug); in C++ code if fitting function.

	* src/plugins/fitting.cpp,src/plugins/Marquardt.cpp,
	  src/plugins/SensitivityAnalysis.cpp: ctest output supressed by default.

2013-December-29 Struan Robertson

	* MESMER manual.docx: Added content regarding XML Schema.

2013-December-20 Struan Robertson

	* MolecularComponents.h/.cpp: Minor changes related to the rationalization
	of the reservoir state code.

2013-December-19 Chris Morley

	* src/plugins/AnalyticalRepresentation.cpp: expand reaction strings
	to include all the species for easier pasting to Cantera.

	* src/BimolecularSinkReaction.cpp,src/BimolecularSinkReaction.h,
	src/IrreversibleUnimolecularReaction.cpp,src/IrreversibleUnimolecularReaction.h,
	src/CollisonOperator.cpp: increase possible number of sink products to three.
	
	* src/Reaction.cpp,src/Reaction.h,src/ReactionManager.cpp,
	src/ReactionManager.h,src/CollisionOperator.cpp: add some reasonably
	gereneral functions for reaction strings.

2013-December-14 Struan Robertson

	* AnalyticalRepresentation.cpp: Initial revision of Chemkin format writer.

2013-December-13 Chris Morley

	Fix crash with Methyl_H_to_Methane_FTST.xml
	* src/MolecularComponents.cpp,src/Rdouble.cpp,src/unitsConversion.cpp:
	  Make "units" attribute on me:ZPE optional. On any range variable it
	  is ignored when there is a "derivedFrom" attribute. Provide more
	  meaningful cinfo message.

	Extra functions which may be needed for AnalyticalRepresentation.
	* src/Reaction.cpp,src/Reaction.h,src/AssociationReaction.h,
	  src/BimolecularSinkReaction.h,src/IrreversibleExchangeReaction.h,
	  src/IrreversibleUnimolecularReaction.h,src/IsomerizationReaction.h:
	  Provide a virtual functions to get reactants and to output a reaction
	  string.
	* src/System.h: add getReactionManager()

	MesmerQA/UnitTests/UnitTests.xml: make more schema friendly

2013-December-07 Struan Robertson

	* HinderedRotorQM1D.cpp, UnitTests.cpp, UnitTests.xml: MEIC test 
	for hindered rotors added.

2013-November-19 Chris Morley

	* examplesSchema/Methoxymethyl: Chebyshev.xml modified to be
	  schema-friendly and added to examplesSchema.

	* src/plugins/AnalyticalRepresentation.cpp, defaults.xml:
	  Update parsing and get concentration units from an attribute on either
	  concentration value or from defaults.xml.

	* src/MesmerEnv.cpp, src/plugins/SensitivityAnalysis.cpp: remove 
	  some minor compiler warnings.

2013-November-18 Chris Morley

	* mesmer1.xsl,src/System.cpp: make Firefox output report bath gas
	* schemas/mesmer.xsd,schemas/mesmerPlugins.xsd,schemas/CMLforMesmer.xsd:
	  add derivedFrom, etc.
	* src/MolecularComponents.cpp,src/plugins/ExponentialDown.cpp: label name
	  or general bath gas is always like HONO:deltaEDown without : or :He
	* src/Rdouble.cpp: use derivedFrom as well as me:derivedFrom.

2013-November-12 Chris Morley

	* src/main.cpp,src/MesmerConfig.h: Change QACompare() to use .test files
    with same name as .xml file if the -N option used. 
	-N option now does not need to be before xmlfile name.

	* src/MesmerConfig.h: change baseline  folder name for Windows.
	(Why is there no Linux entry?)

	* MesmerQAschema/QA.bat: subsidiary projects like ipropyl_reservoir.xml
	now checked. NOTE: not altered in MesmerQA folder which I shall soon
	replace with the MesmerQAschema folder.

2013-November-10 Struan Robertson

	* AnalyticalRepresentation.cpp, System.cpp, CollisionOperator.cpp: 
	Altered analytical representation to fit all reaction data, add reaction 
	expression to Cantera output and write Cantera input to .log file. 

	* HinderedRotorQM1D.cpp: Altered output stream of potential data to
	.test file.

2013-November-3 Chris Morley

	* schemas/mesmerPlugins.xsd: add gaussian EnergyTransferModel
	* src/EnergyTransferModel.h, src/plugins/ExponentialDown.cpp: remove
	  ReadParameters(). (Replaced by ParseData()).
	* src/plugins/GaussianModel.cpp: Rewrite parsing to work with old and
	  new formats.
	* examplesSchema/diamond/diamond-expDown.xml,
	  examplesSchema/diamond/diamond-gaussianModel.xml: made schema friendly.

2013-October 31 Robin Shannon
   *src/System.cpp, System.h, CollisionOperator.cpp, CollisionOpperator.h: 
   Changes to the calculate function for the analytical representation. Also added code to get
   Kp matrix from bartis widom analysis. 

   *src/Plugins/AnalyticalRepresentation.cpp:
   Changes to recognise Bimolecular and Ireversible reactions correctly.

2013-October 31 Robin Shannon

	*src/Plugins/DefinedTunnelingCoefficients.cpp: Refactoring and correcting.


	* src/XMLPersist.cpp: Improve default handling for attributes. The
	element name is now also matched. Allows the default units to be
	depent on the context. 
	* defaults.xml: correct PTpair mis-spelling.

2013-October-26 Struan Robertson

	* AnalyticalRepresentation.cpp: Altered analytical representation to 
	allow for different pressure units. 

2013-October-26 Struan Robertson

	* CollisionOperator.cpp, and all derived reaction classes: removed the 
	(temporary) method that got the reduced collision operator size. 

	* MicroRate.h and dreived classes: renamed microcanoical flux method to
	make it clearer what it does.
	
2013-October-25 Struan Robertson

	* CollisionOperator.cpp, and all derived sink reaction classes: Fix for 
	irreversible exchange reaction broken during refactoring. 
	
2013-October-15 Struan Robertson

	* CollisionOperator.cpp, MolecularComponent.h/.cpp and all derived reaction 
	classes: Final refactoring changes to make the code more transparent to 
	reservoir states. 
	
2013-October-13 Struan Robertson

	* AnalyticalRepresentation.cpp: Analytical representation output altered 
	to be consistent with Cantera format. Baselines added.
	
2013-October-12 Struan Robertson

	* CollisionOperator.cpp, MolecularComponent.h/.cpp and all derived reaction 
	classes: More refactoring changes to make the code more transparent to 
	reservoir states. 
	
2013-September-30 Robin Shannon

	*SensitivityAnalysis.cpp, Rdouble.h: Changed SensitvityAnalysis to read
	errors from Rdouble ranges. Rdouble.h changed to allow SensitivityAnalysis
	read upper and lower values.

2013-September-28 Struan Robertson

	* CollisionOperator.cpp, MolecularComponent.h/.cpp: Refactoring changes
	to make the code more transparent to reservoir states. These changes 
	are likely to be the first in a series of changes.
	
2013-September-25 Struan Robertson

	* sobol.h/.cpp: Move sobol array initialization to .cpp file in order to 
	improve compilation time.
	
2013-September 13 Chris Morley

	* src/Reaction.h, src/Molecule.h,.src/plugin.h: remove obsolete Base.h

	* src/MicroRate.h, src/plugins/MesmerILT.cpp: use as plugin example files
	  by adding add verbose comment.

	* src/plugins/LandauZenerCrossingCoeff.cpp,src/plugins/WKBCrossingCoeff.cpp,
	  src/plugins/WKBTunnellingCoefficients.cpp, src/plugins/DefinedTunnelingCoefficients.cpp
	  src/Reaction.cpp, src/MolecularComponents.cpp, src/ParseForPlugin.h:
	  remove two call method of finding data in Reaction or in TS (possible
	  because plugins now have a pointer to a parent object).

2013-September 06 Chris Morley

	Progress towards unifying the parsing of plugin data via ParseForPlugin()
	which scans the XML for a plugin type, makes a new instance, reads its
	data via the plugin's virtual ParseData() function, and inserts defaults.
	Most plugins now work this way but DOS calculators are a little more
	complicated and remain to be done.

	src/ParseForPlugin.h: All plugins given a pointer to a parent which is
	an instance of Molecule, Reaction or System, depending on the plugin type.
	
	src/plugins/ExponentialDown.cpp: Read deltaEDown data in child elements
	of <me:energyTransferModel> (as well as the old way in CML properties).
	The complexity of this class makes it unsuitable as an annotated plugin
	example file which needs to be transferred to another class. 

	Many XML files updated to a schema-friendly format which allows plugin
	data to be validated by the schema. Old format files should still work,
	but use the forms in MesmerQAschema and examplesSchema as models. We'll
	get rid of the original files eventually.

	CMLforMesmer.xsd,mesmer.xsd,mesmerPlugins.xsd: extended and modified but
	still need work to make them more consistent.

2013-August-26 Robin Shannon
	* System.cpp, System.h, AnalyticalRepresentation.cpp: Intial working check-in
	of method to calculate coefficients for a chebyshev polynomial represenation

2013-August-25 Struan Robertson
	
	* CollisionOperator.cpp, System.cpp, MesmerFlags.h/.cpp: Addition
	of keyword me:ForceMacroDetailedBalance, which enforces macroscopic
	detailed balance for non-conservative systems.

2013-August-21 Struan Robertson
	
	* CollisionOperator.cpp: Fix for energy cut-off method based on 
	equilibrium population.

2013-August-18 Struan Robertson
	
	* AnalyticalRepresentation.cpp, ipropyl_AR.xml: Update of parameter
	reading method and example for Chebyshev representation.

2013-August-18 Struan Robertson
	
	* AssociationReaction.cpp/.h, CollisionOperator.cpp/.h, System.cpp: 
	Re-working of method to use the equilibrium population to determine 
	energy cut-off.

	* examples/benzene_oxidation_test.xml: Input file altered to test
	above method.

2013-August-15 Chris Morley

	* src/plugins/DefinedTunnelingCoefficients.cpp: modified for new plugin
	parsing format
	* examplesSchema/DefinedTunellingCoefficients,
	examplesSchema/DefinedTunellingCoefficients/OH+methanol.xml: updated

	* schemas/mesmer.xsd, schemas/mesmerPlugins.xsd: Add SensitivityAnalysis
	DefinedTunnelingCoefficients, + minor tweaks.

	* src/plugins/ExponentialDown.cpp: reversed a change by Struan which
	prevented default being used. But what was the problem it was solving?
	* src/Reaction.cpp: minor comment and text changes

	* src/CollisionOperator.cpp(SetMaximumCellEnergy): replace some doubles by
	unsigned ints to avoid compiler warnings. 

2013-August-11 Struan Robertson
	
	* System.cpp/*.h, SensitivityAnalysis.cpp: Sensitivity analysis plugin
	updated to generated data using Sobol random vectors to perturb fitted
	parameters.

2013-August-10 Struan Robertson
	
	* Sobol.cpp/*.h, UnitTests.cpp: Addition of Sobol random number sequence.

2013-July-28 Struan Robertson
	
	* CollisionOperator.cpp, System.cpp, AnalyticalRepresentation.cpp: 
	Addition of method to calculate rate coefficients in bulk as required
	for analytical representation.

2013-July-27 Struan Robertson
	
	* CollisionOperator.cpp, System.cpp: Bug fix for grain size/grain number
	change with temperature (modified from Robin's original).

2013-July-24 Chris Morley

	Support for new format of plugin data. Not all plugins done yet.
	* schemas/mesmer.xsd,schemas/mesmerPlugins.xsd: updated.
	* schemas/schemaNotes.txt: added.
	* examplesSchema/*.xml: put into new format (where supported).

	src/plugins/AnalyticalRepresentation.cpp,src/plugins/ExponentialDown.cpp,
	src/plugins/fitting.cpp,src/plugins/LandauZenerCrossingCoeff.cpp,
	src/plugins/Marquardt.cpp,src/plugins/WKBCrossingCoeff.cpp,
	src/plugins/WKBTunnellingCoefficients.cpp: can parse new (and old) format.

	* src/CollisionOperator.cpp,src/MolecularComponents.cpp,src/ParseForPlugin.h,
	src/Reaction.cpp,src/System.cpp: Use new ParseForPlugin code for new format XML

	MesmerQA/QA.bat: correct display of Mesmer version

2013-July-20 Struan Robertson
	
	* AnalyticalRepresentation.cpp: Addition of basic class structure for the 
	analytical representation method.
	* HinderedRotorQM1D.cpp, WKBTunnellingCoefficients.cpp: Bug fixes checked 
	in on behalf of Robin.

2013-July-20 Struan Robertson
	
	* UnitTests.cpp/qd_test.h: QD unit tests added to MESMER unit
	tests and unit test baseline updated.

2013-June-16 Struan Robertson
	
	* PseudoIsomerizationReaction.h/.cpp: Prior fragmentation distribution 
	corrected for threshold energy and cell-off-set.

2013-June-11 Struan Robertson
	
	* PseudoIsomerizationReaction.cpp: Prior distribution (dissociation
	distribution) calculation method (changes checked in on behalf of Robin).

2013-May-27 Struan Robertson
	
	* PseudoIsomerizationReaction.h/.cpp: Initial revision of pseudo-
	Isomerization reaction class.

2013-May-11 Struan Robertson
	
	* CollisionOperator.cpp, System.cpp, TMatrix.h: Matrix printing 
	generalized and applied to eigenvector matrix.

2013-May-11 Struan Robertson
	
	* CollisionOperator.cpp: Fix for grain number problem (checked-in
	on behalf of Robin).
	* MesmerQA: Baseline update following the above fix.
	* MesmerQA: .xml update following the application of schema.

2013-May-6 Struan Robertson
	
	* UnitTests.cpp/.h: Linear algebra unit tests added.

2013-May-5 Struan Robertson
	
	* MolecularComponents.cpp/.h: Hessian projection method 
	extended to project out transition state modes.

2013-May-4 Chris Morley

	src/System.cpp: From a problem Mark was having: ensure XML
	output is well-formed even when range variable names contain
	unsuitable characters )( : or space, probably arising from a
	molecule name (now deprecated of course).

2013-April-30 Chris Morley

	Update to parse xsi:type me:MesmerILT and similar. Mods like
	required units atribute for pre-exponential etc.

2013-April-30 Chris Morley

	Add MesmerQAschema and examplsSchema directories for
	new(schema-friendly) XML file format versions.

	[Several source files] Make C++ parsing compatible with both old
	and new XML file formats.

	schemas/CMLforMesmer.xsd,mesmer.xsd,mesmerPlugins.xsd, defaults.xml:
	 Update

2013-April-27 Chris Morley

	src/XMLPersist.cpp:fix for corrupted output XML file bug
	introduced in bath gas mod.

2013-April-27 Struan Robertson
	
	* SensitivityAnalysis.cpp: Altered to read covariance matrix.

2013-April-14 Struan Robertson
	
	* System.cpp: Update of version to 3.0.

	* MESMER manual.docx: Updated to include material relating to hessian.

2013-April-10 Struan Robertson
	
	* MolecularComponents.cpp: Minor change to account for transition 
	state imaginary frequency.

2013-April-10 Struan Robertson
	
	* MolecularComponents.cpp/.h: Re-orientation of Hessian an part of
	vibrational mode analysis.

2013-April-08 Struan Robertson
	
	* CollisionOperator.cpp: Fix for linux build break.

2013-April-08 Chris Morley

	Use different bath gases in the same run
	* src/plugins/ExponentialDown.cpp,
	src/EnergyTransferModel.h,src/plugins/GaussianModel.cpp: 
	parse for deltaEDown for specified bath gases
	 
	* src/MolecularComponents.cpp,src/MolecularComponents.h,
	src/MoleculeManager.h: keep a map of bathGasName/energyTransferModel
	rather than just m_bathGas.

	* src/System.cpp: do parsing of <me:bathGas> before reactions and
	molecules

	* src/MesmerEnv.h,src/unitsConversion.h: extra variable to transmit
	current bath gas.

	* src/Persistence.h,src/XMLPersist.cpp,src/XMLPersist.h: added a
	parameter to XmlMoveToProperty() to make it easier to move to the
	next sibling CML property

	* src/CollisionOperator.cpp: error message

	*src/Constants.h,src/MolecularComponents.cpp: units conversion for
	hessians from Robin


2013-April-07 Struan Robertson

	* CollisionOperator.cpp/.h, TMatrix.h: Replaced d2D types with generic
	STL types or TMatrix types.

2013-March-31 Struan Robertson

	* MolecularComponents.cpp/.h: Re-orientation of molecular system and 
	orthogonalization of projected modes.

2013-March-28 Struan Robertson

	* MolecularComponents.cpp/.h, Molecule.cpp: Units added for Hessian 
	and frequencies updated following diagonlization of Hessian.

	* examples/Butyl_H_to_Butane/Butyl_H_to_Butane.xml: Added units for
	Hessian.
	
2013-March-27 Chris Morley
	* src/MolecularComponents.cpp: transparently read hessian matrices
	with upper or lower triangle or complete. (CML files from Gaussian
	use upper triangle.)

	* examples/Butyl_H_to_Butane/Butyl_H_to_Butane.xml,
	src/MolecularComponents.cpp: in dictRref use me:hessian rather
	than me:Hessian.

2013-March-26 Struan Robertson

	* MolecularComponents.cpp/.h, HinderedRotorQM1D.cpp: Implementation 
	of Sharma, Raman and Green algorithm for the elimination of internal 
	rotational mode frequencies.
	
2013-March-19 Struan Robertson

	* MolecularComponents.cpp/.h: Hessian rotational projection added.
	
2013-March-11 Struan Robertson

	* MolecularComponents.cpp/.h: Utility methods added to gStructure class.
	
2013-March-07 Struan Robertson

	* MolecularComponents.cpp/.h, HinderedRotorQM1D.cpp : Infrastructure to
	project internal rotor modes from Hessian.
	
2013-March-03 Struan Robertson

	* MolecularComponents.cpp/.h : Initial revision of method to analyse 
	a Hessain to obtain vibration frequencies.
	
2013-March-03 Struan Robertson

	* Rdouble.h/.cpp, fitting.cpp, gridsearch.cpp, Marquardt.cpp : Added methods 
	to convert fitted parameters back to original units (based on code changes 
	suggested by Robin).
	
2013-February-27 Struan Robertson

	* PriorDistribution.cpp, CollisionOperator.cpp: Minor bug fixes checked-in
	on behalf of Robin.
	
2013-February-25 Struan Robertson

	* TMatrix.h: Moved Matrix CML I/O methods from temporary class onto TMatrix.
	
2013-February-22 Chris Morley

	* src/RWmatrix.cpp,	src/RWMatrix.h: functions to read and write Hessian
	matrices to CML. These files and the RWMatrix class are temporary until
	a suitable home is found for the functions.

	* examples/Butyl_H_to_Butane/Butyl_H_to_Butane.xml: make experimental
	  matrix entry more CML compliant.
	* src/MolecularComponents.cpp: commented out code at line 218 to test
	  RWMatrix functions.

	* src/plugins/fitting.cpp: output hessian to XML (not fully tested)
	* src/System.cpp, src/System.h: make PersistPtr to current analysis element
	  available.

	* src/main.cpp: use throwing std::logic_error to terminate after writing
	  XML output (for debugging).

	* src/Persistence.h, src/XMLPersist.cpp, src/XMLPersist.h: correct
	  parameters of XmlWrite().

2013-February-18 Struan Robertson

	* MolecularComponents.cpp: Minor refactoring.
	
	* Butyl_H_to_Butane.xml: Initial revision - example to be used for eigenmode 
	projection project.

2013-February-10 Struan Robertson

	* Acetyl_O2_association.xml: Baseline updated related to VS9/VS10 differences.

2013-February-10 Struan Robertson

	* CollisionOperator.cpp: Further fix for mean energy output for the case
	where population is zero.

2013-February-08 Struan Robertson

	* CollisionOperator.cpp: Fix for mean energy output added.

2013-February-07 Struan Robertson

    Changes entered on behalf of Robin Shannon.

	* CollisionOperator.cpp: Fix to use specified initial distribution.

	* MolecularComponents.cpp: Check added for zero torsional moment of inertia.

	* unitsConversion.cpp: Atomic mass table updated.

2013-January-22 Chris Morley

	* src/plugins/UnitTests.cpp: correct error which was prematurely
	terminating anharmonic tests

	* MesmerQA/UnitTests/baselines/Win32/mesmer.test: revert this baseline
	which was subject to the above error. Still differences to be resolved.

	src/DensityOfStates.h: some runtime documentation

2013-January-21 Struan Robertson

	* MolecularComponents.cpp: Fix for DefinedStatesRotor, states now
	read at creation.

2013-January-20 Chris Morley

	* src/DensityOfStates.h, src/plugins/ClassicalRotor.cpp,
	src/plugins/QMRotor.cpp, src/plugins/DefinedStatesRotor.cpp
	Add includesRotations() virtual function to distinguish DOS methods
	which include rotations.

	Re-introduce ExtraDOSCMethod keyword and redo parsing. Simplifies setting
	a default method and assurance of exactly one rotation method.
	Add public RemoveDOSCalculator, AddDOSCalculator and GetDOSCalculator methods.
	* src/MolecularComponents.h, src/MolecularComponents.cpp

	* src/plugins/Morse.cpp: altered XML format for anharmonic vibrations.
	Frequencies primarily in a property (as before) but used as key in
	entries for anharmonic vibrations only under <me:MorseParameters> .

	* src/plugins/UnitTests.cpp: use the existing Morse instance rather than
	making a new one.

	* MesmerQA/ThermodynamicTable/ThermodynamicTable.xml,
	MesmerQA/UnitTests/UnitTests.xml, MesmerQA/i-propyl/ipropyl_test.xml:
	ExtraDOSCMethod keyword reintroduced.

2013-January-13 Struan Robertson

	* UnitTests.cpp: Fixed bug following the removal of ExtraDOSCMethod keyword.

2013-January-01 Struan Robertson

	* MolecularComponents.cpp/.h: Fixed rotatonal states bug. The refactoring
	of the density of states classes below removed the default behaviour of 
	adding a classical rotational states object to the density of states stack 
	if no such object is specified in the input.  

2012-December-30 Struan Robertson

	* PriorDistribution.cpp: Altered translation density of states to a
	E^(1/2) dependence. 

2012-December-30 Struan Robertson

	* PriorDistribution.cpp: Alternative implementation of prior 
	distribution, based on FFT convolution,	added.  

2012-December-29 Struan Robertson

	* PriorDistribution.cpp, Molecule.h/.cpp: Further refactoring of
	prior distribution, cofragment now located and managed by the molecule 
	manager. This required backward navigation to the molecule manager 
	from a molecule to be added.

	* Addition of pseudoisomerization class.

2012-December-29 Struan Robertson

	* PriorDistribution.cpp: Refactoring.

2012-December-29 Struan Robertson

	* PriorDistribution.cpp: Initial check-in of prior distribution, and 
	associated changes, on behalf of Robin Shannon.

	* Updated ipropyl baseline.

2012-December-20 Chris Morley

	* src/DensityOfStates.h,src/MolecularComponents.cpp,src/MolecularComponents.h,
	src/plugin.h,src/plugins/BeyerSwinehart.cpp,src/plugins/ClassicalRotor.cpp,
	src/plugins/DefinedStatesRotor.cpp,src/plugins/HinderedRotorCM1D.cpp,
	src/plugins/HinderedRotorQM1D.cpp,src/plugins/Morse.cpp,src/plugins/QMRotor.cpp:
	Complete unification of DOS calculators
	
	* src/plugin.h: improve formatting of lists of plugins in error messages.

	* src/System.cpp: reinstate reading of me:numberOfGrains, but optimization
	of number of grains etc. remains to be done.

	There are trivial rounding errors in the i-propyl QA test.
 
2012-December-16 Struan Robertson

	* MolecularComponents.cpp/.h: Changes toward the removal of the division 
	of density of states calculators - all density of states calculator
	instances now located in the same vector.

2012-December-2 Struan Robertson

	* Miscellaneous changes following to fix Linux 64 bit compiler warnings
	and to update Linux 64 baselines.

2012-December-7 Chris Morley

	* src/CollisionOperator.cpp, src/CollisionOperator.h,src/System.cpp: XML
	output for "the average of the grain energy in each isomer" already output to
	ctest. 
	XML output is split a bit unhappily between CollisionOperator and
	System and if we keep adding additional outputs there may need to be a
	rationalisation.
	Enabled by <me:printGrainedSpeciesProfile/>. These tags need to be reviewed
	for consistency.
	The ctest code is not right - I will pass on to Dave.
	 
	* popDiag.xsl: graph of above.  

	* qd/include/qd/dd_real.h, qd/include/qd/qd_real.h: minor mods to reduce
	compilation warnings

2012-December-2 Struan Robertson

	* Main.cpp and Doc.: License updated to GPLv3.

	* SensitivityAnalysis.cpp: Template added.

2012-November-28 Chris Morley

	src/plugin.h: Add TopPlugin as parent of plugins. Provides:
	- case and whitespace insensitivity of plugin names in the input file;
	- listing of plugins from the command line:  mesmer -t  or mesmer -T ;
	   The latter displays Descriptions of the type or the plugin if present
	   (currently only in EnergyTransferModel and ExponentialDown).
	- error message with a list of the possibilities if an unrecognized
	   plugin name supplied.
	- registration of all plugins, rather than being done in type classes;
	* Changes to housekeeping of all plugin classes
	* src/plugins/simplecalc.cpp, src/System.cpp, src/System.h: take advantage of
	  new error messages (more to be done).

	* MesmerQA/pentyl/pentyl_isomerization_test.xml: Use me:derivedFrom attribute
	to provide a test of it.

	* src/MolecularComponents.cpp, MesmerQA/UnitTests/UnitTests.xml: re-introduce
	"thermodynamic" energy convention. When used with Hf298 input prevents an
	unnecessary conversion to the "computational" convention and reduces error
	messages in UnitTests.

2012-November-25 Struan Robertson

	* Rdouble.cpp/.h: Added operator>> to allow direct reading into
	Rdouble variable.

2012-November-24 Struan Robertson

	* MolecularComponent.cpp/.h: Added energy transfer diagnostics.
	* GaussianModel.cpp: Modified the energy transfer function in 
	order to improve normalization.

2012-November-18 Chris Morley

	* mesmer1.xsl: Make "Comparison with Experimental Data" in
	Firefox output collapsable.

2012-November-14 Struan Robertson

	* MolecularComponent.cpp/.h, and related files: Removal of 
	cemetery state code.

2012-November-10 Struan Robertson

	* MESMER manual.docx: Updated manual with more detail on ZPE 
	calculation.

2012-October-24 Struan Robertson

	* UnitTest.cpp/.xml, Morse.cpp: Minor corrections to density of 
	state methods to use nint() (nearest integer) method.

2012-October-21 Struan Robertson

	* UnitTest.cpp/.xml: Further addition of MEIC tests.

2012-October-21 Struan Robertson

	* UnitTest.cpp/.xml: Addition of more MEIC tests.

2012-July-29 Struan Robertson

	* ThermodynamicTable.cpp: Altered so that partition function data 
	can be printed.

	* Morse.cpp: Implementation of density of states and canonical 
	partition function.

2012-July-24 Chris Morley

	* popDiag.xsl TS energies in Grain Population diagrams now as
	  full length dotted lines.

2012-July-21 Struan Robertson

	* MoleculeManager.cpp/.h: Minor change to add molecule method.

2012-July-21 Struan Robertson

	* System.cpp/.h, UnitTests.cpp: Add new MEIC unit test for sum of states.

2012-July-21 Struan Robertson

	* System.cpp/.h, ThermodynamicTable.cpp: Altered so that thermodynamic
	table calculations do not need to specify a reaction sequence.

2012-July-16 Struan Robertson

	* Morse.cpp: Initial template for Morse density of states class.

2012-July-13 Chris Morley

	* src/error.cpp: flush log file on the way through so there is
	something to look at after a crash

	* src/CollisionOperator.cpp: Change "Cell number" to 
	"Number of Cells" and supressed multiple messages.
	
	* src/MesmerMath.cpp: add "once" to supress multiple error messages.
	Moved Error Context() (but may not be significant. 

	* src/MolecularComponents.cpp, src/MolecularComponents.h: remove log
	messages about atoms not having vibrational frequencies and rot consts.  
	
	* src/System.cpp: Don't output elaspsed time unless > 0.

2012-June-17 Chris Morley

	* src/oberror.cpp, src/oberror.h: An additional parameter on
	ThrowError() causes error messages to be output only once.
	Manipulator 'once' does this for output to cerr etc.

	The files are renamed to error.h and error.cpp because they are
	considerably different from the OpenBabel versions.
	 
	* src/plugins/ExponentialDown.cpp: Change the error "Delta E down is
	smaller	than grain size" to use this facility.

	* src/MolecularComponents.cpp: minor tidying on an error message to
	make it more consistent with current error handling.

2012-June-16 Chris Morley

	* src/CollisionOperator.cpp: Add unnormalised log output for grain
	populations.

	* mesmer1.xsl: Add another text section in Firefox output for grain
	populations, to make cutting and pasting for speadsheets possible.
	 
	* popDiag.xsl: Add unnormalised log plots for grain populations. Include
	energies of transition states on plot. Maybe duplicated code should be
	tidied.

2012-June-10 Struan Robertson

	* CollisionOperator.cpp/.h: Fixed bug relating to basis set method.

	* ExponentialDown.cpp: Removed exit(1) statement as this prevented error 
	statements from being written.

2012-June-10 Chris Morley

	* src/CollisionOperator.cpp, MesmerQA/pentyl/pentyl_isomerization_test.xml:
	change XML syntax to request grain populations, which are now output
	at the same times for each species. This should be good enough and avoids
	complicating the XSLT display. Data structure in m_GrainProfileAtTimeData
	is unchanged.

	* popDiag.xsl: another try to get grain population diagram right.
	
	* src/System.cpp: use sources other than %MESMER_AUTHOR% for author in
	metadata.

2012-June-10 Struan Robertson

	* SimpleILT.cpp: Fixed bug relating to reading of activation energy.

	* Reaction.h: Minor refactoring.

	* Revised header file include strategy.
	
2012-June-09 Struan Robertson

	* DefinedSumOfStates.cpp: Splines added to calculate reaction flux.
	
2012-June-08 Chris Morley

	* src/plugins/gridsearch.cpp: set all range variable values to their
	lower bound at the start. Allows the value attribute to be freely set
	and single or range runs to chosen by <me:calcMethod> alone.
	
	* src/plugins/MesmerILT.cpp, src/plugins/SimpleILT.cpp: correct bug
	which caused energy conversion during setup of a range variable to 
	be wrong when the value was 0.
	
	* src/CollisionOperator.cpp, src/CollisionOperator.h, src/System.cpp:
	modify writing of grain population XML output so that include T and
	conc are included. 

	* src/System.cpp: modify range variable names in the XML output because
	':' is incompatible with XML.
	 
	* mesmer1.xsl, popDiag.xsl: grain population diagram improved but
	not yet ok when there are multiple conditions.

2012-June-05 Chris Morley

	* src/CollisionOperator.cpp: make grain population output normalised
	  - for a given species at a a given time output sum to 1.0. Do not
	  output very small populations. Used fixed format (XSLT flakey with
	  scientific format.)

	* src/Persistence.h,src/XMLPersist.h,src/XMLPersist.cpp: added
	extra optional parameter to XmlWriteValueElement() to force
	fixed rather than scientific format.

	* MesmerQA/pentyl/pentyl_isomerization_test.xml: added request for
	grain population output. (Doesn't affect QA.)

	* popDiag.xsl: Firefox output now with grain population diagrams.
	But not satisfactory as yet - different times are on separate graphs,
	rather than multiple lines for the same species being on the same
	graph. Multiple sets of conditions and range parameters untested.
	The XSLT is proving difficult - still trying to improve this.	

2012-June-03 Struan Robertson

	* Acetyl O2 association\baselines\mesmer.test: Rolling back David's 
	change to the release VS 10 results as agreed for the release MESMER
	1.0. Since version 706 there has been a marginal improvement in 
	agreement between VS 10 release and debug results as indicated by the
	two largest eigenvalues:

	Version 706:                                         -1.563027e-003
                                                         -1.220829e-006

	VS 10 debug (= VS 9 release or debug = Version 731): -1.569795e-003
                                                         -3.155523e-006

	VS 10 release:                                       -1.568043e-003
                                                         -2.798432e-007

    Further investigation required.
	
2012-May-28 Struan Robertson

	* MesmerMaths.cpp: Convolution method refactored and additional 
	checks added.
	
2012-May-20 Struan Robertson

	* BeyerSwinehart.cpp, EckartCoefficients.cpp: Bug fixes to address 
	problems encountered for very shallow wells.
	
2012-May-19 Struan Robertson

	* Spline.cpp/.h, UnitTest.cpp: Added test for spline class and fixed 
	bugs in spline class.
	
2012-May-14 Struan Robertson

	* Spline.cpp/.h: Initial revision of Spline class added.
	
2012-May-04 Struan Robertson

	* DefinedSumOfStates.cpp: Code added to parse data in XML structures.
	
	* FittingUtils.cpp/.h: Redundant code removed.

2012-April-22 Struan Robertson

	* Documentation changes following update for derived parameters.
	
2012-April-11 Struan Robertson

	* ExponentialDown.cpp, MesmerILT.cpp: Fix for constrained value string
	mapping bug.
	
	* Add Linux64 baseline for UnitTest.xml smoke test.
	
2012-April-09 Struan Robertson

	* UnitTests.cpp, MesmerMaths.h/.cpp: Added unit test for incomplete 
	gamma function (chi2 signifcance test) and corrected gamma function
	method. New MesmerQA tests added.
	
	* DefinedSumOfStates.cpp: Initial implementation of of the 
	defined transition states sum of states SumOfStates method  and 
	sample input file.
	
2012-April-01 Chris Morley

	* src/Rdouble.cpp, src/Rdouble.h, src/System.cpp: change xml syntax for
	linked variables.Most of the code is now in Rdouble class
	
	* src/plugins/FittingUtils.cpp, src/plugins/FittingUtils.h,
	* src/plugins/Marquardt.cpp: ...and removed from here.

	* src/plugins/HinderedRotorQM1D.cpp: format changes in cinfo output

	* src/MolecularComponents.cpp: remove outdated comment

2012-March-25 Struan Robertson

	* Project and Makefile updates for new classes.

	* Baselines updates.
	  
2012-March-24 Struan Robertson

	* DefinedSumOfStates.cpp: New class added to read, e.g. FTST sums of states.
	  
	* UnitTests.cpp: New class added to allow the running of internal checks.  

	* examples: Added HO + NO -> HONO example.  

2012-March-24 Struan Robertson

	* Documentation update: Material added regarding parameter constraints.  

2012-March-21 Struan Robertson

	* FittingUtil.cpp/.h, Rdouble.cpp/.h: Simplified parameter constraint 
	map and added member datum to Rdouble that points to XML location.  

2012-March-20 Struan Robertson

	* FittingUtil.cpp/.h: Altered so that constrained parameter values
	are written to the error channel during a fitting run.  

2012-March-15 Struan Robertson

	* FittingUtil.cpp/.h, Rdouble.cpp/.h: Constrained parameters: added 
	error checking and parameter writing.  

2012-March-15 Struan Robertson

	* FittingUtil.cpp/.h, Rdouble.cpp/.h: Added first pass implementation 
	of parameter constraints.  

2012-March-12 Struan Robertson

	* FittingUtil.cpp/.h, Rdouble.cpp/.h: Added a class and containers to
	hold information regarding parameter constraints.  

2012-March-11 Struan Robertson

	* Rdouble.cpp/.h: Added a general Rdouble range setting method, and 
	propagated it to other classes, as part of the refactoring needed to 
	implement parameter constraints.  

2012-February-17 Struan Robertson

	* TMatrix.h: Altered includes to address template compilation issue on 
	RHEL 6/g++ 4.4.6.  

2012-February-10 Chris Morley

	* MesmerQA/Acetyl O2 association/baselines/Win32/mesmer.test,
	MesmerQA/Acetyl O2 association/baselines/Win32/readme.txt
	Update WIN32 baseline and add note that it is for Release version;
	Debug version is slightly different.
	
	* Windows VC10/distribution/NSISScriptToCreateInstaller.nsi:
	After much struggling, I think this now installs and uninstalls ok on
	Window 7, at least.

2012-February-07 Struan Robertson

	* Linux, 64 and 32 bit, baseline update for MesmerQA and examples.  

2012-February-06 Chris Morley

	* Windows VC10/distribution/NSISScriptToCreateInstaller.nsi: update installer.
	  Use pdf rather than docx because docx equations no good in OpenOffice
	* Windows VC10/distribution/ReadMe.txt: Update including mentioning QA run.
	* Windows VC10/qd/qd.vcxproj, Windows VC10/TinyXML/TinyXML.vcxproj: remove some
	MS warnings

2012-February-06 Chris Morley

	* librarymols.xml: update OH to use the DefinedStatesRotors method. Add more source metadata.

2012-February-05 Struan Robertson

	* Examples.bat/.sh: Updated to use i-propyl LM fitting example.  

2012-February-05 Struan Robertson

	* MESMER manual.docx: Documentation format and content updated.
	* Windows baseline update for MesmerQA and examples.  

2012-February-03 Struan Robertson

	* System.h: Mesmer Version altered to 1.0.  

2012-January-15 Struan Robertson

	* MESMER manual.doc: Documentation update.  

2012-January-15 Struan Robertson

	* defaults.xml: Altered default of me:deltaEDownTExponent to 0.0 
	so that MesmerQA tests pass.  
	* Windows VC10: Added missing project files.

2011-December-31 Chris Morley

	In XML input, change DeltaEDown temperature exponent from a child of 
	DeltaEDown Property to its own property.
	* defaults.xml, src/plugins/ExponentialDown.cpp: Adjust parsing.
	
	* src/main.cpp: minor formatting of mesmerlog header
	* src/XMLPersist.cpp: correct defaults file name
	* Windows VC9/Mesmer/Mesmer.vcproj: reduce MS warnings about some
	  standard C++ functions

2011-December-31 Struan Robertson

	* MESMER manual.doc: Documentation update.  

2011-December-30 Struan Robertson

	* MESMER manual.doc: Documentation update.  

2011-December-20 Struan Robertson

	* ExponentialDown.cpp: Altered to allow the "exponent" variable of 
	<DeltaE>d	to be treated as a parameter.  

2011-December-19 Struan Robertson

	* CollisionOperator.cpp: Tidying-up of time evolution method.  

2011-December-16 Chris Morley

	* src/CollisionOperator.cpp,src/CollisionOperator.h,
	src/System.cpp: Some XML output grain profile

2011-December-10 Struan Robertson

	* CollisionOperator.cpp: Initial implementation of species profile 
	method.  

2011-December-04 Struan Robertson

	* CollisionOperator.cpp/.h and System.cpp: Refactoring of timeEvolution
	method in preparation for species profile implementation.  

2011-November-20 Struan Robertson

	* Minor changes to Examples and documentation.  

2011-November-06 Struan Robertson

	* MolecularComponents.cpp/.h and DOS plugin classes: General 
	tidying up.
	* main.cpp: Banner method added.  

2011-November-06 Struan Robertson

	* MolecularComponents.cpp/.h, Molecule.cpp/.h and all DOS plugin 
	classes: Add methods to allow the calculation of the number of 
	degrees of freedom.  

2011-October-30 Struan Robertson

	* MolecularComponents.cpp/.h, Molecule.cpp/.h: Tidying up of some 
	accessor methods and the gDensityOfStates constructor.  

2011-October-08 Struan Robertson

	* Initial revision of thermodynamic table smoke test.  

2011-September-10 Chris Morley

	* src/MolecularComponents.cpp,src/MolecularComponents.h,
	src/plugins/ExponentialDown.cpp,src/plugins/MesmerILT.cpp,
	src/plugins/SimpleILT.cpp: Make the names of the range variables,
	which are displayed during fitting, include the name of the molecule
	or the reaction. Fixes bug #3406422.

2011-September-08 Chris Morley
	* Documentation\Adding a molecule to the library.html: minor update
	
2011-August-18 Struan Robertson

	* DefinedStatesRotor.cpp: Added a new rotor type to deal with 
	specific cases where the states are enumerated explicitly, e.g. 
	the case of the OH radical.  
	* ThermodynamicTable.cpp: Updated to include the specific case
	of temperature = 298.15, for comparison with other tables.
	
2011-August-10 Struan Robertson

	* BeyerSwinehart.cpp: Added a separate implementation of Beyer-Swinehart
	algorithm.  
	* ClassicalRotor.cpp, QMRotor.cpp, MolecularComponents.h/.cpp: 
	Refactored to account for new BeyerSwinehart class.	
	
2011-August-02 Struan Robertson

	* ClassicalRotor.cpp, QMRotor.cpp: Corrected for missing electronic 
	excitation term.
	* Marquardt.cpp: Corrected output statement.	
	
2011-July-31 Struan Robertson

	* ClassicalRotor.cpp, QMRotor.cpp, MolecularComponents.cpp/.h: Initial 
	refactoring of partition function methods as part of improved 
	thermodynamic function calculation.
	
2011-July-17 Struan Robertson

	* Marquardt.cpp, fitting.cpp, FittingUtils.cpp/.h: Refactor of fitting
	methods, utility functions moved to base class.
	
2011-July-16 Struan Robertson

	* Marquardt.cpp, MesmerMaths.cpp/.h: Tidying up of goodness of fit test.

2011-July-14 Struan Robertson

	* Marquardt.cpp, MesmerMaths.cpp/.h: Initial implementation of goodness 
	of fit test.

2011-July-08 Struan Robertson

	* Marquardt.cpp: Add parameter error estimates.

2011-July-06 Struan Robertson

	* Marquardt.cpp: Tidying up of Marquardt class.

2011-July-01 Struan Robertson

	* Marquardt.cpp: First pass implementation of Marquardt algorithm.

2011-June-20 Chris Morley

	Better error reporting for failing file from Paul Marshall's group.

	* src/main.cpp: flush log file after parsing so messages can be seen
	even if fails later.

	* src/XMLPersist.cpp: Error message for malformed CML property.

	* defaults.xml: add a default for <me:MarquardtDerivDelta> to prevent
	a crash if not specified. Other params probably need a default too.

2011-June-19 Struan Robertson

	* Marquardt.cpp: Addition of plug-in that will implement the Marquardt 
	algorithm.

2011-June-18 Struan Robertson

	* fitting.cpp: Minor fix to fitting method, previous Chi^2 value returned 
	if boundary encountered.
	* MolecularComponents.h/.cpp : Enum introduced for rotational top 
	specification.
	* Plugins: size_t applied in favour of int.

2011-June-08 Struan Robertson

	* TMatrix.h/.cpp, Makefile: Updated to fix build problem for Linux.
	* System.cpp,CollisionOperator.cpp: Altered so that yields can be 
	computed for a specified time.

2011-June-02 Chris Morley

	* src/MolecularComponents.cpp, src/MolecularComponents.h: Energy
	input from me:Hf298 (at last) using thermodynamicsFunctions().
	Priority is me:ZPE, me:Hf0, me:HfAT0, me:Hf298 and the conversion
	to me:ZPE is written to XML output to allow it to be used for fitting.
	HNO2 and NO ZPEs for Hf0 and Hf298 agree but 0.4kJ/mol difference
	for OH, apparently from thermodynamicsFunctions() (v NIST CCCBDB).
	 
	* src/MesmerEnv.cpp: initiallise Maxcell to 10000 for above because
	not otherwise set when system being parsed.
	
	* librarymols.xml: add extra data on atoms to support the above.

	* Documentation/MESMER manual.doc: updated

	* src/plugins/ThermodynamicTable.cpp: add name of species to table

	* src/XMLPersist.cpp: small message change

2011-June-02 Chris Morley

	* Add Visual Studio Build files
	
	* MesmerQA/QA.bat Update to VC10. The Acetyl O2 association example
	mesmer.test has small differences, but I will leave it to somebody more
	knowlegeable to update the baseline file.

2011-May-15 Struan Robertson

	* HinderedRotorQM1D.cpp: Altered to include sine terms in the potential. 
	This as the result that the Hamiltonian is complex (but Hermitian), the 
	eigenvalues for which are obtained by the augmented matrix approach. A
	minor correction the cosine only Hamiltonian was also fixed.
	* CollisionOperator.cpp: Altered so that yields are normalized.

2011-May-15 Struan Robertson

	* HinderedRotorQM1D.cpp: Output of hindered rotor states.

2011-May-15 Struan Robertson

	* CollisionOperator.cpp: Tidying up of time evolution method.
	* HinderedRotorQM1D.cpp: Add provision to plot hindered rotor states.

2011-May-14 Chris Morley

	* mesmer1.xsl: Add a section that compares experimental and calculated
	rates, yields and eigenvalues.
	Display Bartis Widom warning if present.
	Display "All eigenvalues" if @selection <=0

2011-May-14 Struan Robertson

	* System.cpp: Build break fix.

2011-May-14 Struan Robertson

	* System.cpp,CollisionOperator.h/.cpp: Addition of expt. yields to
	the Chi^2 definition.

2011-May-14 Chris Morley

	* src/plugins/fitting.cpp: add Chi^2 to XML file	
	* mesmer1.xsl: ...and to Firefox output
	
	* src/System.h, src/System.cpp, src/unitsConversion.h: when reading
	<experimentalRates>,etc., save the PersistPointer and add the calculated
	values as an attribute after fitting.

2011-May-13 Struan Robertson

	* System.cpp: Minor change relating to addition of expt. 
	eigenvalues to the Chi^2 definition.

2011-May-10 Struan Robertson

	* System.cpp,unitsConversion.h,CollisionOperator.h/.cpp: Addition of expt. 
	eigenvalues to the Chi^2 definition.

2011-May-6 Struan Robertson

	* System.h/cpp,unitsConversion.h: Further changes toward an extended Chi^2
	definition.

2011-May-2 Struan Robertson

	* System.cpp,unitsConversion.h: Initial changes toward an extended Chi^2
	definition.

2011-May-1 Struan Robertson

	* MESMER manual.doc: Added text on WKB tunnelling.

2011-April-17 Struan Robertson

	* MolecularComponents.h/.cpp: Transition state imaginary frequencies are now
	of type Rdouble to allow for fitting.

2011-April-17 Struan Robertson

	* WKBTunnellingCoefficients.cpp: Refactoring of WKB tunnelling method.

2011-April-16 Struan Robertson

	* WKBTunnellingCoefficients.cpp: Initial revision of WKB tunnelling method (checked 
	in on behalf of Robin Shannon).
	* Examples/Tunnelling: WKB tunnelling test and baseline.

2011-April-16 Chris Morley

	* mesmer1.xsl, punch.xsl: added loss rates to 'punch' output, as requested
	by Robin.

2011-April-15 Struan Robertson

	* CollisionOperator.cpp/.h,System.cpp/.h: Introduced precision enum for clarity.
	* MesmerQA/HSO2: Baseline updated to test all precisions.

2011-March-26 Struan Robertson

	* CollisionOperator.cpp/.h: Minor refactoring.
	* BoltzmannDistribution.cpp: Normalization of distribution.

2011-March-19 Struan Robertson

	* ThermodynamicsTables.cpp: Addition of a read method to give some flexibility
	to table output.

2011-March-13 Struan Robertson

	* MolecularComponents.h/.cpp: Remove redundent code relating to atomic spin
	multiplicity, which is now treated in the DOS calculation methods.

2011-March-10 Struan Robertson

	* MolecularComponents.h/.cpp,ThermodynamicsTables.cpp: An initial revision
	of methods to calculate the thermodynamic functions and the addition of a 
	plug-in class to display their values.

2011-March-07 Struan Robertson

	* TMatrix.h: Introduced and tested routines to permute the collision 
	matrix so that its largest (in magnitude) diagonal elements are at the
	lower right hand corner, as this is supposed to improve numerical 
	stability in the householder transform. The results of the tests showed
	limited improvement, but as I suspect that we may need such permutations
	in the future, I have retained the methods and commented out the permutation 
	calls for the present.

2011-February-27 Struan Robertson

	* TMatrix.h: Shifted indicies to reduce integer arithmetic.
	* calcmethod.h: Removed header dependence (further work needed to
	remove dependency on TMatrix.h).
	* CollisionOperator.h/.cpp: Minor tidying, removal of unnecessary 
	argument. 

2011-February-26 Struan Robertson

	* CollisionOperator.h/cpp, System.h/.cpp: Collision operator code moved
	from the System class to the Collision operator class. 

2011-February-26 Struan Robertson

	* CollisionOperator.h/cpp: Addition of a new class to encapsulate the 
	collision operator, as part of the refactoring of system.h/.cpp. 

2011-February-25 Struan Robertson

	* fitting.cpp: Altered to write Chi^2 to output stream. 

2011-February-16 Chris Morley

	* src/MolecularComponents.cpp,src/MolecularComponents.h: added
	alternative input me:HfAT0 for atom based heat of formation.
	
	* librarymols.xml has an example of this
	* examples/H2Ominimal/H2Ominimal.xml: a not very realistic example
	intended to demontrate use of library molecules

	* Documentation/Adding a molecule to the library.html,
	Documentation/MESMER manual.doc updated (and edited a bit).

2011-February-13 Chris Morley

	* src/System.cpp: Redo <me:eigenvalues> so that a value of -1
	or "all" prints all the eigenvalues (ctest and XML), otherwise
	the number specified. The default (in defaults.xml) is 0.
	Previously there was no way of printing 0;

	* MesmerQA/Acetyl O2 association/Acetyl_O2_association.xml,
	MesmerQA/cyclopropene isomerization reservoir state/
	Cyclopropene_isomerization_reservoir_state_test.xml,
	MesmerQA/cyclopropene isomerization/Cyclopropene_isomerization_test.xml,
	MesmerQA/HSO2/HSO2_test.xml,
	MesmerQA/OH acetylene association/OH_acetylene_association_test.xml,
	MesmerQA/pentyl/pentyl_isomerization_test.xml,
	<me:eigenvalues> modified, generally 0 to all to retain same QA output.
	
	*src/main.cpp: make QA test failure more visible

2011-February-11 Struan Robertson

	* fitting.cpp: Fix made to the direction search which was being incorrectly 
	read from the direction matrix. 

2011-February-09 Struan Robertson

	* HinderedRotorCM1D.cpp: Hindered rotor configuration integral extended. 

2011-February-04 Struan Robertson

	* HinderedRotorCM1D.cpp: Approximate treatment of hindering 
	potential added.
	* Makefile: Addition of HinderedRotorCM1D.cpp to build. 

2011-January-30 Struan Robertson

	* HinderedRotorCM1D.cpp: Initial implementation of classical 1D
	hindered rotor DOS class. This class has been added for comparative
	purposes.

2011-January-22 Chris Morley

  * src/MolecularComponents.cpp,src/MolecularComponents.h,
  librarymols.xml: If me:ZPE not found, read me:Hf0 and convert to
  a computational basis using gStructure::CalcSumEMinusHf0()
  and ZPE and HF0 data for atoms in librarymols.xml.
  
  me:ZPE property can have an attribute zeroPointVibEnergyAdded="false".
  If present, the value of me:ZPE is corrected before being
  used internally. Allows direct input from OpenBabel, etc.
  mesmerDiag.xsl has not yet been corrected for this.  

  * src/XMLPersist.cpp: XmlReadDouble(), XmlReadPropertyDouble()
  return NaN rather than 0.0 if not found. Distinguishes a real
  0.0 value, but has required extra precautionary statements in
  several places in the code in case 0.0 was really intended.
  
  * Documentation/MESMER manual.doc, src/Persistence.h: documentation
  of above.
  
  * Documentation/Adding a molecule to the library.html: new tutorial.   

  * src/MoleculeManager.cpp,src/MoleculeManager.h,
  src/System.cpp,src/System.h: Move GetFromLibrary() and libfile
  from being members of MoleculeManager to being global in the
  System files. This clearly needs to be re-addressed when System
  is reorganised. It was necessary to access the library while
  converting Hf0 in gStructure.
  
  * Windows VC9/qd/qd.vcproj,Windows VC9/TinyXML/TinyXML.vcproj:
  remove build logging (makes possible multithread building?) and
  deprecated 64bit compatibility option. 
 

2011-January-8 Struan Robertson

	* MESMER manual.doc: Refresh of contents table and other 
	minor changes.

2011-January-4 Struan Robertson

	* Makefile: Corrections to minor tidying up.

2010-December-31 Struan Robertson

	* MESMER manual.doc: Additions concerning ZPE, examples and other 
	minor changes.
	* Makefile: Minor tidying up.

2010-December-15 Chris Morley

	* mesmer1.xsl: display the eigenvalues that are present in XML file

2010-December-14 Chris Morley

	* Windows VC9/distribution/NSISScriptToCreateInstaller.nsi:
	Change default install folder from Program Files, which is read only
	on Windows 7 to C:\Mesmer-0.2. Add punch files.
	
	* Windows VC9/distribution/ReadMe.txt: updated email ads

2010-November-29 Struan Robertson

    * System.cpp, fitting.cpp: Altered so that microcanonical rates calculated 
    only once per parameter cycle during fitting, to improve performance.
    
2010-November-27 Struan Robertson

    * Makefile: Updated to reflect changes to the BoltzmannDistribution 
    plugin class.
    
    * MesmerQa/i-propyl: Linux baselines added.
    
2010-November-27 Struan Robertson

    * BoltzmannDistribution.cpp: Move to plug-in area and consolidated
    with header file.
    
    * Remove duplicate i-propyl example.
    
    * SimpleRRKM: Added comments.

2010-November-21 Struan Robertson

    * MESMER.sln: Removed references to deleted header files.

2010-November-17 Chris Morley
	
	* Transferred the declarations of plugin classes to their .cpp
	files and deleted the .h files.
	
	* src/MicroRate.cpp, src/MicroRate.h: moved utility functions
	ReadRange() and ILTCheck from SimpleILT
	
	* Windows VC8: delete build files for Visual Studio 2005
	
	* Documentation/MESMER manual.doc: minor edits in XML section.		

2010-November-14 Struan Robertson

    * MESMER manual.doc/.pdf: Added documentation of XML data access methods.

2010-November-13 Struan Robertson

    * MESMER manual.doc/.pdf: Updated the documentation to reflect recent 
    changes to plugin classes.

2010-November-8 Chris Morley

	* src/main.cpp,src/System.cpp,src/System.h,mesmer1.xsl,mesmer2.xsl:
	Add <description> element so that less information gets put in
	XML comments.
	Revamp metadata to be more compliant with Dublin Core recommendations.
	http://dublincore.org/documents/dc-xml-guidelines/ 

	* examples/Ethyl_H_to_Ethane/Ethyl_H_to_Ethane.xml,
	MesmerQA/cyclopropene isomerization/Cyclopropene_isomerization_test.xml:
	make comment into <description>

	* src/oberror.h, src/plugins/fitting.cpp: Way of supressing
	 ctest output, not currently used

	* examples/DiagramTest: remove

2010-November-6 Chris Morley

	* src/MolecularComponents.cpp, src/MolecularComponents.h,
	src/plugins/HinderedRotorA.cpp: modify gStructure::GetAttachedAtoms()
	so that it works with molecules with rings.

2010-November-4 Struan Robertson

    * System.h/.ccp, fitting.h: Altered the signiture of the calculate method so
    as to control the amount of output.

2010-November-2 Struan Robertson

	* HinderedRotorQM1D.cpp/.h: Renamed class to give a better indication of content.
	Updated all test, VC proj and Make files to reflect change. Also altered partition 
	function test methods so that partition functions now agree.

2010-October-26 Struan Robertson

	* QMRotor.cpp: Minor tidying.
	* examples/Methyl_H_to_Methane.xml: Update of the Methyl + H example to use QM
	rotors.

2010-October-28 Chris Morley

    * HinderedRotorA.cpp: Checked for rings added.

2010-October-26 Struan Robertson

	* Move spin forbidden kinetics examples to examples folder.

2010-October-26 Struan Robertson

	* Add i-propyl test to smoke test QA. This will test hindered rotors and 
	reverse ILT.

2010-October-26 Struan Robertson

	* Add Linux 32 baselines.

2010-October-26 Chris Morley

	* src/Reaction.cpp, src/Reaction.h, src/IrreversibleExchangeReaction.h,
	src/IrreversibleUnimolecularReaction.cpp: add new flag m_UsesProductProperties
	with get and set methods. It is false for irreversible reactions unless
	set in MesmerILT.cpp if there is reverse ILT. setUsesProductProperties()
	also ensures that the product gDensityOfStates data is loaded before the
	start of the calculation, so that product energy can be used as a range
	variable, as in ipropyl_test.xml. 
	
	* src/IrreversibleUnimolecularReaction.cpp: handle the case of the
	reverse threshold energy being negative, which requires knowledge
	of the product energies, only if flagged as above. Allows sink molecules
	to be input without properties (as in Gaussian file input tutorial).
    
	* src/MolecularComponents.cpp,src/MolecularComponents.h
	(gDensityOfStates::gDensityOfStates) delay call to ReadDOSMethods()
	until after the vibrational frequencies have been read in, so that they
	can be altered by...	

	* src/plugins/HinderedRotorA.cpp: provide <me:replaceVibFreq> which
	removes the specified frequency from m_vibFreqand allows it to remain in
	the XML file, which is self documenting. The previous method still works.
	
	* src/DensityOfStates.h,src/plugins/HinderedRotorA.cpp(ReadParameters):
	change parameter from Molecule* to gDensityOfStates* because used from
	gDensityOfStates constructor when Molecule does not know about it yet.
    
    * src/Molecule.cpp: revert the roll-back in the last commit. The changes
    allow ipropyl_test.xml to run with two variables, but I don't know how
    sensible the results are.

2010-October-24 Struan Robertson

	* src/Molecule.cpp: Roll-back previous change, i.e. add sink to types 
	of molecule needing a gDensityOfStates component. This broke the i-propyl
	example because one the variable parameters is a property on one of the
	sink molecules (propene) and is used in the ILT method.

	* src/MolecularComponents.cpp:(ReadStructure) Make even more robust, use
	element name if ID is missing.
	
	* src/QMRotor.cpp: Minor tiding up.
	
	* examples/i-propyl: Update of input document to use quantum rotational 
	states.

2010-October-23 Chris Morley

	* src/Molecule.cpp: remove sink from types of molecule needing a
	gDensityOfStates component. I think this must have been changed
	by mistake.
	
	* src/ReactionManager.cpp: mods to keep parsing reactions even if one is
	not perfect. Necessary for input from Gaussian files. I thought it used
	to be like this...
	
	* defaults.xml,Documentation/Constructing a Datafile from Gaussian output.html:
	change default for <me:MCRCMethod> to make constructing	a datafile
	slightly easier. However they are currently failing because they do
	not contain data for sink species, even though it is not necessary; a
	problem that needs resolving.	
		
	* src/AssignMolTypes.cpp: small change in a message
	
	* src/MolecularComponents.cpp: comment out in the destructors the
	reporting to mesmer.test of the non-use of various properties. I
	don't think this is useful.
	
	Add a logging message when calculating rotational constants.

2010-October-21 Struan Robertson

	* QMRotor.cpp: Corrected Fortran (1 based)/C (0 based) array mis-match
	error of QM asymmetric top method.

2010-October-20 Chris Morley

	* src/MolecularComponents.cpp, src/MolecularComponents.h:
	If <me:rotConsts> not present, calculate rotational constants from
	structure if coordinates provided. (I have not seen rot consts in MolPro
	files.)
	(ReadStructure) Make robust to to absence of <atomArray> and <bondArray>
	
	* src/plugins/ExponentialDown.cpp: make robust to absence of <atomArray>

	* Documentation/Constructing a Datafile from Gaussian output.html:
	Updated for 2.3.0 release of OpenBabel, etc.
	
	* examples/makedata.bat: works with .out as well as .log
 
2010-July-27 Chi-Hsiu Liang

  * Removed 1D FGH approach from the trunk

2010-July-17 Chi-Hsiu Liang

  * Some modifications to QMHinderedRotorPotential and related files.

2010-July-11 Struan Robertson

	* TimeCounter.cpp, Sytem.cpp, MolecularComponents.cpp : Minor changes to address
        compiler warnings.
        * Makefile: Reference to QMHinderedRotorPotential.cpp removed.

2010-July-11 Struan Robertson

	* MesmerQA: Initial revisions of Linux 64 baselines.

2010-July-10 Struan Robertson

	* HinderRotorA.cpp/.h: Tidying up of the numerical potential input.
	* Rdouble.cpp: Altered the equality operator to set prev value as this was
	causing the IsUnchanged() method to always fail causing the density of states
	to be recalulated for each pressure and temperature point.

2010-July-10 Struan Robertson

	* System.cpp/.h: Altered so as to always find the location of sinks. (Bug found
        when running the i-propyle example.)

2010-July-08 Struan Robertson

	* HinderRotorA.cpp/.h: Altered to allow for a more generic analytical potential.

2010-July-05 Struan Robertson

	* HinderRotorA.cpp/.h: Input method extended to allow hindering potential data
        points at equal intervals to be read and and transformed to give a cosine
        expansion.

2010-July-03 Struan Robertson

	* HinderRotorA.cpp/.h: Changes required for asymmetric hindered rotor potential.

2010-July-03 Struan Robertson

	* System.cpp: Additional output of rate coefficient table to cinfo stream.
        * Methyl_H_to_Methane.xml: Corrected for missing reference reaction.

2010-June-27 Struan Robertson

	* Reaction.h: Minor update to remove m_GrainKbmc variable and place it only
        on those reaction that require it.
        * MolecularCmponents.cpp: Minor code changes to improve readability.

2010-June-27 Struan Robertson

	* fitting.cpp, MesmerILT: Changes to parameter reading and fitting algorithm to
        improve the fitting of the Methyl+H example.
        * Methyl_H_to_Methane.xml: Minor changes to allow for testing.

2010-June-13 Struan Robertson

	* MesmerTools.cpp: Rolling some changes back to 286 for grain averaging
        method to catch possible divide by zero error.
        * Methyl_H_to_Methane.xml: Updated to include reference reaction.

2010-June-13 Struan Robertson

	* System.cpp/.h: Chi-squared method altered to account for excess
        concentration in the case of a bimolecular association reaction.

2010-June-06 Struan Robertson

	* HinderRotorA.cpp/.h: Addition of QM hindered rotor torsion potential.

2010-June-03 Struan Robertson

	* HinderRotorA.cpp: Addition of QM Hamiltonian matrix in preparation for
	adding torsion potential.

2010-May-23 Struan Robertson

	* HinderRotorA.h/.cpp: Initial implementation of hindered rotor. QM one-
        dimensional free rotor density of states convolved with the other density
        of states.

2010-May-22 Struan Robertson

	* QMRotor.cpp: Minor correction to improve agreement with classical results.
        * Update of Ethyl + H example with experimental numbers.

2010-May-21 Chi-Hsiu Liang

  * Update some changes to QM Hindered Rotor approximation.
  * Need a real system to test against the code.

2010-May-14 Chi-Hsiu Liang

  * Addition of MacOSX mesmer.test files in MesmerQA test projects.
  * Some progress on the QM Hindered Rotor approach.

2010-May-12 Chi-Hsiu Liang

  * modified the output path of mesmer_out.xml to make it clear.

2010-May-10 Dave Glowacki

      * changes to MakeFile and Hindered Rotor *.h files to get LINUX compilation working

2010-May-10 Dave Glowacki

      * System.cpp, make some changes to get correct behavior when RateCoefficientsOnly is specified
      * IrreversibleExchangeReaction.cpp & IrreversibleUnimolecularReaction.cpp: make changes for 
        correct behavior in the case of a negative barrier
      * MesmerTools.cpp, make changes to avoid numerical errors for QMrotor routines
      * LandauZenerCrossingCoeff.cpp, WKBCrossingCoeff.cpp, SimpleRRKM.cpp: changes to give correction
        behavior in the case that RRKM Crossing Coefficients are requested for reactions with a negative
        barrier
      * add HCCH_methylene.xml & HCCH_methylene.test in MesmerQA\spin_forbidden_kinetics

2010-April-25 Struan Robertson

	* System.h/.cpp, TMatrix.h: Addition of Gram-Schmidt analysis to Bartis-Widom calculation,
      to improve mass conservation.
      * Update of associated baselines.

2010-April-18 Struan Robertson

	* System.h/.cpp: Refactoring of the Bartis-Widom method.

2010-April-12 Struan Robertson

	* System.h/.cpp: Minor change to Bartis-Widom method.

2010-April101 Chris Morley

	* mesmer1.xsl: add facility to copy punchfile-like data from Firefox output
	
	* punchout.bat: script to use punch.xsl to make punch file, usable from
	SendTo menu.

2010-March-26 Chi-Hsiu Liang

  * Set up project to debug under Apple Xcode. Some incompitabilities were removed.

2010-March-20 Struan Robertson

	* SimpleILT.h/.cpp, MesmerILT.h/.cpp: More refactoring to eliminate code duplication.

2010-March-20 Struan Robertson

	* ReactionManager.h/.cpp, System.h/.cpp: Transition matrix construction moved from 
      ReactionManager to System.

2010-March-14 Chris Morley

	* src/vector3.cpp,src/vector3.h: class foratom coordinates from OpenBabel,
	with new function Point2Line.
	
	* src/MolecularComponents.cpp,src/MolecularComponents.h,src/unitsConversion.cpp,
	src/unitsConversion.h: Store and read chemical structure, with some functions to
	retrieve info.
	
	* src/plugins/HinderedRotorA.cpp,src/plugins/HinderedRotorA.h: code to read
	structure and other data. Needs completing.

2010-March-11 Ch-Hsiu Liang

  * Clean up some gcc build problem.
	
2010-March-7 Struan Robertson

	* TMatrix.h: Addition of some matrix utilities.

2010-March-6 Struan Robertson

	* System.cpp,.h, ReactionManager.cpp,h: Initial changes for basis set BW rate coefficient method.

2010-March-6 Struan Robertson

	* SimpleILT.cpp,.h, MesmerILT.cpp,h MicroRate.cpp,.h: Refactored to remove protected data and place
        ILT specific data and methods on ILT classes.

2010-March-6 Struan Robertson

	* IrreversibleExchangeReaction.cpp, IrreversibleUnimolecularReaction.cpp: Refactoring of 
        isReverseReactionILT_Ea() method.

2010-March-1 Struan Robertson

	* MicroRate.cpp,.h, SimpleILT.cpp, MesmerILT.cpp: Elimination of UseILT function and related variables.

2010-February-28 Struan Robertson

	* src/Reaction.cpp,.h and MicroRate.cpp,.h: Initial changes related to removal of ILT data from
        the reaction class and onto the mictrorate calculators. More work is still required to rationalize the
        microrate calculators.

2010-February-21 Struan Robertson

	* src/MolecularComponents.cpp,.h and System.cpp: More minor changes to related to the basis set method.

2010-February-21 Struan Robertson

	* src/MolecularComponents.cpp,.h: Minor changes to related to the basis set method.

2010-Febuary-16 Chris Morley

	Moved derived plugin classes from src to src/plugins. The abstract
	base class header file remains in src.
	
	Provided extra commenting in EnergyTransferModel.h and ExponentialDown.cpp
	as a tutorial for writing plugin classes. Combined ExponentialDown.cpp
	with its header file to make this easier (and also for nefarious
	idealogical reasons).

2010-Febuary-09 Chris Morley

	* src/MicroRate.h,src/MesmerILT.h,src/SimpleILT.h,src/SimpleRRKM.h
	Rework MicroRateCalculator classes to have cloned instances. Read
	the XML data by the class at parse time although rate data is still
	stored (for the time being) in Reaction.

	* src/DensityOfStates.h,src/ClassicalRotor.cpp,src/ClassicalRotor.h,
	src/HinderedRotorA.cpp,src/HinderedRotorA.h,src/QMRotor.cpp,src/QMRotor.h
	Similarly for DensityOfStatesCalculator classes.

	* src/MolecularComponents.cpp,src/MolecularComponents.h:
	Apply the above.

2010-January-23 Struan Robertson

	* Update of QA baselines following changes to exponetial down class.

2010-January-21 Chris Morley

	src/EnergyTransferModel.h,src/ExponentialDown.cpp,src/ExponentialDown.h,
	src/MolecularComponents.cpp,src/MolecularComponents.h:
	Plugin class derived from EnergyTransfer model now provide a new instance
	from Find so that they can contain information specific to a molecule.
	Move delta E down from gWellProperties to ExponentialDown. 
	The plugin class carries a pointer to a Molecule - more meaningful 
	than gWellProperties. Read data at parse time rather than when calculating.
	Allow energy transfer model to be user-chosen, default in defaults.xml.
	
	NOTE: The QA does not verify, but probably just needs baselines updating.
	I'll leave this until somebody knowlegeable can review the acceptability
	of the errors.
	
	src/Rdouble.cpp(set_range): do not set value to lower 
	
	src/main.cpp: Version to 0.11 

2010-January-17 Struan Robertson

	* MolecularComponents.h/.cpp: Refactoring of collision operator initialization code.

2010-January-16 Struan Robertson

	* MolecularComponents.h/.cpp: Tidy-up wellproperties constructor.

2010-January-16 Struan Robertson

	* MolecularComponents.h/.cpp: Move exponential down model material onto specfic model.

2010-January-16 Struan Robertson

	* MolecularComponents.h/.cpp: Initial changes to allow for specification of energy transfer model.

2010-January-15 Struan Robertson

	* MolecularComponents.h: Minor change to introduce a generic energy transfer model.

_2010_01_08__14_27_52_ Chi-Hsiu Liang

  * Minor modification about the nInfinity in the manual. n > 1.5 changed to n > -1.5.

2010-January-08 Chris Morley

	* src/Reaction.h, src/IrreversibleUnimolecularReaction.cpp,
	src/IrreversibleUnimolecularReaction.h: changes to do with not requiring
	information on the products of irreversible reactions.
	At least, I think they are; they are old mods which didn't get committed.

2010-January-08 Chris Morley

	Save the PersistPtr of source of range variables:
	* src/unitsConversion.cpp, src/unitsConversion.h: store in global vector.
	* src/MicroRate.cpp, src/MolecularComponents.cpp: extra line when 
	range variable is set.
	
	* src/plugins/fitting.cpp: modify output XML file with fitted params;
	 provide extra user control, reduce console output.
	* mesmer1.xsl: Firefox output of fitted params
	* defaults.xml, examples/i-propyl/ipropyl_test.xml,popDiag.xsl:
	consequent changes
	
	* src/oberror.h: RAII class to change error level reporting
	
	* src/Persistence.h, src/XMLPersist.cpp,src/XMLPersist.h: Add two
	new functions XmlMoveToProperty() and XmlWrite()

	* src/ReactionManager.cpp,src/ReactionManager.h,src/System.cpp,src/System.h:
	Move calcChiSquare to System but make new ReactionManager::getSpeciesSequenceIndex().
	Start of rationalization.

2009-December-29 Struan Robertson

	* MolecularComponents.cpp: Minor change needed for i-propyl fitting example.

2009-December-29 Struan Robertson

	* fitting.cpp: Addition of limit checks to line search of fitting method.

2009-December-21 Struan Robertson

	* fitting.cpp: Initial implementation of the Powell algorithm.

2009-December-21 Struan Robertson

	* fitting.cpp: Re-arrangement and tidy-up.

2009-December-13 Struan Robertson

	* fitting.cpp: Generalized line search method to use vectors.

_2009_12_10__16_29_46_ Chi-Hsiu Liang

  * Some stuff about one-dimensional Fourier grid Hamiltonian for hindered rotors.

2009-December-5 Struan Robertson

	* fitting.cpp: Minor tidying of fitting method.

2009-November-29 Struan Robertson

	* fitting.cpp: Rough sketch of multi-dimensional search added.

_2009_11_27__13_16_47_ Chi-Hsiu Liang

  * Resolved a problem in reverse ILT that only the energy of the first product was taken into account. Thanks to Robin Shannon.

2009-November-19 Chris Morley

	* Windows VC9/distribution/NSISScriptToCreateInstaller.nsi:
	the install directory is now added to the front of PATH
	and to the front of MESMER_DIR. To version 0.11
	
	* src/main.cpp:use only the first directory in MESMER_DIR
	
	These changes should allow a second or later installation to work ok.
	If it is uninstalled the earlier version should work again.
	There may be issues with the start menu items needing to be deleted
	manually sometimes (I haven't sorted out exactly when).

_2009_11_19__12_24_19_ Chi-Hsiu Liang

  * Updated video tutorial plan

_2009_11_19__10_23_25_ Chi-Hsiu Liang

  * Make sure imFreq is positive.
  * Mesmer video tutorial plan

_2009_11_18__12_14_08_ Chi-Hsiu Liang

  * Tunneling for bimolecular reactions

_2009_11_17__14_26_41_ Chi-Hsiu Liang

  * Update the manual for shortest integration time of species profile

_2009_11_13__19_32_06_ Chi-Hsiu Liang

  * Update the manual for gridSearch

2009-November-13 Struan Robertson

	* ReactionManager.cpp: Minor correction to the calculation of Chi^2.

_2009_11_13__15_35_43_ Chi-Hsiu Liang

  * Modify the way specifying cemetery state

2009-November-13 Struan Robertson

	* fitting.cpp: Rough sketch of golden section line search added.

_2009_10_27__17_47_36_ Chi-Hsiu Liang

  * Changed the boundary of the shortest integration time of species profile.

_2009_10_16__11_55_04_ Chi-Hsiu Liang

  * Corrected the cemetery state method.

_2009_10_14__16_13_57_ Chi-Hsiu Liang

  * Removed the renormalization method. 

_2009_10_12__09_13_20_ Chi-Hsiu Liang

  * Modify some terms in Bartis-Widom rates to QD in order to avoid some diagonalization problem
    after converting from QD to double.

_2009_10_07__16_11_46_ Chi-Hsiu Liang

  * Minor modifications

_2009_09_21__17_11_36_ Chi-Hsiu Liang

  * A few modifications related with compiler complaints and Bartis-Widom output.

2009-September-18 Chris Morley

	* src/MicroRate.cpp, src/Reaction.cpp: move the check on the activation energy
	being positive with ILT reactions from the calculation to the parsing phase,
	so that it is found earlier and the program terminated.
	
	* src/ReactionManager.cpp: during parsing, continue after an error to find further
	errors, but retainthe updated readStatus to terminate before calculation.
	
	* src/Molecule.h,src/Molecule.cpp,src.ReactionManager.cpp: Added new function
	Molecule::isCemeteryState(). Avoids the construction of a gWellProperties member
	if it didn't already have one and the making of inappropriate default values of
	deltaEDown, which occurred with getColl().isCemeteryState().	 

_2009_09_18__13_21_13_ Chi-Hsiu Liang

  * Coorect an indices error on AssociationReaction.cpp

2009-September-14 Dave Glowacki 

  *updates to manual and add print option for TS N(E)

_2009_09_17__16_50_43_ Chi-Hsiu Liang

  * An example is checked in at example folder. 
  * a2d.h: index changed from int to size_t
  * Changes for cemetery states: some arguments of the following functions are modified.
      calcEquilibriumConstant()
      normalizedGrnBoltzmannDistribution()
      rctsRovibronicGrnCanPrtnFn()
      pdtsRovibronicGrnCanPrtnFn()
    where 
      rovibronicGrnCanPrtnFn() is modified to take account of cemetery state while necessary.
  * m_GrainKdmc is added to well properties to take account of the deactivation rate to the
    cemetery state.
  * On the treatment of cemetery state method, the active states are seen as a well and thus
    the normalization of the well is taken against only on the active states. The downward
    collision terms to the cemetery state are normalized using the same normalization constants
    of the active states. These terms to the cemetery state are then summed up deactivation
    rates and stored in m_GrainKdmc.
  * Relavent modifications to Bartis-Widom phenological rates and time evolution function are
    also done for cemetery state method.
  * Need to check for bugs before the diagonalization process that makes some rows in eigenvectors 
    not summed to one.
  * TMatrix.h:
      normalizeProbabilityMatrix() is modified with an additional argument, allows it to normalize
      the matrix over a certain portion of the matrix.

_2009_09_17__14_10_10_ Chi-Hsiu Liang

  * Species profile change in cyclopropene isomerization reservoir state due to modification on Version 438.

2009-September-14 Dave Glowacki 

  * fixed a bug which prevented compatibility between the spin forbidden crossing
    code and the reservoir & cemetary state approximations
  * update the spin forbidden crossing baselines

2009-September-14 Dave Glowacki 

  * update Makefile to compile successfully under Linux/Mac

2009-September-14 Dave Glowacki 

  * update manual and alter source code to compile successfully under Linux/Mac


2009-September-13 Struan Robertson

	* ReactionManager.cpp: More minor changes in preparation to introduce extended 
        precision into Bartis-Widom methods.

2009-September-11 Dave Glowacki

  * update manual to add information on Spin Forbidden Crossing Code

2009-September-11 Dave Glowacki

  * add and test microcanonical Spin Forbidden Crossing code to MESMER against that described by 
    Harvey & Aschi, Farad. Disc., 2003(124), 129-143.  Two flavors of the spin forbidden
    transmission coefficients are available:
	- Landau-Zener theory transmission coefficients which does not include tunneling below threshold
	- WKB theory transmission coefficients, which include tunneling below threshold

  * spin-forbidden specific changes to code include:
	1) add Crossing.h abstract base class
	2) add LandauZenerCrossingCoeff.cpp and LandauZenerCrossingCoeff.h plug-in classes
	3) add WKBCrossingCoeff.cpp and WKBCrossingCoeff.h plug-in classes
	4) Constants.h: add constants required in the new code
	5) MesmerFlags.h, MesmerFlags.cpp, and System.cpp: add CrossingCoeffEnabled flags
	6) Reaction.h and Reaction.cpp: add CrossingCalculator info
	7) SimpleRRKM.cpp: add convolution of CrossingProbability vectors and TScellDOS

  * miscellaneous changes to code include
	1) MicroRate.cpp, so that TST coefficients are not printed out at temperatures much higher
	   than the ME simulation temperature; because the TST rate coefficients are calculated from
 	   grained data, the rate coefficients are most accurate at temperatures less than or equal to the 
	   simulation temperature; the code has been amended to reflect this, so as not to confuse the user
	2) MesmerMath.h & MesmerMath.cpp: add Airy functions for WKB transmission coefficients
	3) MesmerMath.h & MesmerMath.cpp: optimize and improve the FastLaplaceConvolution function

  * spin_forbidden_kinetics/ folder added to MesmerQA; it is not part of MesmerQA.bat, 
    but it is provided for user reference.  it includes sample input & output files for both WKB and LZ calculations

  * the Makefile has been updated for the new source code

  * the baselines have been updated; changes are on account of the more accurate optimized 
    FastLaplaceConvolution function and the changes to the temperature range over which the 
    canonical rate coefficients are calculated

_2009_09_10__16_43_26_ Chi-Hsiu Liang

  * Minor fix on reservoir state isomer initial population vector

_2009_09_07__12_41_10_ Chi-Hsiu Liang

  * Prepare for cemetery reservoir

_2009_09_02__14_11_49_ Chi-Hsiu Liang

  * Add missed things in Mesmer.vcproj

_2009_08_28__10_42_05_ Chi-Hsiu Liang

  * Ability to draw 3D molecules in SketchUp.
  * Planning to make drawMolecule and drawAtom member functions of Molecule and Atom themselves.

_2009_08_24__11_49_48_ Chi-Hsiu Liang

  * Draw colors in SketchUp by random number.

2009-Aug-21 Chi-Hsiu Liang

  * Add some code using SketchUp to plot PES.

2009-August-16 Struan Robertson

	* ReactionManager.cpp: Some minor changes in preparation to introduce extended 
        precision into Bartis-Widom methods.

2009-August-16 Struan Robertson

	* main.cpp: Add QD library methods to fix extended precision problems on x86.

2009-July-28 Chris Morley

  * Add new folder for plugin classes (but not all moved yet)
  * Make new abstract class CalcMethod with derived plugin classes in
    src/plugins/fitting.cpp,src/plugins/gridsearch.cpp,src/plugins/simplecalc.cpp
  *	src/MesmerFlags.cpp,src/MesmerFlags.h,src/ReactionManager.cpp,src/System.cpp,
    src/System.h: Use new method for doing the calculations. Remove punch file
    output.

  * punch.xsl: for making a simplifed file from the output xml file.

  * Replace atomarray and bondarray by atomArray and bondArray in example and QA files,
  and in src/Molecule.cpp. (The embarassing error message with i-propyl was because
  the molecules had implicit hydrogen. We will ban this in Mesmer.

  * src/Persistence.h,src/XMLPersist.cpp,src/XMLPersist.h: added XmlWriteValueElement().

_2009_07_23__14_24_24_ Chi-Hsiu Liang

Some comments

_2009_07_22__15_32_17_ Chi-Hsiu Liang

  * Moved i-propyl and benzene_oxidation to example folder
  * removed the atom array and bond array blocks for i-propyl system, as this
    will encourage MESMER to check whether the number of vibrational frequencies is making
    sense or not.
  * Fixed the error of benzene_oxidation_test.xml. This is from the calculation
    microcanonical rate constants of irreversible exchange reaction, which is
    unavailable.

2009-July-19 Struan Robertson

	* EnergyTransferModel.h: Addition of base class for energy transfer models.
	* ExponentialDown.cpp/.h: Addition of implentation class for exponential gap model.
 
2009-July-15 Chris Morley

	* examples/isopropylHinderedRotor:	Add an example data file and some
	notes on hindered rotors.
	
	* src/XMLPersist.cpp: extra endl to improve log file output.
	
2009-July-15 Chris Morley

	* src/MicroRate.cpp: included XML names in the range variables because
	 they mean more to users.
	 
	* src/Rdouble.h,src/Rdouble.cpp: some new functions. Take account of
	floating point rounding errors. Fixes bug #2818103.

	* src/System.cpp, src/System.h: redo (sorry, I know this is a character
	defect) gridSearch with a simpler, more	transparent recursive function.
	This may have messed up the punch file output. 
	Enable multiple <analysis> sections in XML file
	
	* mesmer1.xsl: can now view multiple <analysis> sections.
	
2009-July-11 Struan Robertson

	* System.cpp: More LineSearch material.

2009-July-11 Struan Robertson

	* System.cpp: Addition of LineSearch method required by automated search.

2009-June-28 Struan Robertson

	* System.cpp: Initial changes toward automated fitting and some minor corrections.

_2009_06_24__12_56_03_ Chi-Hsiu Liang

  * Correct a template function in TMatrix.h

_2009_06_19__08_37_56_ Chi-Hsiu Liang

  * Fixed a compilation bug Josh Allen reported on line 109 of IrreversibleExchangeReaction.h.

_2009_06_15__15_45_40_ Chi-Hsiu Liang

  * Fixed a Cygwin compile problem on NaN and _isnan.

2009-June-15 Chris Morley

	* Windows VC9/distribution/ReadMe.txt: same change of details
	
2009-June-15 Struan Robertson

	* README: Change of details.

_2009_06_12__14_24_18_ Chi-Hsiu Liang

  * Make manual pdf

2009-June-12 Chris Morley

  * Removed change tracking in manual
  * Moved License.txt from VC9 to top level folder
  * README added reference to Licence.txt, corrected my email address
  * MesmerQA/QA.bat Added another conditional statement so that it
    will find Mesmer.exe in the installed version (in the top level folder)
  * Windows VC9/distribution/NSISScriptToCreateInstaller.nsi: mods appropriate
    for the above.
  * Documentation/Proposal.doc: delete

_2009_06_11__16_44_59_ Chi-Hsiu Liang

  * fixed counter error in m_SpeciesSequence
  * fixed irreversibleUnimolecularReaction sink term species profile with reservoir state in the isomer.

_2009_06_11__09_16_34_ Chi-Hsiu Liang _2009_06_11__09_16_40_

  * Fixed IrreversibleExchangeReaction

2009-June-9 Struan Robertson

	* MESMER manual.doc: More tidying up.

2009-June-7 Struan Robertson

	* MESMER manual.doc: Addition of contracted basis set material.
	* HSO2_test.xml: Update test to use QM rotor.

_2009_06_02__11_11_27_ Chi-Hsiu Liang

  * Replaced isUnimolecular() and isIrreversible() check functions by getReactionType().

_2009_06_02__09_26_48_ Chi-Hsiu Liang

  * Enabled tunneling into unimolecular sink term.

_2009_06_01__10_58_13_ Chi-Hsiu Liang

  * Update manual
  * Add hydrogen atoms in the atom arrays of pentyl system. This is for checking the number of vibrational frequencies.
    In the meantime, if the user did not define the atomarray, this check is not performed.

2009-May-30 Struan Robertson

	* MESMER manual.doc: Correction to ILT formula.
	* QMRotor.cpp: Corrected and extended non-linear top density of states section.

2009-May-30 Struan Robertson

	* MESMER manual.doc: Review of theory section.

_2009_05_27__10_50_02_ Chi-Hsiu Liang

  * include #include <stdexcept> to remove the following error on Linux
      MesmerTools.cpp:64: `runtime_error' undeclared in namespace `std'

SET executable="../../Windows VC8/Mesmer/Mesmer.exe"
	* src/Reaction.cpp, src/Reaction.h,src/AssociationReaction.cpp,
	  src/MicroRate.cpp: add m_useILT to remove dependendence on 
	  MesmerILT plugin name. Pragmatic rather than elegant.
	  
	* src/MesmerTools.cpp,src/MolecularComponents.cpp,src/System.cpp:
	  replace exit(1)  by throw statements. Perhaps this
      will lead to a more complete mesmer.log after a crash.
      
	* src/MoleculeManager.cpp: add support for molecule aliases in 
	  librarymols.xml
	  
	* defaults.xml: add default for <A>
	* examples/AcetylO2/acetylO2.ck: replace acetyl_radical by acetyl
	* librarymols.xml: remove ketene and HO2 and add an alias example

	* Documentation/MESMER manual.doc:4.2.1 modified title and added bit on
	  aliases.

_2009_05_19__09_05_27_ Chi-Hsiu Liang

  * Updated manual 1. some font typesets; 2. related change about the XML input.

2009-May-18 Chris Morley

	* a couple of additions to 3.2.5
	Is section 3.3.1 necessary? It does basic XML stuff, which, even
	if it were needed would come earlier. It also does propertyList
	which IIRC is actually optional.
	
	* src/ClassicalRotor.cpp,src/MesmerILT.cpp,src/QMRotor.cpp,
      src/SimpleILT.cpp,src/SimpleRRKM.cpp: 
      Alternative names for plugin methods

	* examples/AcetylO2/acetylO2.ck, popDiag.xsl: forgot to upload

_2009_05_18__14_24_11_ Chi-Hsiu Liang

  * Solved gridsearch NaN problem on Linux by writing platform dependent NaN definitions.

2009-May-18 Dave Glowacki

	* Review changes to Mesmer Manual

2009-May-17 Struan Robertson

	* Mesmer Manual.doc: Documentation review.

2009-May-17 Chris Morley

	* Grand renaming.Affects QA files, exampl file and some src files.
	O_2              -> O2
	HO_2             -> HO2
	N_2	             -> N2
	CH_2CCH_2        -> CH2CCH2
	CH_2CO           -> CH2CO
	acetyl_radical   -> acetyl
	Classical rotors -> ClassicalRotors
	QM rotors        -> QMRotors
	Mesmer ILT       -> MesmerILT
	Simple ILT       -> SimpleILT

	* Delete a few old example files
	
	* Modify tutorial (now ready to use)

_2009_05_15__17_06_19_ Chi-Hsiu Liang

  * A check section in "EckartCoefficients.cpp" requires examination / LINE 21 to LINE 29
  * Fixed CellOffset in source term in AssociationReaction.cpp, which also corrects the baseline for OH acetylene system.

2009-May-15 Chris Morley

	* src/MolecularComponents.cpp, src/AssignMolTypes.cpp,
	MesmerQA/Acetyl O2 association/Acetyl_O2minimal.xml, defaults.xml:
	Put spinMultiplicity default as an attribute on <molecule>, rather
	than as	a property. Either can be used for input, but the attribute
	(as an existing CML	feature)is now preferred.
	
	* src/Constants.h, src/Rdouble.h: Make NAN a const double and change
	the return type of Rdouble operator++ and -- This possibly might
	have an effect on the Linux difficulties.

	mesmer1.xsl, mesmer2.xsl. popDiag.xsl is just a stub at the moment.
	
	* Windows VC9/distribution/NSISScriptToCreateInstaller.nsi:
	Include in Add and Remove Programs.
	
_2009_05_15__13_28_06_ Chi-Hsiu Liang

  * Do not output grainDOS for individual source term molecules

_2009_05_15__10_45_44_ Chi-Hsiu Liang

  * Added pdf version of the manual

_2009_05_15__10_37_29_ Chi-Hsiu Liang

  * Update the page numbers in the Table of Contents.

_2009_05_15__10_20_39_ Chi-HSiu Liang

  * Deleted unused files in Documentation folder.

2009-May-14 Dave Glowacki

  * Manual Edit
  * get rid of methylene_D2 association folder
  * fix some spelling errors in the code

2009-May-11 Dave Glowacki

  * ReactionManager.cpp: fix a bug for printing rate coefficients

_2009_05_11__15_53_25_ Chi-Hsiu Liang

  * reordered some initiation of variables.

2009-May-10 Chris Morley

	* Change Rdouble to use an internal static rather than a global variable,
	  Syntax for setting a range externally is different.
	  
	* src/ReactionManager.cpp, src/ReactionManager.h, mesmer1.xsl: 
	output populations v time to XML. Is the displayed text appropriate?
	Diagram log(pops) v log(t)to follow, I hope.

_2009_05_02__10_32_28_ Chi-Hsiu Liang

   * Fixed ZPE determination in ReactionManager.cpp. In this part, minEnergy and maxEnergy should always be compared with the ZPE values entered in
     the XML input. The ZPE of the dissociation pair here is not under consideration, as the sink pair do not have any energy property associated
     with the reaction operator. Therefore, the sink pair thresholdEstimate here is replaced by the barrier ZPE calculated from adding the threshold
     energy with reactant ZPE.

   * Updated VC8 compile file list and Linux Makefile

2009-May-02 Chris Morley

	Remove product dependence for irreversible reactions, except for reverse ILT
	
	* src/IrreversibleExchangeReaction.h,src/IrreversibleUnimolecularReaction.h
	added their own virtual calcFluxFirstNonZeroIdx()
	* src/IrreversibleUnimolecularReaction.cpp,src/IrreversibleExchangeReaction.cpp
	avoid calculating heat of reaction in :calcEffGrnThresholds()
	
	* src/MesmerILT.cpp,src/MicroRate.cpp: put ReadParameters in the correct file
	* src/Reaction.cpp,src/Reaction.h,src/SimpleRRKM.cpp,src/SimpleRRKM.h
	move more specific operations to MicroRateCalculator classes.
	
	* src/MoleculeManager.cpp:ignore library molecules with active=false attributes.
	* librarymols.xml: make ketene OH and HO_2 inactive
	
	* acetyl_O2minimal.xml, without product properties, now validates ok 

2009-Apr-30 Chris Morley
	
	Move the reading of ILT parameters from Reaction to MicroRateCalculator
	used by ILT classes but nit SimpleRRKM
	src/RDouble.h: Remove the SETRANGE macro. (It was working at one time...)
	src/System.cpp: add improved log message on precision
	
_2009_04_30__11_21_48_ Chi-Hsiu Liang

   * Updated manual for the usage of environmental variable MESMER_DIR.

2009-Apr-30 Chris Morley
   Replace DPoint by the very similar Rdouble to make handling of range and
   ordinary variables consistent.  See Rdouble.h
   
   * src/Pointer.cpp, src/Pointer.h replaced by src/Rdouble.cpp and src/Rdouble.h
   src/Reaction.cpp
  
   Consequent changes to
   src/MolecularComponents.cpp, src/MolecularComponents.h, src/Reaction.cpp
   src/Reaction.h, src/System.cpp
    
   * src/Constants.h: define NaN
   
   * Windows VC9/Mesmer/Mesmer.vcproj updated. Do we need to still support VC8?
   
_2009_04_28__17_18_03_ Chi-Hsiu Liang

   * Correct the punch file issue again.

_2009_04_28__14_08_25_ Chi-Hsiu Liang
   
   * Naming consistencies of flags in the manual and code.
     Please make sure that in your input files all me:testRateConstant are changed to me:testRateConstants

_2009_04_28__12_59_50_ Chi-Hsiu Liang

   * Add/delete file names in the makefile and VC8 file list.
   * Trim unnecessary variables in MesmerILT.cpp
   * Partition functions that are higher than the current simulation temperature will not be output.
   * Corrected reservoir state location units.
   * Corrected initialization of variables in Reaction.cpp
   * Corrected the action taken to produce punch file.
      Currently two options as described before <me:gridSearchWithPunch /> and <me:gridSearch />

2009-Apr-28 Chris Morley
   Reshape DOS method classes: main and extra
   * src/DensityOfStates.h, src/ClassicalRotor.h, src/QMRotor.h : main DOS methods
   * src/HinderedRotorA.cpp, src/HinderedRotorA.h: extra DOS methods added
     (in skeleton form only)
   * src/MolecularComponents.cpp: requires one main DOS class (default if necessary)
     and allows multiple extra classes

   * src/ClassicalRotor.cpp : remove const in countCellDOS() to be consistent
   * src/MolecularComponents.h: added a public function to access parent, and added
     parameter in getCellDensity OfStates() to prevent recalculation.
     (Otherwise get recursion in extra DOS classes.) 

   * src/ReactionManager.cpp,src/MesmerILT.cpp,src/SimpleILT.cpp,src/SimpleRRKM.cpp:
     add bool return to some functions to allow bailout on error
   * src/System.cpp: minor documentation and error message changes
   
   * Windows VC9/Mesmer/Mesmer.vcproj: updated (Windows VC8 abandoned)

2009-Apr-28 Struan Robertson

   * QMRotor.cpp/TMatrix.h: Initial implementation of asymmetric QM rotor energy level algorithm.

2009-Apr-27 Chris Morley

   * MesmerQA/QA.bat: correct VC9 mod and add display of mesmer version.
   * src/main.cpp: catch unknown options
   * src/XMLPersist.cpp: change wording of commment

2009-Apr-23 Chris Morley

   * mesmer1.xsl: display energy units correctly in molecule table.
       check that all energy units are the same and display an error message if not. 
   * mesmerDiag.xsl: display energy units below diagram
   * MesmerQA/i-propyl/ipropyl_test.xml: corrected title and 546.D0 which may be valid in
       some obsolete programming languages but isn't here.
       Now gives a more informative diagram. 

_2009_04_23__09_11_27_ Chi-Hsiu Liang

  * Move DPoint to a higher level. For the moment, DPoint is almist visible to any file in MESMER folder. Declaration of an DPoint value will
    increment the DPoint vector, and the access of the DPoint value is just like any other variables.
  * Fixed collision operator column sum in reservoir state.
  * Fixed VC8/VC9 qa.bat link so that it finds the newer version of the executables. Need to think about if letting user choose which executable to run.

2009-Apr-23 Chris Morley

  * Windows VC9/: Add VC++ 2009 project files. Dave mentioned he had tweaked
  the optimization but I could see where. Perhaps he could check that it is correct
  in the VC++2009 files.

  * src/ReactionManager.cpp, src/System.cpp:added cinfo.flush() at 
    various points during the parsing, to get a log output even in a crash.
     
  * MesmerQA/QA.bat: update executable to VC9

2009-Apr-19 Struan Robertson
  
  * System.h/.cpp: Minor tidying in preparation for fitting method.
  
2009-Apr-19 Struan Robertson
  
  * QMRotor.h/ClassicalRotor.h: More header file dependency decoupling.
  
2009-Apr-19 Struan Robertson
  
  * ReactionManage.h/MesmerILT.h: Replace derived class headers with base class to break include dependencies.
  
2009-Apr-19 Struan Robertson
  
  * ReactionManager.cpp/Reaction.h: Source term discovery pushed onto to derived reaction classes.
  
2009-Apr-19 Struan Robertson
  
  * ReactionManager.cpp: Minor change related to basis set methods.
  
2009-Apr-23 Chris Morley

  * Windows VC9/: Add VC++ 2009 project files. Dave mentioned he had tweakedt
  the optimization but I could see where. Perhaps he could check that it is correct
  in the VC++2009 files.

  * src/ReactionManager.cpp, src/System.cpp:added cinfo.flush() at 
    various points during the parsing, to get a log output even in a crash. 
  * MesmerQA/QA.bat: update executable to VC9

2009-Apr-19 Struan Robertson
  
  * ReactionManager.cpp: Minor change to correct for QA failure.
  
2009-Apr-17 Chris Morley
  
  * mesmer1.xsl: minor revision of wording of output.
  
2009-Apr-13 Struan Robertson

  * MesmerQA: Update of isopropyl test.

2009-Apr-7 Dave Glowacki
  *ReactionManager.cpp: fix some bugs which came to light for testing the i-propyl system- the case of 1 isomer with only irrreversible channels
  *clean up some other stuff

2009-Apr-5 Struan Robertson

  * ReactionManager.cpp: Fix for grid search, values for Einf where being calculated incorrectly.
  * MesmerQA: Update of isopropyl test.

2009-Apr-5 Struan Robertson

  * ReactionManager.cpp: New section added to estimate threshold of irreversible reaction, which is then used to determined energy limits.

2009-Apr-4 Struan Robertson

  * MesmerILT.cpp: Fixed problem with Unimoleculer ILT calculation.
  * MesmerQA: Update of isopropyl test.

2009-Mar-31 Dave Glowacki
  *add a few changes to LINUX MakeFile

2009-Mar-31 Dave Glowacki
  * updates to manual: (1) discussion of Linux compilation issues & (2) discussion of Bartis Widom output
  * add to Bartis Widom code so that it checks separation between CSEs and IEREs and generates warning messages if appropriate
  * update baselines

2009-Mar-30 Struan Robertson

  * MesmerQA: Initial checkin of isopropyl test.

2009-Mar-30 Dave Glowacki
  * fixed GCC compiler problem that showed up when testing 64 bit compilation

2009-Mar-26 Dave Glowacki
  * fixed GCC compiler problem that showed up when testing 64 bit compilation

2009-Mar-21 Struan Robertson

  * src/ReactionManager.cpp: Tidy-up of BuildReactionOperator method.

2009-Mar-21 Struan Robertson

  * src/AssociationReaction.cpp: Added code relating to contracted basis set method.

2009-03-14 Chris Morley
  
  * src/Persistence.h: make PersistPtr work with NULL content.
    (Previously only partially implemented.)
  * src/XMLPersist.cpp, src/XMLPersist.h: Move loading of defaults.xml until
  it is used, so that a fully formed XML file doesn't need it. Make more robust
  to missing defaults.xml and librarymols.xml.

_2009_03_13__11_48_50_ Chi-Hsiu Liang

  * Updated manual for reservoir state method
  * Added a QA for reservoir state method; about additional 1 minute will add to the QA test. 
    In these moderately high temperatures, 800K and 1000K, for the cyclopropene isomerization system,
    the approximation is not perfect and also the computational gaining is only about three times.
    From the suggestion of Dave, we are thinking about implementing a new species profile method
    that takes the values from the Bartis-Windom matrix, which could possibly save some additional time.

_2009_03_10__16_52_59_ Chi-Hsiu Liang

  * Corrected the Bartis-Widom rate code for irreversible terms.

_2009_03_10__12_40_45_ Chi-Hsiu Liang

  * Tidy up some unused code.

_2009_03_10__11_07_28_ Chi-Hsiu Liang

  * Corrected the lowest barrier calculation for wells.

2009-Mar-08 Struan Robertson

  * src/IsomeriationReaction.cpp: Added code relating to contracted basis set method.

2009-03-08 Chris Morley
  * src/main.cpp: Make overwriting the input file more difficult, needs an option:
     mesmer infile -o outfile      to outfile
     mesmer infile -n              to infile
     mesmer infile                 to "mesmer_out.xml"
    Copies of all overwritten files are saved with a _prev suffix.
  
  * Support for specifying multiple input files on the commandline.
    The first is normal and the molecules reactions etc from the subsequent
    ones are inserted into it in an intelligent way before use.
    Uses an additional function XMLPersist::Include().
    Example (files in examples/AcetylO2):
    mesmer AcetylO2reduced.xml O2OH.xml -o out.xml

  * mesmer1.xsl: Make display of inactive reactions and molecules interactive.
    It would have been better for them to be removed by CSS display:none but
    I couldn't find a suitable alternative value for the active state.
    Example file: examples/AcetylO2/Acetyl_O2_associationEx.xml
    Shows can possibly improve display by rearranging the order of the *reactions*.

_2009_03_06__23_08_04_ Chi-Hsiu Liang

  * Read the reservoir size information directly in  initCollisionOperator()
  * Corrected some code in BartisWidomPhenomenologicalRates() for reservoir grain method

_2009_03_06__14_35_05_ Chi-Hsiu Liang

  * Temporarily make MESMER not to overwrite the input file. Need to check if this is doing right.
  * Reports the reservoir grain location in wavenumber and kJ/mol
  * Fixed Bartis-Widom rates.
  * Fixed XMLPersist.h for compiling in 64 bits.

_2009_03_05__19_30_56_ Chi-Hsiu Liang

  * Fixed the AddReactionTermsWithReservoirState in all methods.

_2009_03_05__17_01_13_ Chi-Hsiu Liang

  * Improved the way of calculating the loss of reservoir entry. Cleaned up some unecessary code.

_2009_03_04__20_02_21_ Chi-Hsiu Liang

  * The reservoir grain approach now works. This is a snapshot of it. The input file Acetyl_O2_association_mytest.xml
    explains how to use this method. Now it works on association reaction. However, there are things to do:
    1. AddReactionTerms for all other reaction types
    2. Change the way of calculating "loss of the reservoir entry" in collision operator from summation of Boltzmann weighted 
       upward and downward transition terms to only the summation of downward transition terms and then multiplied by equilibrium 
       constant. This way can avoid numerical error through the summation processes.

_2009_03_04__11_56_32_ Chi-Hsiu Liang

  * Construction of another path of reservoir state treatment on low and inactive grains. (still debugging)
    This path simply assumes the reservoir grain to behave Boltzmann, which act like a source term.
  * Moved     void MolecularComponent::normalizeCollisionOperator(); from  to void TMatrix::normalizeProbabilityMatrix();
  * Added routines --     virtual void Reaction::AddReactionTermsWithReservoirState() = 0;

2009-03-01 Struan Robertson

  * ReactionManager.cpp/IsomerizationReaction.cpp: Minor changes related to contracted basis set method.  

_2009_02_25__15_31_59_ Chi-Hsiu Liang

  * Updated a bit of the manual.

_2009_02_25__11_28_06_ Chi-Hsiu Liang

  * Fixed compile problem in Cygwin. Converted some size_type to size_t.
    Reference: C++ International Standard clause 20.1.5.4. (part)
    The typedef members pointer, const_pointer, size_type, and difference_type are required to be T*, T const*, size_t, 
    and ptrdiff_t, respectively.

_2009_02_24__16_16_14_ Chi-Hsiu Liang

  * Moved countDimerCellDOS() to the end of MolecularComponent
  * Removed  m_pDensityOfStatesCalculator variable from MolecularComponent as this will be read in from XML and use directly.
  * Modified gDensityOfStates::calcDensityOfStates() so that it reads the DOSCMethod by itself.
  * Further prepared for other DOS calculator plugin
  * Reformat code to remove tabs. Please check the setting of tabs and spaces and make sure to use Ctrl+K Ctrl+F to 
    remove tabs in the code before check-in.

2009-02-22 Struan Robertson

  * ReactionManager.cpp/IsomerizationReaction.cpp: Sketch of contracted basis method added.  

2009-02-22 Struan Robertson

  * ReactionManager.cpp: Removed initial population code from BuildReactionOperator method to setInitialPopulation method, in
preparation for basis set work.
  * Updated baselines that have altered as a consequence of the above changes.

2009-02-21 Struan Robertson

  * TMatrix.h: Reviewed use of type int and replaced with size_type where appropriate.
  * Removed warning messages concerning double to int conversion by adding two new functions to XMLPersist.

_2009_02_20__16_17_31_ Chi-Hsiu Liang

  * Accounts for QM rotors that are close to prolate/oblate symmetric or spherical.

_2009_02_20__13_06_31_ Chi-Hsiu Liang

  * Intemediate version while building SS-RS-ME and QM rotors.
  * Add     bool doSSRSMethod;                    // Run steady state and reservoir state routine
    in MesmerFlags.
  * Does empty DOS grain checking. Put the highest cell energy as the grain energy if no average grain energy is available.
  * QM rotor plugin class is examed. Now modifying it again to add near-symmetric top rotor.

_2009_02_16__14_00_39_ Chi-Hsiu Liang

  * Correct an missing part of mesmer.log during merge in main.cpp
  * Commit the change in mesmer.log

2009-02-15 Chris Morley

	* MesmerQA/QA.bat: add an output file to avoid overwriting the
	input file with new non-timestamp interface.
	
	* src/main.cpp: cosmetic change to remove "in main" from cerr output.

	* mesmerDiag.xsl: use also alternative <rateParameters> form
	(as well as <me:activationEnergy>) to show pseudo ILT TS.
	Add check that ILT is being used for the reaction.

2009-02-14 Chris Morley

	* Documentation/Getting StartedTutorial.html: added
	* librarymols.xml,mesmer1.xsl,mesmer2.xsl,mesmerDiag.xsl:
	updated. (Didn't seem to happen at last merge.)
	* src/main.cpp: Remove timestamps from XML filenames and save
	with _prev suffix any existing files about to be overwritten.
	* src/MolecularComponents.cpp,src/System.cpp,src/System.h:
	Further simplification of parsing (more to be done).

_2009_02_13__18_22_02_ Chris Morley  -- Change merged by Chi-Hsiu Liang from branch WithDefaults

  * If a required property/element or attribute is missing a default version is added to XML file, possibly with text 
    to alert user to check the default values.

  * Improved XSLT files: can normalise large E values; handles missing E on products; shows or hides active="false" 
    molecules or reactions;crude horizontal scaling for files with large number of wells.

_2009_02_11__19_01_57_ Chi-Hsiu Liang

  * Removed an unused routine declaration void calculateGrainTunnelingCoeffs() in Reaction.h
  * Some progress in making the construction of SS/RS-ME (commented out).
  * m_locSizeMap is a vector storing the location and size information of the isomer and source terms in the full matrix 
    and reduced matrix. See declaration of struct locationIdx in ReactionManager.h
  * Added the diagonalization part of the reduced basis matrix.
  
  Note: To use reduced basis sets please look into pentyl_isomerization_mytest.xml in pentyl folder. 
        <me:runBasisSetMethodroutines /> in <me:control> turns on the routine.

_2009_02_03__14_14_06_ Chi-Hsiu Liang

  * Constructed reduced basis matrix. Time to think about how to use this matrix. 
    There are several candidates at the moment:
      1. Basis set method suggested by Struan;
      2. SSME suggested by Nick;
      3. Reweighting the phase space of the modified potential used in protein folding.
    However, the current objective will be first finishing the basis set method.
    Bartis-Widom rate for basis set method is now under construction.

_2009_01_30__17_50_04_ Chi-Hsiu Liang

  * The difference of the k_infinity is identified as that the k(E)s in the reaction operator is normalized unit of time.
    So if one wants to get back the k_infinities he needs to multiply the values by omega.

_2009_01_30__11_53_42_ Chi-Hsiu Liang

  * Added a test file in pentyl system for basisset method.

_2009_01_29__20_05_31_ Chi-Hsiu Liang

  * Changed the names of isomerMap and sourceMap to molMapType.
  * Added a routine matrices_multiplication() in MesmerMath.h
  * Added a routine   void ReactionManager::constructBasisMatrix(void)
    which constructs a basis matrix M''. This matrix is the reaction operator transformed by the conserve-well eigenvectors.
    The whole idea is still under testing. It is made sure that when there is no isomerization by commenting out the reaction 
    terms in IsomerizationReaction.cpp, the basis matrix is simply a matrix filled with diagonal terms, which are the eigenvalues
    of the conserved-well, whereas the rest entries of the matrix are nearly zero.
    Now it is required to test: 1. whether the lower-right members of the respective wells are k_infinity's. It is observed that
    the values are propotional to k_infinity's but it is unsure why they are different.

_2009_01_26__16_47_26_ Chi-Hsiu Liang

  * Tidied up and made sure MESMER also compile on cygwin.

2009-01-25 Chris Morley -- Version merged from v284-285 in branch FlattenedMolecule

  If get functions (like Molecule::getDOS()) for MolecularComponents fail 
  they now make a new object.
  
  The initialization of MolecularComponents has been moved from InitializeProperies()
  to the constructors. This prevents the use of an unitialized MolecularComponent.
  
  Remove Molecule::activateRole() and roleIsActivated() so that the properties
  are read from the XML file only when they are needed in the calculation.
  This was really just to that it could be done. Something similar will have to
  be added back so that the the presence of all the required data can be checked
  in a parsing phase, before the big calculation starts.
   
  * src/main.cpp: added try/catch around parsing and calculating. 
  Needed for errors in MolecularComponents constructors. When the new way of 
  handling default values is added, this exception will be activated only rarely
  when there is a mistake in the permanent file defaults.xml. User mistakes in 
  their input XML files should not throw an exception, but will do something more
  helpful.
  On with modifying the defaults handling code...
  
  There are small numerical differences in Acetyl O2 association QA test 
  between the Debug and Release builds. The baseline mesmer.test is for the
  Debug build.
    
_2009_01_26__12_20_35_ Chi-Hsiu Liang -- Version merged from v283-284 in branch FlattenedMolecule

  * Change the MolecularComponent pointers in Molecule to be private, and provide manipulator functions for these member pointers.

_2009_01_26__12_16_12_ Chi-Hsiu Liang -- Version merged from v282-283 in branch FlattenedMolecule

  * Changed some variable and function names related with "system collision operator" to "reaction operator"
  * Add a flag to switch on the DOS weighted downward collision in transition matrix.
  * Add a flag to show collision matrix for any well.
  * Add a flag to turn on basis set method. Basis set method is not yet applied in this version.
  * Modified matrices_multiplication() in MesmerMath.h
  * Add a function diagonalizeCollisionOperator() in MolecularComponent
  * Declared two variables
      dMatrix             *m_egvec ;               // Eigenvectors used to diagonalize (P - I) matrix.
      std::vector<double>  m_egval;
    in MolecularComponent.h
  * In ReactionManager:
    Added several variables for building the basis set method.
    Change m_pReactionOperator to m_reactionOperator.
  * Other minor modifications.
  * Will start to inspect the int issue regarding to the migration of MESMER to 64 bit platform.
  
_2009_01_26__12_09_11_ Chi-Hsiu Liang -- Version merged from v281-282 in branch FlattenedMolecule

Add forgotten namespace declaration.

_2009_01_26__12_09_11_ Chi-Hsiu Liang -- Version merged from v280-281 in branch FlattenedMolecule

Checked in for a a prepared routine in matrix multiplication. (not tested)

_2009_01_26__12_06_20_ Chris Morley -- Version merged from v279-280 in branch FlattenedMolecule

Some formatting of XSL files.

_2009_01_26__12_01_50_ Chris Morley -- Version merged from v278-279 in branch FlattenedMolecule

Display (reverse) for reverse ILT

_2009_01_26__11_59_00_ Chris Morley -- Version merged from v277-278 in branch FlattenedMolecule

Shows activation barrier from reverse ILT

_2009_01_26__11_53_26_ Chi-Hsiu Liang -- Version merged from v276-277 in branch FlattenedMolecule

A tagged version that flattens class Molecule 

2008-12-16 Chris Morley

  * Added project title: XML tag, member variable in System, displayed when
    XML transformed by mesmer1.xsl.
    Add a title to XML files in MesmerQA.
    
  * Output Bartis-Widom rates to XML file in a new section <analysis>
    Update mesmer1/xsl to display this section and with other cosmetic changes.
    
  * Update mesmerdiag.xsl to show activation energy barriers, and handle
    reactions with no product energy.
    
  * Corrected some memory leaks by deleting reactions in the ReactionManager
    destructor. This showed up incorrect deletion of m_sourcemap (not assigned
    by new) in AssociatioReaction and IrreversibleExhangeReaction.
    
  * Added licence text at the top of main.cpp. This will need to be in every file.
  
  * Trivial numerical differences in Acetyl O2 association QA test, which I don't
    think I caused. Assuming ok, but needs updating.     

_2008_12_14__16_26_45_ Chi-Hsiu Liang

  * Added a punch file option with grid search. 
    Syntax:     <me:gridSearchWithPunch />
  * Updated manual.

_2008_12_10__11_41_02_ Chi-Hsiu Liang

  * Updated Manaul: Firefox usage, compression of release, deltaEdown syntax, etc.

_2008_12_03__12_16_02_ Chi-Hsiu Liang

  * Corrected a forgotten plugin class object compilation in Makefile

2008-12-2 David Glowacki

   * Updated some comments in the code

_2008_12_02__11_36_08_ Chi-Hsiu Liang

  * Changed manaul auto-formatting on Normal style

_2008_12_02__11_33_34_ Chi-Hsiu Liang

  * Updated manual

_2008_12_01__18_46_06_ Chi-Hsiu Liang

  * Updated a parameter list in Mesmer manual

_2008_12_01__16_51_58_ Chi-Hsiu Liang

  * Revert Mesmer manual to 253 and reapply changes.

_2008_12_01__11_25_49_ Chi-Hsiu Liang

  * Corrected an initialization order error in ModelledMolecule.
  * RRKM method checks the existence of transition state.
  * Corrected a compiler error for Linux system in TMatrix.h

_2008_11_28__12_56_33_ Chi-Hsiu Liang

  * Further modified QA.bat to make it clearer to users and developers. Corrected a small problem.
  * Minor modifications on timeEvolution(). Make sure the integration of species profile not to give negative values for isomers.
  * Introduced one more inversion methods in TMatrix.h uses LU decomposition: invertLUdecomposition()
  * Updated manual

_2008_11_27__15_32_52_ Chi-Hsiu Liang

  * Modified QA.bat so that it issues -q flag when normal "qa" command is requested; copies mesmet.test into the baseline
    folder as test.test
    When "qa -o" is requested, it does not issue -q flag, but overwrites baseline files by the current output files.

_2008_11_26__17_32_30_ Chi-Hsiu Liang

  * Replace fabs by abs (STL has already overloaded all precisions for abs)
  * Changed inver() to invertGaussianJordan() and added another inversion option invertAdjointCofactors() in TMatrix.h
  * Added a control flag bool me:printTabbedMatrices, default false to prevent user from entering delta E down smaller than
    gransize.
  * me:printTabbedMatrices to control whether to output matrices in tabbed form instead of inserting spaces.
  * Added a flag to control the size of the matrix that is going to ctest stream. See void Matrix<T>::showFinalBits().
  * Reduced some warning message in compiling time by giving Visual Studio
    AdditionalOptions="/D_CRT_SECURE_NO_DEPRECATE /D_SCL_SECURE_NO_DEPRECATE"

2008-11-23 Chris Morley

  * Added me:Hf298 property to be use if me:ZPE not present.
    ZPE calculated fron Hf298 and written back. 
    *** But calculation is currently not correct and needs attention ***
    
  * Add XmlWriteProperty()
  
  *  Add m_EnergyConvention to ModelledMolecule and check it is the same
    for all molecules.
    
  * Get context working for error messages, simplify some ifo message in
    ModelledMolecule::InitializeMolecule. Simplify console messages.
    Make -n option notimestamps work and change its description.
  
  * Simplify UnitsConversion and add more erro checking. 
    
2008-11-23 Struan Robertson

   * Updated Mesmer documentation with a discussion on the origin on the C' constant.

2008-11-18 Chris Morley

  * Make datafiles work with with XSLT tab in XMLNotepad.
    Now two stylesheet declarations:
    <?xml-stylesheet type='text/xsl' href='../../mesmer2.xsl' media='other'?>
    <?xml-stylesheet type='text/xsl' href='../../mesmer1.xsl' media='screen'?>
    The first is used by XMLNotepad; mesmer2.xsl is without diagram which uses
    XSLT extensions. The second by Firefox3. Not sure how robust the choice is...

_2008_10_28__09_47_18_ Chi-Hsiu Liang

  * Added the error report for delta_E_down smaller than grain size.
  * showFinalBits() takes input 0 to print the whole matrix.

_2008_10_13__13_38_48_ Chi-Hsiu Liang

  * Simplify the dt vector and updated Acetyl+O2 baseline. Ketene species profile should not reduce in the beginning as this is
    an irreversible reaction.

_2008_10_10__12_41_53_ Chi-Hsiu Liang

  * Give irreversible reactions a equilibrium constant function. Although there is no equilibrium but according to the partition functions, 
    one can still define a first order equilibrium constant.
  * Define functions pdtsRovibronicGrnCanPrtnFn() and rctsRovibronicGrnCanPrtnFn() in all reactions.
  * Allow user to input ILT parameters in reverse direction for irreversible unimolecular reactions.

_2008_10_02__14_26_22_ Chi-Hsiu Liang

  * Removed many instances of TSFlux to simply flux to reflect that flux does not directly relate with transition state.
  * Added a commented out section trying to fix the low temperature deviation in association k_infinity from the Arrhenius expression.
  * Modified some naming of variables and functions.
  * AssociationReaction::testRateConstant() now calculates dissociation k(E)s in cells for more accurate canonical rates.
  * Added function CollidingMolecule::normalizedCellBoltzmannDistribution(vector<double> &cellFrac, const int startingCell)
    for calculation of Boltzmann distribution in cell level.
  * Note: This version still have problem reproducing correct association rate in low temperatures.
  * Updated two baselines.

_2008_09_15__13_46_24_ Chi-Hsiu Liang

  * Make tunneling unavailable in ILT (need more thought)
  * Make user clearly defines ILT parameters.
  * In ILT, E_infinity should always be positive and also higher than heat of reaction.

_2008_09_15__10_26_45_ Chi-Hsiu Liang

  * Further clean up the code in ReadRateCoeffParameters() and InitializeReaction()
  * Updated Manual

_2008_09_12__16_11_05_ Chi-Hsiu Liang

  * Check in the changes Dave made on unimolecular ILT and corrections on the work vector in ILT. Please check the changes
    in MesmerILT.
  * Reorganize ReadRateCoeffParameters() in different reactions into one function in Reaction.

_2008_09_10__14_28_16_ Chi-Hsiu Liang

  * Separated out control flags from MesmerEnv to MesmerFlags
  * Re-enable printing DOS of source term when flag is turned on
  * Renamed m_pSystemCollisionOperator to m_pReactionOperator to reflect that this operator does operate on reactions.
  * Updated manual

2008-9-8 Dave Glowacki

* fixed a bug in Association Reaction and MesmerILT which incorrectly calculated Tinf
* updated the baseline input file for acetylene-OH + O2 in order to get rid of confusing structure

_2008_09_08__15_54_34_ Chi-Hsiu Liang

  * Add a section to turn on the printing of reaction operator.
  * Updated the manual.

_2008_08_29__18_20_54_ Chi-Hsiu Liang

  * Clean up some console and log messages/time stamps.

2008-8-29 Dave Glowacki

* fixed a bug in testRateConstant() routine in irreversible exchange reaction class which did not reset the canonical loss rate to 0 in a grid search
* changed reaction class member data m_forwardCanonicalRate and m_backwardCanonicalRate from protected to private, added set and get functions for
  this member data, and made appropriate changes to other derived reaction classes

_2008_08_29__11_45_44_ Chi-Hsiu Liang

  * Removed Overloading of countCellDOS() in ClassicalRotor and update baselines.

_2008_08_29__11_06_12_ Chi-Hsiu Liang

  * Modified README
  * Provide the class DensityOfStatesCalculator a virtual function that convolutes reactants DOS directly by 
    fast Laplace transform. In which, removed some unnecessary functions, variables from AssociationReaction and 
    IrreversibleExchangeReaction. countDimerCellDOS() is kept in this version.
  * Add a section to explain output file in the Manual.
  * Modified QA.bat so that beep the calculation is finished and also copy mesmer.log.
  * Baseline changes

Note: The convoluted DOS of reactants are higher in the leading numbers compared with the DOS from analytical convolution,
      which causes higher microcanonical rates in the leading grains. 

2008-8-27 Dave Glowacki

* alter the code in order that it can handle negative threshold energies for the RRKM k(E) calculations
* a new function, calculateTSfluxStartidx, has been added to Reaction.cpp in order to calculate which grain is the first grain for
  calculation of k(E)s from the TS flux vector
* a new pure virtual function, calculateEffectiveGrainedThreshEn, has been added to Reaction.  appropriate versions of this function 
  have been added to Reaction's derived classes 
* the AddreactionTerms function in each of the derived reaction classes has been updated to cope with negative threshold energies  
* a bug which calculated an incorrect cell offset in the HOSO2 test system has been corrected; it involved small changes on
  ReactionManager and Molecule 
* the code in MesmerILT for coping with negative activation energies has been removed, as a negative activation energy is nonsensical
  for the association ILT routine
* miscellaneous changes to clean up comments and spelling errors
* update all baselines

_2008_08_27__11_37_58_ Chi-Hsiu Liang

  * Change baselines

2008-08-23 Chris Morley

	* src/Reaction.h, src/ReactionManager.h: 
	The maps types which have Molecule* or Reaction* as keys, isomerMap,
	sourceMap, sinkMap, given a functor parameter which orders them by name.
	Ordering by pointer value was unpredictable.
	
	* src/ReactionManager.cpp: Iterators defined in terms of typedef
	of map.
	
	*** QA test failed - the reason needs to be found, since they should not
	happen by changing only the order in the maps.

2008-08-21 Chris Morley

	* src/ReactionManager.cpp: improve error handling in addreactions()
	and GetMoleculeInfo(). Was crashing on ill-formed datafiles. 
	* src/Persistence.h: add comment that XmlRead, etc can return NULL
	* src/oberror.h: add AppendContext()
	* src/main.cpp: restore spacing in output stream documentation

_2008_08_20__16_42_31_ Chi-Hsiu Liang
  
  * Update manual 

2008-08-20 Chris Morley

	* mesmerDiag.xsl: Sort out vertical scaling

_2008_08_19__12_52_01_ Chi-Hsiu Liang

  * Updated manual

_2008_08_18__15_26_21_ Chi-Hsiu Liang

  * Add variables for additional <delta_E_down> dependency to temperature.
    The function is
    // Exponent of <Delta E down> according to the relation
    // <delta_E_down>(T) = <delta_E_down>_ref * (T / m_DeltaEdownRefTemp)^n
    // where m_DeltaEdownExponent is the exponent n
    // By default, n = 0, which means delta_E_down does not depend on temperature.
  * Recover the section printing grained species profile

_2008_08_11__18_07_40_ Chi-Hsiu Liang

  * Add an additional flag for command line mode, -N, which force the name of the test and log to be the same as the input XML
    For example, if input XML is Acetyl_O2_association.xml, then the test file will be Acetyl_O2_association.test, and the
    log file will be Acetyl_O2_association.log. However, the timestamp of the input file will be discarded. So, if the input
    file name is Acetyl_O2_association.20080811_181138.xml, the test file will still be Acetyl_O2_association.test.
    This flag will allow user to run multiple jobs in the same folder without having the test files overwriting each other.
  * Corrected the initialization order of class variables in Reaction classes.
  * Compile OK in cygwin.

2008-8-08 Dave Glowacki

* irreversible exchange reactions are now working in the recently added benzene oxidation system
* addReactionTerms routine has been added in IrreversibleExchangeReaction class
* irreversible and exchange reaction class have been replaced by irreversibleunimolecular reaction and irreversibleexchange reaction classes
  and changes to MESMER have been implemented in order to incorporate these classes
* implement testRateConstant routines in all reaction classes
* correct output stream printing in microrate.cpp
* added forwardcanonicalrate and backwardcanonical rate data & corresponding handling functions to reaction class
* changes to reactionmanager in order to incorporate printing of product yields and phenomenological rate that correspond to
  irreversible exchange reactions
* update all baselines
* manual updates

_2008_08_07__11_59_16_ Chi-Hsiu Liang

  * Corrected flux bottom ZPE for transition state (a fix for ZPE lower than 0.0)
  * Minor correction on   bool AssociationReaction::InitializeReaction(PersistPtr ppReac)
  * updated manual

2008-08-06 Chris Morley

	* mesmerDiag.xsl: make <propertyList> optional. Diagram for
	HSO2.xml now works.

	* examples/DiagramTest/HSO2.xml, MesmerQA/HSO2/HSO2.xml:
	add MW and spinMultiplicity properties and a conditions section.

	* Windows VC8/Mesmer/mesmer1.xsl, Windows VC8/Mesmer/mesmerDiag.xsl,
	Windows VC8/Mesmer/switchcontent.js: delete. (Now in toplevel directory.)

_2008_08_05__11_19_05_ Chi-Hsiu Liang

  * Corrected the way calculating reactants ZPE in AssociationReaction
      See: const int rctGrainZPE = get_rctsGrnZpe();
      Also:     int get_cellOffset(void)  for AssociationReaction
  * Removed   const int ModelledMolecule::get_grnZpe()
      to      const int CollidingMolecule::get_grnZpe()
      so that it calculates relative ZPE to the lowest well directly.
      and remove   double ModelledMolecule::get_relative_ZPE()
  * Calculates  configuration() when user explicitly requests it in XML input.
  * Corrected the initialization of deficientReactantLocation in ExchangeReaction.h
  * Updated OH acetylene baseline

2008-8-04 Dave Glowacki

* make changes to Association Reaction and Exchange reaction in preparation for sorting out exchange reaction
* update baselines
* manual updates

_2008_08_04__11_20_17_ Chi-Hsiu Liang

  * Change the format of grid parameter list

2008-8-03 Struan Robertson

  * ReactionManager.cpp: Further minor tidying.

2008-8-03 Struan Robertson

  * ReactionManager.cpp: Minor tidying and removal of unnecessary down casts.

_2008_08_03__12_15_44_ Chi-Hsiu Liang

Update the manual and check for chmlin14 usage.

_2008_08_02__23_04_32_ Chi-Hsiu Liang

  * Removed some variables related with heat of reaction, cell offset and grain ZPE. These variables should be calculated
    on the fly. This solves inconsistency problem in grid search.
  * Updated baselines. Most baselines changes are due to the correction in shifting wells of source term and transition states.
    All corrections are in good agreement with the baselines based on version 179.
  * The difference in the species profile of pentyl baseline between version 201 and version 198 is due to the population starts
    from alternative species.

2008-8-01 Dave Glowacki

* fixed a bug in fast laplace transform routine in mesmermath.cpp

_2008_08_01__15_35_33_ Chi-Hsiu Liang

  * Corrected the cell offset error produced during the process of removing SuperMolecule. Some functions are added for
    AssociationReaction.
    Variables added in AssociationReaction:
      std::vector<double> m_rctsCellEne ;   // Cell energies of reactants.
      std::vector<double> m_rctsCellDOS ;   // Convoluted cell density of states of reactants.
      std::vector<double> m_rctsGrainEne ;  // Grain average energy array.
      std::vector<double> m_rctsGrainDOS ;  // Grain density of states array.

    Functions added in AssociationReaction:
      rctsRovibronicGrnCanPrtnFn()
      calcRctsDensityOfStates()
      getRctsCellDensityOfStates(vector<double> &cellDOS)
      getRctsCellEnergies(vector<double> &CellEne)
      getRctsGrainDensityOfStates(vector<double> &grainDOS)
      getRctsGrainEnergies(vector<double> &grainEne)

  * Make countDimerCellDOS() a virtual function of class DensityOfStatesCalculator.
  * Removed SuperMolecule.cpp
  * Removed m_pDensityOfStatesCalculator from MesmerILT
  * Moved shiftCells() and calcGrainAverages()
    function from ModelledMolecule to MesmerTools. This is more of a tool than a molecular specific function.
    AssociationReaction now uses these function.
  * Updated part of the manual.
  * Updated baseline for Acetyl+O2 and OH+acetylene systems.

2008-7-30 Dave Glowacki

* added Bartis Widom eigenvalue eigenvector analysis to get phenomenological rates for irreversible reactions
* added a member function to a2d.h to print out db2d matrices
* updated all baselines

2008-7-30 Dave Glowacki

* miscellaneous small changes to reaction manager.cpp for output file printing
* updated all baselines
* changed QA.bat to include acetyl + O2 test system

2008-7-27 Struan Robertson

  * Mesmer.vcproj updated to account for the deletion of SuperMolecule.cpp.

2008-7-27 Struan Robertson

  * Molecule.h, ClassicalRoror.cpp: Public data changed to protected.

2008-7-27 Struan Robertson

  * Molecule.h etc.: Removal of SuperMolecules and minor baseline updates.

2008-7-26 Struan Robertson

  * ClassicalRotor.cpp/.h, MesmerILT.cpp: Further rationalization of SuperMolecules.

2008-7-26 Struan Robertson

  * Baseline update following fixes in version 192.

2008-7-26 Struan Robertson

  * AssociationReaction.cpp: Found bug in equilibrium constant of association reaction which was using SuperMolecule. Altered to use
individual reactant partition functions and reinstated code rolled
back earlier.

2008-7-26 Struan Robertson

  * Winding back other changes to fix broken HOSO test.

2008-7-26 Struan Robertson

  * ReactionManager.cpp: Temporary fix for broken HOSO test.

2008-7-25 Struan Robertson

  * Removed broken header file references from Mesmer project file.

_2008_07_14__13_22_07_ Chi-Hsiu Liang

  * Updated baselines using Version 179

Chi-Hsiu Liang

  * Altered  if(nologging) flag in oberror.cpp
  * Corrected the initialization (new) and destruction of m_pSystemCollisionOperator. This causes Mesmer to crash after hundreds
    of calculations.
  * rr[i] = to_double(rrProxy[i]); =>  rr[i] = rrProxy[i];

2008-7-13 Struan Robertson

  * MesmerILT.h/.cpp : Altered so that the convolved density of states is calculated by explicit invocation and not via the modelled molecule route. This is possible because this method can only be used in conjunction with MesmerILT. This allows the removal of some SuperMolecule references in ClassicalRotor.cpp.

2008-07-06 Chris Morley

  * src/main: Documentation of mesmer output streams

2008-7-13 Struan Robertson

  * ReactionManager.cpp: Removal of reference to SuperMolecules. This reference was used to store the combined zero point energy location of the reactants. This is now stored on the pseudo-isomer.
  * AssociationReaction.h/.cpp, Reaction.h: Changes related to the above.

2008-7-13 Struan Robertson

  * ReactionManager.cpp: Removal of unnecessary reference to SuperMolecule class.
  * MesmerILT.cpp: Check of reaction type (Mesmer ILT only applies to association reactions) and minor changes to use AssociationReaction rather than SuperMolecule.
  * AssociationReaction.h: Addition of method to obtain pointer to
reactant in excess.

2008-7-12 Struan Robertson

  * AssociationReaction.cpp/Molecule.h: Remove of unnecessary methods from SuperMolecule class.

2008-7-12 Struan Robertson

  * ReactionManager.cpp/.h: Replaced an invocation of get_bi_molecularspecies with get_pseudoIsomer as part of the rationalization of SuperMolecules.

2008-07-06 Chris Morley

  Provide -g option which turns off cinfo and ctest streams and may solve the problems
  Alvyn was having with overflowing buffers.

_2008_07_09__15_39_30_ Chi-Hsiu Liang

  * Make zeroCount in matrix inversion routine an int array instead of an int vector. This removes address deallocation problem.

_2008_07_09__14_08_28_ Chi-Hsiu Liang

  * Removed all long double for cross platform consistency (Windows Visual C++ compiler maps long double to double)
  * Changed m_pSystemCollisionOperator to quad double.
    I suspect some diagonalization problem caused by the accumulated error when the addition of values in AddReactionTerms
    are done in double instead of higher precision. For every variable type such as double, long double, double double and
    quad double, there is a limit called epsilon. Epsilon is the smallest non-trivial number you can add with 1.000.
    If many number smaller than this number is added/deducted in the collision operator and later divided, it may have big
    difference. For example,
    m = 3.14159265 + 0.000000001 = 3.141592651 but if truncated it will remain as 3.14159265
    And if many number smaller than 0.000000001 are added to m and later m is substracted by 3.14159265 and divided by something
    else, the result will be very wrong.
    So when numbers are multiplied their magnitude is more important than their tailing numbers, but when numbers
    are added/deducted and then perform multiplication and division, their tailing numbers have increased importance.
  * Move m_ActivationEnergy from AssociationReaction to Reaction, as not only AssociationReaction can use ILT.
  * Added a class DPoint to store numbers that can be modified later. See definition of Pointer.h and Pointer.cpp
  * Added grid search function for paramters (Ninf, Ainf, ZPE, Einf and delta_E_down) with the assist of Pointer.
    Check get_range() and set_range() to see how values are initialized and modified.
  * Corrected dMatrix.h so that all matrices are always properly initialized to zeros.
  * Added System::configuration() to print out platform dependent precision information.
  * Added a fitting routine (search method to be added later, planned to be genetic algorithm)
  * Added a reset() function for Matrix.h
    corrected line 143 of Matrix.h
    if (this != rhs) {
    if (this != &rhs) {
  * Relocated a line
    const std::string TestSubFolder("baselines\\Win32\\mesmer.test"); //relative to the data file
    in MesmerConfig.h
  * Added a routine to calculate chiSquare (least square method) to compare with experimental values. experimental values
    can be input by syntax like the following

    <me:PTs>
      <me:PTpair me:units="Torr" me:P="100.0" me:T="500" me:precision="double" >
        <me:experimentalRate ref1="acetyl" ref2="acetyl" error="2.93e+03">7.04e+04</me:experimentalRate>
      </me:PTpair>
    </me:PTs>

    where ref1 and ref2 are molecular IDs. if ref1 == ref2, this value will indicate the loss rate.
    if ref1 != ref2, this value will indicate the rate from ref1 to ref2.
    See struct conditionSet for the definition of experimental value and error.

2008-07-06 Chris Morley

  Give Reaction::GetMolRef() a default molecule type to be used if no me:type.
  Allows simplification of:
  <me:transitionState>
    <molecule ref="TS_1a" me:type="transitionState" />
  </me:transitionState>

  Added library facility for molecules. Missing molecules are looked for in LibraryMols.xml
  in a folder specified by the Environment Variable MESMER_LIBRARY. Unless the -l option
  is specified, they are copied into the datafile (with an element describing their origin)
  if the parsing is successful.
  Searching all files in the specifed folder (like other mesmer files) would be better,
  but requires platform-dependent code. Maybe later.

  Added XmlCopyElement and XmlWriteMetadata to IPersist and XMLPersist for the above.

  Alternative form for <property> element accepted (to suit OpenBabel output):
  <property title="localname">
  as well as:
  <property dictRef="name">

  -q option does a QA test, comparing the current mesmer.test with the baseline file two folders
  down from the datafile. Doing it this way, rather than all by scripting, makes routine testing
  while debugging easier.

_2008_07_02__14_15_31_ CHi-Hsiu Liang

  * Minor change of formatting that goes to update baselines
  * Addtion of OH acetylene association system into the QA
  * Added a DOS batch for QA, which located in MesmerQA folder. Need to write another bash script for Linux baselines.

2008-6-30 Chris Morley

* added examples and examples/DiagramTest and versions of xml files. These work with
  the xsl files in the top directory.

* mesmer1.xsl, mesmerDiag.xsl: modified to handle bimolecular reactants and products.
  NOTE: needs Firefox 3 and you need to:
    1) type about:config in the address bar
    2) right click security.fileuri.strict_origin_policy and change it to false
  Not all examples work yet - work in progress - but Acetyl_O2_association.xml looks ok.

* src/main.cpp: added bail out if there is a gross error on the input file.

2008-6-30 Dave Glowacki

* added routines to reactionmanager.cpp in order to calculate product yields as a function of time.  because the product yields are calculated
  based on a numerical integration and require a finite timestep, there is some residual numerical error in their calculation - i.e., the sum
  of the product yields vs time doesnt agree EXACTLY with the calculated total product population calculated as 1 - (the total isomer population).
  the error is very small (within 1%), but the product populations are nonetheless normalized in order to agree exactly with the total
  product population
* changed the routines for printing isomer species profiles and the print format
* made changes to IrreversibleReaction.cpp in order to (1) clean it up and (2) facilitate calculating and printing out time dependent sink profiles
* got rid of the sink molecule class
* updated baselines: acetyl + O2, HSO2, pentyl, OH+acetylene, and cyclopropene

_2008_06_27__16_44_38_ Chi-Hsiu Liang

  * Corrected MesmerILT so that it can deal with negative Einf
  * Corrected AssociationReaction::testRateConstant(). Now the rate of association (loss rate of source) will asymptotically
    approach k_inf(T) as the pressure going higher.

_2008_06_24__13_00_37_ Chi-Hsiu Liang

  * Added testRateConstant() which displays k(T) for AssociationReaction
  * Added a flag MesmerEnv speciesProfileEnabled for printing species profile

_2008_06_23__15_49_31_ Chi-Hsiu Liang

  * Removed the account for electronic degeneracies in MesmerILT.cpp as electronic degeneracies are already accounted for in
    the DOS calculation.

_2008_06_23__12_21_17_ Chi-Hsiu Liang

  * Minor corrections. Removed the check of partition function difference on calcEquilibriumConstant() of AssociationReaction.cpp

_2008_06_20__14_23_40_ Chi-Hsiu Liang

  * Minor modifications on TMatrix.h for Linux compiler error.
  * Updated Manual
  * Removed unnecessary bits in Makefile

_2008_06_19__15_01_20_ Chi-Hsiu Liang

  * Minor modifications

2008-6-18 Dave Glowacki

* added an implementation of FFT algorithm in Memsermath
* added a routine called FastLaplaceConvolution in Mesmermath for fast convolution of data.  several tests were performed
  comparing the output with the standard convolution output.  in the FastLaplaceConvolution output, it was found that the values of the
  initial elements suffer from precision issues.  For the ILT convolution, only the first few elements are unreliable, but a substantial fraction
  of the elements following the tunneling convolution are unreliable.  this is due to the very small values for several elements in
  in the tunneling probabilities vector, at energies far below the classical threshold.  thus, FastLaplaceConvolution includes a standard
  convolution algorithm to fix values that are in error by more than 1%.
* fixed an error in MesmerILT that convoluted the wrong data sets
* increased the precision in timeEvolution routine to long double to get better species profiles at long times
* updated baselines:  pentyl, HSO2, and cyclopropene are essentially unchanged, and the differences in the acetyl+O2 and
  acetylene + OH baselines result from the changes listed above.  with the FFT, both of these simulations are now much faster, and should be
  added to the standard baseline testing protocol for subsequent changes.

_2008_06_18__14_15_13_ Chi-Hsiu Liang

  * add normalizedBoltzmannDistribution() to distinguish from   void CollidingMolecule::normalizedInitialDistribution()
  * added ldMatrix for long double matrix
  * added options for user to calculate diagonalization at higher precisions dd and qd

_2008_06_17__14_22_17_ Chi-Hsiu Liang

  * Created a templated class TMatrix.
  * Added ddMatrix and qdMatrix
  * Added additional precision option for marry.h

_2008_06_17__10_39_47_ Chi-Hsiu Liang

  * Renamed DissociationReaction to IrreversibleReaction
  * Cleaned up InitializeReaction() in several Reaction classes.
  * Cleaned up MesmerPrecision.h (now we can start to define ddMatrix and qdMatrix)

2008-6-13 Dave Glowacki
* added Bartis Widom method for calculating first order & psuedo first phenomenological rate coefficients for
  isomers.  the method has been added to reaction manager, and does not presently include orthogonalization
  of the Z matrix.  it has been tested on all systems except methylene D2 association, and the results are sensible.
  in order to test, several of the baseline input files were changed in order to give eigenvalues that were:
  (1) all negative, and (2) showed good separation between the CSEs and IEREs.  the rate coefficients and a few accompanying
  diagnostics for determining reliability of the eigenvectors are now printed in mesmer.test
* added a Species Sequence map to reaction manager for use in equilibrium fraction matrix inversion and
  bartis widom method
* fixed the following bug: in the previous version of MESMER, when more than 1 grid point was calculated,
  MESMER give different results for identical conditions.  this is because several vectors for holding reaction flux,
  DOS, tunneling coefficients, etc. were updated using only the .restart operator, and were not reinitialized to 0 from run to run.
* updated baselines for all systems except methylene D2 association

2008-6-09 Dave Glowacki

* change the timeEvolution and produceInitialPopulationVector member functions in reaction.cpp in order to integrate
  a new member function, produceEquilibriumVector
* perform timeEvolution calculations using long double precision, necessitating changes of variable from double to long
  double in some other functions
* decrease the number of time steps for which output data is printed in mesmer.test

2008-6-09 Dave Glowacki

* change the calculateEquilibriumFractions routine in ReactionManager.cpp so that eq fractions are calculated
  by inverting a matrix whose elements contain the equations describing the equilibrated system
* baselines updated

_2008_06_04__13_32_37_ Chi-Hsiu Liang

  * Delete FFTW first. Will add it back later when the test is completed.

2008-6-04 Dave Glowacki

* updates to manual

_2008_06_04__12_34_00_ Chi-Hsiu Liang

  * Add a folder to store fast-Fourier transform library.
  * Added an inversion function in dMatrix

2008-6-03 Dave Glowacki

* add comments to code

_2008_06_03__09_50_25_ Chi-Hsiu Liang

  * Correction on the Boltzmann distribution on symmetrizing collision operator of CollidingMolecule
  * Removed unnecessary code in IsomerizationReaction.cpp
  * Corrected   bool ReactionManager::produceInitialPopulationVector()

2008-6-02 Dave Glowacki

* updates to manual

2008-6-02 Dave Glowacki

* updates to manual

_2008_06_02__10_08_50_ Chi-Hsiu Liang

* Minor modification to   bool ReactionManager::timeEvolution(int maxTimeStep, const MesmerEnv mEnv)

2008-6-01 Struan Robertson

  * dMatrix.h: Introduction of inversion method and other minor changes requied to remove Supermolecules.

2008-6-01 Struan Robertson

  * Reaction.h: Moved reactant definitions onto to derived classes.
  * Minor tidying up.

_2008_05_31__17_18_15_ Chi-Hsiu Liang

  * Update baselines.
    The equilibrium constant for an association reaction of previous baselines were calculated from dividing product
    rovibronic partition function by combined contribution of the rovibronic partition function of reactant 1 and reactant 2,
    translation, and then time the expression by the excess reactant concentration. Since the density of states for 2-D linear
    rotors were not correct, so the baseline of OH acetylene system has to be updated.
    Also in the equilibrium constant of association reaction, from Version 141, dividing Qpdt1 by Qrcts, instead of (Qrct1 * Qrct2),
    and added a checkpoint there to see the difference between (Qrct1 * Qrct2) and Qrcts.
    I have changed the code of 2-D linear rotors in Version 141 but only update the baselines in this version. The eigenvalues
    of OH-acetylene system is now closer to Dave's old code.

2008-5-31 Struan Robertson

  * CollidingMolecule.cpp/Matrix.h: Move normalization method back to colliding molecule class for the present. Matrix class should be used for linear algebra only.

_2008_05_30__16_46_28_ Chi-Hsiu Liang

  * Move double m_ERConc (excess reactant concentration) from AssociationReaction to be a SuperMolecule member variable.
  * Added bool MesmerEnv::grainedProfileEnabled   --> print species profile before summation
          double MesmerEnv::maxEvolutionTime      --> for user to choose maximum length of time the species profile can evolve.
  * Updated   bool ReactionManager::calculateEquilibriumFractions(const double beta) to include excess reactant concentration.
  * Updated   bool ReactionManager::timeEvolution(int maxTimeStep, const double beta) to print out individual species profile.
  * Added comment for equilibrium fraction routine. See the end of ReactionManager.cpp: _2008_05_30__12_48_35_
  * Still need to sort out the specie profile for sink terms. Also need to consider if the sink term has only one product.

2008-5-30 David Glowacki

* add manual (oops!)

2008-5-30 David Glowacki

* add and delete various comments
* add an initial version of the MESMER User's manual to the documentation section

_2008_05_24__15_59_03_ Chi-Hsiu Liang

  * Corrected the population fraction routine so that it only gives the population fraction of the range we are interested.
    -- please refer to normalizedGrainDistribution()
  * Renamed grnCanPrtnFn() to rovibronicGrnCanPrtnFn() to indicate that it includes the rotation, vibration and electronic degeneracies
  * Isolate out translational contribution of two molecules to a function called translationalContribution() in MesmerTools.h
  * Corrected the calculation of DOS on 2-D linear rotors.
  * Not sure if the Boltzmann distribution of HSO2 is right?
  * Basic structure of producing species profile is done; needs debugging.
    -- please refer to calculateEquilibriumFractions(), produceInitialPopulationVector() and timeEvolution().
  * Add m_eigenvalues to ReactionManager

_2008_05_21__10_51_16_ Chi-Hsiu Liang

  * Update baselines for all test systems.
  * There is probably a memory leak in Mesmer. Need to find out what variables are not initialized properly.
    -- Problem: When turn on <me:printGrainDOS /> in pentyl_isomreization.xml, the eigenvalues calculated deviate from when this flag
                is off, however the differences are small. The problem maybe from the precision change in the calculation.

_2008_05_19__16_34_38_ Chi-Hsiu Liang

  * Added a plug-in class for calculating distribution. This plug-in can be used to produce either cell or grain
    distribution fractions. Please check for calculateDistributionFractions()
    -- This function will be responsible for the distribution of a species. In case not a Boltzmann distribution, an additional
       plug-in class will be required.
  * isomers and sources are now member varaibles of ReactionManager. They are cleared every time when the system collision operator
    is built.
  * Add a function for time evolution calculation, which generates time-dependent species profiles. (not complete)
  * Added a variable m_population in all CollidingMolecule and SinkMolecule.
  * Force 1st member of SuperMolecule be CollidingMolecule. Need to think about how to treat association of identical molecules.
  * Added a class a2d_t for making dynamic two-dimensional matrix.
  * Need to adjust cellEne for offset.

2008-5-18 Struan Robertson

  * SimpleILT.cpp: remove dependency on Supermolecules.
  * 0ther minor tidying.

_2008_05_13__09_30_00_ Chi-Hsiu Liang

  * Mesmer now force an DissociationReaction to have two products. Zero-point energy of the products are required for drawing
    potential energy surface in XML output and tunneling calculation.
  * Added virtual functions get_rctZPE() and get_pdtZPE() in Reaction, they return the ZPE's of reactant(s) and product(s),
    relative to the deepest well bottom. (Considering to prevent user from using get_zpe(), as this
    function returns raw ZPE's of the molecules. Will make it private/protected later.)
  * Microrate Calculator now calculates transition state flux instead of k(E)s
  * removed virtual bool grnAvrgMicroRateCoeffs(); added virtual void calcGrainRateCoeffs() in all reaction
    types for converting TSFlux to k(E)s
  * Added  m_ActivationEnergy   in AssociationReaction
  * An additional option for getting k(E)s only, without building collision operators (me:calculateRateCoefficinetsOnly)
    -- Removed AddMicroRates() and rearranged codes within BuildSystemCollisionOperator(MesmerEnv &Env) for control purposes.
  * calcDensityOfStates() now decides whether to recalculate the DOS or not.
  * Added cell offset variable in ModelledMolecule to account for the cell shifts when converting from cell to grain
    -- see shiftCells(), set_grainValues() and m_cellOffset
  * Added a function double ModelledMolecule::get_relative_ZPE() that returns ZPE in wavenumber relative to the ZPE
    of the deepest well bottom.
  * change m_grnZpe from int to double
  * bool SetGrainParams() is now moved to ReactionManager, user can choose whether to use the same number of cells
    throughout various conditions.
  * Added getHeatOfReactionInt() in Reaction, which force all energy values in integral wavenumbers. If energy values are
    in double the calculation of heat of reaction may differ by one wavenumber. For example,
    If the product ZPE is 9.1, and reactant ZPE is 42.8, the heat of reaction calculated in double will be -33.7, which
    is -34 when rounded to int. But if these ZPE are rounded before the HoR is calculated, the HoR will be -33.
  * Move m_pdt1 to all derived classes of Reation. In DissociationReaction and ExchangeReaction, it is only a ModelledMolecule.
  * Added
    virtual double get_relative_rctZPE(void) const = 0;
    virtual double get_relative_pdtZPE(void) const = 0;
    virtual double get_relative_TSZPE(void) const = 0;
    for class Reaction. These functions return species ZPE's of a reaction in wavenumber relative to the deepest well bottom.
  * Updated Makefile
  * Added a derived class SinkMolecule
    -- Moved m_Mass to ModelledMolecule and BathGasMolecule, moved m_Sigma and m_Epsilon to CollidingMolecule
       and BathGasMolecule.
  * qd_real and dd_real are still not working in this version; therefore, I commented them out.

2008-04-26 Chris Morley

  * Made projects for static libraries for TinyXML and qd within the solution.
    Left only linux qd files and used the source files for the Windows build.
    Configuration files are copied as a pre-build event.
    Although its not implemented yet, it looks like the choice of precision is
    expected to be at compile-time, but would it not be better to be an option
    in the input file? (i.e. at runtime)

2008-4-23 David Glowacki

  * change the name of Cyclopropene_isomerization.xml to Cyclopropene_isomerization_test.xml
  * add comments to simpleRRKM class
  * update the pentyl baseline, which had not been done since version 106

_2008_04_23__10_12_19_ Chi-Hsiu Liang

  * Added a comment on equilibrium constant
  * Added a planning block for the TimeEvolution() loop (not yet defined)

_2008_04_22__11_14_43_ Chi-Hsiu Liang

Updated file dependencies

_2008_04_22__10_55_37_ Chi-Hsiu Liang

  * Convert zero-point energy to wavenumber and concentration to number density while parsing.
  * Further clean up some error report messages.
  * Added a function XmlReadPropertyAttribute() to Persistence.h and XmlPersist.h/.cpp for reading attribute of the property
   (such as unit of energy)
  * reset initialization of m_HeatOfReaction to nothing. For dissociation, this value should be NaN if not defined.
  * Added unitConversion.h/.cpp for converting units.

_2008_04_21__10_17_30_ Chi-Hsiu Liang

  * Further tidy up the errorMsg and some previous debug flags.

2008-4-18 David Glowacki

  * replace supermolecule pointers with modelledmolecule pointers
  * alter simplerrkm, remove reference to supermolecule
  * update HSO2 baseline

2008-4-18 David Glowacki

  * clean up reaction manager.cpp
  * clean up mesmerilt.cpp
  * clean up AssociationReaction.cpp

_2008_04_18__11_28_41_ Ch-Hsiu Liang

  * Input the units of concentration by a string instead of meaningless number
  * removed some debugflags

2008-4-18 David Glowacki

  * moved subsidiary reactant 2 from reaction.h to the derived classes association and exchange
  * change ActivationEnergy to ThresholdEnergy

2008-4-18 David Glowacki

  * moved subsidiary product 2 from reaction.h to the derived classes dissociation and exchange

_2008_04_18__09_28_31_ Chi-Hsiu Liang

Change back MesmerHP to double in dMatrix.h

2008-4-17 David Glowacki

  * created pure virtual methods in reaction.h for describing detailed balance in association, isomerization, exchange, and dissociation reactions
  * updated baselines for HSO2 & cyclopropene
  * replace max grain size variable to use member data m_ncolloptrsize in collidingmolecule

2008-4-17 David Glowacki

  * corrected collision operator initialization routine
  * added cyclopropene baseline + input file

2008_04_17__11_44_02_ Chi-Hsiu Liang

  * Updated baseline for association reaction
  * review of association equilibrium constant


2008-4-17 David Glowacki

  * EckartCoefficients.cpp:  add comments to clarify.

2008-1-27 Struan Robertson

  * Reaction.h:  Declare methods InitializeReaction and calcEquilibriumConstant
  pure virtual, and associated changes.

2008-1-27 Struan Robertson

  * Reaction.h:  Move all public data to protected data, and concomitant changes.

_2008_04_04__14_25_39_ Chi-Hsiu Liang

  * renamed grnDensityOfStates() -> getGrainDensityOfStates()
  * Changed detailed balance on the cell level to the grain level
  * Corrected codes where DOS and rate coefficients are not referenced to the well bottom.
  * EAboveWell renamed to EAboveHill to reflect that this energy value is above the highest hilltop
    but not the highest well bottom
  * Code for setting grain ZPE of all speices
  * Corrected getClassicalEnergy()
  * rename grnAvg() -> rateConstantGrnAvg()
  * put minEnergy in ReactionManager.cpp to ReactionManager.h as m_minEnergy
  * Add a short section in ReactionManager.cpp (Line 147 - 182) to set grain ZPE for all speices
  * setup basic constants and derived constants in Constants.h

_2008_03_27__14_49_28_ Chi-Hsiu Liang

  * Added a plugin class for Tunneling
  * Added getClassicalEnergy() for calculating classical electronic for molecules (without ZPE corrections)
  * Added a member m_Description in Molecule class for more detailed description of any molecule.
  * Added m_ImFreq for Tunneling parameter in TransitionState
  * Renamed BeyerSwinehart.h to convolution.h
  * Added EckartCoefficients.h (method for Tunneling )
  * Added condition loop (DOS only calculated once, other parameters updated in every loop).
  * Problem: If there are several conditions defined, it seems XML file only records the final calculated condition.

_2008_03_14__17_43_39_ Chi-Hsiu Liang

  * Concentrations and pressures are not directly interconvertable. They relate each other with temperature
  and other factors. Inputting concentration by particles per cubic centimeter and converting it to mols is direct
  , but for pressures we need conversion through idea gas constant and temperature. So these parameters has to come
  in pairs: <concentration, temperature> or <pressure, temperature>.

    //--------------
    //  The concentration/pressure units are of following formats:
    //  units:
    //   0: particles per cubic centimeter
    //   1: Torr
    //
    //  Allowed input formats are shown below (example units in particles per cubic centimeter).
    //
    //  <me:CPTs>
    //    <me:CPTset me:units="0">
    //      <me:CPrange initial="1e8" increment="2e7" final="2e8">
    //      <me:Trange initial="100" increment="20" final="200">
    //    </me:CPTset>
    //  </me:CPTs>
    //
    //  The above example will create a matrix of concentration/temperature points of the size:
    //      (number of CP points) x (number of T points)
    //
    //  Another example of specifying small numbers of CPT points (example units in Torr):
    //
    //  <me:CPTs>
    //    <me:CPTpair me:units="1" me:CP="100" me:T="200">
    //    <me:CPTpair me:units="0" me:CP="1e18" me:T="298">
    //  </me:CPTs>
    //
    //  The looping of the CPT points are easy, they are first parsed and all the points are stored in pairs in
    //  vector CPandTs, and Mesmer simply loop through all its members.
    //--------------

_2008_03_13__15_53_37_ Chi-Hsiu Liang

  Change the zpe numbers of pentyl system and HSO2 system so that they are kJ/mol

_2008_03_13__12_14_38_ Chi-Hsiu Liang

  Return the constants changed from 107-108.

_2008_01_31__19_01_16_ Chi-Hsiu Liang

  * Removed all KcalPerMolToRC in Mesmer. This made the calculation slow. The input units are SI.
    (It might be worthwhile to convert the activation energy to RC directly from the function get_ActivationEnergy()
    can provide automatic unit conversion if the input units are not SI.)
  * See whether destructors of base/derived classes are virtual.
  * Implementation of Bayer_Swinehart.h
  * Add a function Matrix<T>::showFinalBits(int) in Matrix.h to print out the final bits of the matrix.
  * Added forward and backward cell/grain microcanonical rate constants
  * Change the number of digits on the exponents in cygwin. (formatfloat.h)
  * Modified a bit on Matrix<T>::normalize()
  * Added several flags to print data in mesmer.test. Check MesmerEnv.cpp and System.cpp line 133-142 for detail.
  * calculateMicroRateCoeffs() now has only one input parameter.
  * Created files for each class in Molecule.cpp to
      TransitionState.cpp
      SuperMolecule.cpp
      ModelledMolecule.cpp
      CollidingMolecule.cpp
      BathGasMolecule.cpp
  * Removed most of the accessor functions from Molecule.h to cpp files.
  * Moved destructor definition for MoleculeManager to MoleculeManager.cpp
  * Corrected the sequence of initialization of MessageHandler on oberror.h
  * Things about the activation energy has to be reconsidered. The experimental activation energy does not have to be
    consistent with the relative zero-point energy of the transition state. An option to add activation energy in the
    reaction list by user can also to be considered (not implemented yet).
  * Added a function detailedBalance(int) to interconvert forward and backward microcanonical rate constants.
  * Can also virtualize grnAvrgMicroRateCoeffs() for variations in different reaction classes later.
  * Should there only be either H or SO2 have ZPE = 39.44?
  * Added QD for Windows in qd folder.
      Additional steps to add QD library in Windows VC: (to be placed in documentation)
        1. One might build QD using qd.vcproj in debug mode to see if there are any errors.
        2. Build the project as a Release.
        3. In Mesmer property pages -> Configuration Properties -> C/C++ -> General -> Additional include directories
           Put "../../qd/Windows VC/include" into the list.
        4. In Mesmer property pages -> Configuration Properties -> Linker -> Input -> Additional dependencies
           Put "qd.lib" into the list.
        5. ?? How to link qd.dll? Program cannot execute!!

  * Other minor modifications.

2008-1-27 Struan Robertson

  * Re-implemented association reaction initialization and equilibrium constant
    methods.
  * Introduced excess reactant concentration for association reactions.


_2008_01_14__16_48_41_ Chi-Hsiu Liang

  * Modified Mesmer.dvi, Mesmer.tex.
  * Corrected OH_acetylene_association.xml. Updated OH_acetylene_association baseline.
  * Added several control sequence printing values. See MesmerEnv.h for additional control flags.
    Printing:
      grain density of states
      cell density of states
      collision operator column sums
      cell k(e)'s
      number of eigenvalues being printed
    Also, values are enclosed by braces, easier for copying and comparing.
  * Moved some longer definitions of accessors in Molecule.h to Molecule.cpp
  * Note: There should have a complaint over missing parameter on epsilon and sigma from HSO2, but the program will run with
          default values. (Need to give correct values.)
  * Updated pentyl and HSO2 baselines. HSO2 baseline does not change but pentyl baseline change because of the rounding
    difference between two versions. There are three differences on ClassicalRotor.cpp. also for the electron excitation
    energy. Another difference is on the starting count of electron excitation energy.
  * Other minor modifications.

2008-1-13 Struan Robertson

  * Elimination of the reaction type enumerated variable.

2008-1-13 Struan Robertson

  * Declared method InitializeReaction virtual and re-implemented it for
    isomerization class.

_2008_01_08__09_35_40_ Chi-Hsiu Liang

  * Deleted logged test files in \trunk\Windows VC8\Mesmer (anyone needs them shall copy them from the history)
  * Cleaned up the code. (No tabs, one tab converts to two spaces.)
  * removed a bug in source term persistent pointer locating.
  * Added a test system OH acetylene association.
  * Added a variable m_ERConc for excess reactant concentration in the Reaction.

2007-12-30 Struan Robertson

  * Made method get_unimolecularspecies pure virtual and re-implemented it on
    the derived classes.

2007-12-30 Struan Robertson

  * Added four new classes for each of the reaction types. These classes derive
    from the Reaction calss whihc is now an abstract class.

  * Updated QA files to reflect changes made to I/O.

2007-12-14 Chris Morley

  * Re-write of error handling and commandline. Big changes to
    oberro.h, oberror.cpp and main.cpp.

  * rename obErroLog to meErrorLog.

  * persistence.h: note about function names starting with Xml.
  * XMLPersist.cpp part of implementation to read from stdin (incomplete).

_2007_12_13__15_58_20_ Chi-Hsiu Liang

  * Prevented Elements of source molecule from duplication.

_2007_12_13__10_49_05_ Chi-Hsiu Liang

  * Corrected some default pointer types for ModelledMolecule and CollidingMolecule
  * Change back the default value for EAboveWell
  * Change the order of parsing molecule list and reaction list, this including:
    1. addmols() -> addmol()
    2. source term numbering (initially source_0)
    3. Modified GetMolRef() to add molecule and return its pointer

_2007_12_07__16_30_57_ Chi-Hsiu Liang

  * Check redundancy for m_deltaEDown, m_RotConsts, m_Sym, m_ZPE
  * privatize m_VibFreq
  * add get_deltaEDown()
  * Added m_NInf in Reaction
  * There seems to be something wrong in the code but I cannot tell where it is. I have set a flag
    if you look for this timestamp in the code: _2007_12_07__16_01_51_
    So if anyone has time to check what's wrong with it. I will keep on doing what I was doing.
    The problem looks like if I change this line (I know the syntax is wrong so I have modified it to the correct one),
    the collision operator will not be initialized correctly, which is a bit strange.

_2007_12_05__19_19_09_ Chi-Hsiu Liang

  * Added codes for input file parameters redundancy check in Molecule
  * Updated destructors in System to Molecule level. Let distructors report redundancies.
  * Added electronic excitation. (in DOS calculation and xml input.)
  * Set EAboveWell as a member of m_Env (later will add it into the xml input)
  * still need to put ninf in somewhere of xml.
  * other minor modifications

_2007_12_04__11_17_27_ Chi-Hsiu Liang

Updated baseline for Cygwin 32-bit double.

_2007_12_04__10_04_16_ Chi-Hsiu Liang

Allow user to input filename after program starts.

2007-12-2  Struan Robertson

  * Corrected the method of addition of isomer collision opertators to overall
  collision matrix.
  * Checked-in initial revision of Mesmer QA.

2007-11-30 Chris Morley

  * Removed Mesmer.exe from SVN. Compiled files are not usually in SVN
   and it always caused error messages when updating.

  * mEnv revamp.
  I've given Molecule and Reaction a member variable m_Env - a constant
  reference which is initiallised in the constructors. This avoids it
  being a parameter in lots of functions, reducing clutter in the place
  where the action is, even if the constructors are more complicated.
  Affects a large number of files.


_2007_11_28__17_40_29_ Chi-Hsiu Liang

  * Added some more error report in Molecule.cpp
  * some other corrections
  ToDo: 1. Automatically calculate the mass of a molecule from the atom list if the user forgot to provide it.

_2007_11_28__13_21_33_ Chi-Hsiu Liang

  * Corrected some issues in the order calculating density of states for molecules
  * If no pDOSCMethod or wrong is provided default method Classical rotors is used.
  * Added test_rotConsts() in Molecule.cpp
  * modified calcEquilibriumConstant() in Reaction.cpp (added the check for the consistency of partition function
    in SuperMolecule and the product of respective partition function of reactants. They should be equal.
    May include error later.)

_2007_11_27__12_39_58_ Chi-Hsiu Liang

  * Some corrections over the error checking on parsing.
  * Added spin multiplicity in the multiplication of DOS in monomer.
  * Modified the return type of get_unimolecularspecies(), the old method is not clear whether the inserted argument
    is for output or input.
  * Add a source term in m_molmap whenever if there isn't one. No matter if it is necessary to have a source or not. (See
    the end of addmols() in MoleculeManager.cpp)
  * Problem: sL variable out of range in the vector in AddAssocReactionTerms(), the reason is that the m_CellDOS not initialized
    properly for source term.
  * Added Windows VC8/Mesmer/HSO2_test.xml for test.

_2007_11_26__14_10_23_ Chi-Hsiu Liang

  * Corrected the usage on GetNextMolecule() in line 110 of Reaction.cpp
  * Todo: 1. need to check testDensityOfStates() for both ModelledMolecule and SuperMolecule
          2. test systems, check AddAssocReactionTerms()

_2007_11_23__17_26_41_ Chi-Hsiu Liang

  * Added two static variables sigmaDefault, and epsilonDefault.
  * Some comments on dMatrix.cpp
  * Modified some information reports.
  * reorganised some orders of molecular initialization.
  * Added setPersistentPointer() for Molecule
  * Added some codes in MoleculeManager.cpp & Reaction.cpp about adding SuperMolecule (some errors still exist)
  * Problem for SuperMolecule: 1. After adding a SuperMolecule into m_molmap, still cannot use GetNextMolecule() to
                               retrieve it!?
                               2. Matrix diagonalization does not converge.

_2007_11_22__10_57_55_ Chi-Hsiu Liang

  * modified some tags in bin/pentyl_isomerizationJul.xml
                          bin/OH_acetylene_association.xml
                          Windows VC8/Mesmer/pentyl_isomerization.xml
                          Windows VC8/Mesmer/pentyl_isomerizationJul.xml

  * modified function names: cellEnergies() -> getCellEnergies
                             cellDensityOfStates -> getCellDensityOfStates
    for the fact that these two functions only performs get functionality. Note: Result credibility should check before
    execution.
  * Added files ClassicalRotor.cpp/h, DensityOfStates.cpp/h
  * Moved counterDimerDOS() to a plugin class DensityOfStatesCalculator (DensityOfStates.h)
  * modified the original ModelledMolecule::calcDensityOfStates() so that it governs the calculation of DOS in both
    ModelledMolecule and SuperMolecule
  * m_VibFreq temporarily become a public variable (if necessary will add accessors and privatize it later)
  * Added DensityOfStatesCalculator *m_pDensityOfStatesCalculator ; in ModelledMolecule.
  * Added functions to get individual member of participant Molecules in SuperMolecule
  * Important: Now all isomers have to be specified `colliding' instead of being only `modelled' in xml.
               Both second reactant/product are ModelledMolecule. Please read MoleculeManager.cpp
               line 33 to line 44.
  * Important: Added a tag me:DOSCMethod in each molecular element of XML input.
               This makes it possible to use different methods to calculate the DOS in different species.
  * Added a new function addSuperMol() in MoleculeManager
  * rearranged the variable definition and function declaration order in Reaction.h
  * Add bool return to BuildSystemCollisionOperator()
  * Add another test file Windows VC8\Mesmer\OH_acetylene_association.xml

  To do Next: 1. Debug
              2. Add an element in xml file for SuperMolecule.
              3. Test systems.

_2007_11_15__18_37_45_ Chi-Hsiu Liang

  * Added a new class SuperMolecule (originally pairedMoleucles)
    Note: This new class is derived from CollidingMolecule; in addition, it includes two pointers to CollidingMolecule and
          ModelledMolecule respectively. This class takes the position of the source terms, any of which composed of two
          reactant molecules in an association reaction. All SuperMolecule(s) go into sources.
  * Added a new member SuperMolecule* m_srct in Reaction to represent the reactants.
  * Added int return values for get_unimolecularspecies and get_bi_molecularspecies (to differntiate reactions on the fly)
  * Errors, warnings and progress information all report to oberror.
  * rearranged the order of variables/functions in Molecule.h
  * Other minor modifications
  * Note: Need to solve initialization of some pointers here. Later develop plugin to calculate density of states etc of
          whatever.

_2007_11_13__11_17_57_ Chi-Hsiu Liang

  * modified the starting position of iteration in AddAssocReactionTerms() (consider revising)
  * Added a new class pairedMoleucles
  * privatise protected member variables in Molecule.h & setup accessors/mutators for these variables
  * rearranged the order initializing a molecule in classes
  * Changed temp into beta
  * include dMartix and Matrix into namespace mesmer
  * removed some typecast warnings in VC compiler
  * removed m_alloc
  * Add lines in bool MoleculeManager::addmols() preventing user from inputting duplicated molecules
  * Modified oberror report level from obWarning to obInfo.
  * moved m_SpinMultiplicity to ModelledMolecule
  * some other minor modifications

2007-10-21  Struan Robertson

	* Molecule.cpp/Reaction.cpp: Added methods to calcualte equilibrium
        constant.
        * Reaction.cpp: Altered secondary reactant and product to be
        ModelledMolecule.

_2007_11_02__16_40_03_ Chi-Hsiu Liang

  * modified the way of classifying rotors
  * modified calcDensityOfStates() & testDensityOfStates() for additional rotors
  * still cannot calculate microcanonical rate constants correctly, keep on checking.
  * A sample file OH_acetylene_association.xml is provided to check association.

_2007_11_02__15_08_13_ Chi-Hsiu Liang

  * modified MesmerILT.cpp --- now it is a working (testing not complete) version of ILT, but need to modify
    ModelledMolecule::calcDensityOfStates() to account for 2-D linear rotors & non-rotors.
  * Added some error reporting for InitializeMolecule()
  * Added get_VibFreq() in Molecule.h
  * other minor modifications

_2007_11_01__18_14_46_ Chi-Hsiu Liang

  * Modified MesmerILT.cpp
  * renamed variables: m_MmtIntA, m_MmtIntB, m_MmtIntC to m_RotCstA, m_RotCstB, m_RotCstC respectively.

_2007_10_31__15_47_13_ Chi-Hsiu Liang

  * Added lines to sort rotational constants
  * Added a function countDimerCellDOS() to deal with convolution of DOS for two rotors (not complete)
  * Some other minor modifications

_2007_10_26__13_54_21_ Chi-Hsiu Liang

  * removed parenthesis after constructor of Reaction (looks like more than a declaration)
  * commented out default constructor of ReactionManager (if do nothing let the compiler choose what to do)
  * Modified naming of function:  XmlLoad() -> XmlCreate()
  * Modified class MesmerEnv to struct
  * Modified MesmerILT.cpp
  * Put convolution in MesmerMath.h
  * Added m_SpinMultiplicity as a member of Molecule
  * Modified namings of variables: m_Reactant -> m_rct1
                                   m_Reactant1 -> m_rct2
                                   m_Product -> m_pdt1
                                   m_Product1 -> m_pdt2
  * Added Reaction::get_bi_molecularspecies()
  * Added MesmerMath.cpp
  * Compiled MesmerILT.cpp (some variables and DOS formulations are not complete)
  * Updated source.ps
  * Some other minor modifications

2007-10-21  Struan Robertson

	* Molecule.cpp: Added method to calculate Bolzmann distribution.
	* Reaction.cpp: Added material to assocation reaction section. Note
          need a method to calcualte equilibrium constant.

_2007_10_10__08_20_39_ Chi-Hsiu Liang

  * removed pSys, GetSys() and m_pSys
  *-----------------------------------------
  * About MesmerEnv
  * added `MesmerEnv.h' and `MesmerEnv.cpp'
  * moved environmental variables from `System.h' to `MesmerEnv.h'
  * environmental variables are now included in a variable instance mEnv
  * mEnv is a public member of System, lives and dies with System object
  * mEnv is passed down to functions in const, instead of passing whole system
  * New instance of System can be threaded safely with all variables self-contained. e.g. vector of systems
  *-----------------------------------------
  * replace <math.h> by <cmath> (for several math function auto-conversions)
  * renamed `System' variable in main.cpp to _sys
  * reorganised file dependencies
  * updated source.ps
  * removed ReactionConnectivity.cpp/h

_2007_10_08__13_38_55_ Chi-Hsiu Liang

  * Removed QD/DD/double flags in files: dMatrix.h, Molecule.cpp
  * Modified platform specific definition checks: MesmerConfig.h
  * Commented out TimeString()
  * use ctime instead of time.h
  * Writes new style time stamp in xml files
  * Now checks with compilation in VC++
  * Updated source.ps

_2007_10_05__14_00_29_ Chi-Hsiu Liang

  * Removed CXSC

_2007_10_05__13_30_14_ Chi-Hsiu Liang

  * Some CXSC flags
    CXSC is considered too slow. So will be deleted afterward. This version is only a record for future reference.

_2007_10_04__11_59_35_ Chi-Hsiu Liang

  * Updated "Mesmer FAQ.doc"
  * Updated source.ps
  * modified main.cpp so that the output filename is date stamped.
  * added TimeCounter.cpp
  * Modified TimeCounter.h
    Time stamp can now be applied to occasions where proper. Please check TimeCounter.h for usage.

_2007_10_03__11_06_49_ Chi-Hsiu Liang

  * Added the CXSC library source code folder
    Sorry, forgot to add CXSC library code for everyone. Please install it in your own computer, e.g. /usr/cxsc , etc..
    Usage (in UNIX/Linux/Mac?):
    Type the following command in command line mode under the directory of cxsc.
    ./install_cxsc
  * variable declarations in MesmerPrecision.h

_2007_10_03__10_42_44_ Chi-Hsiu Liang

  * Added selection of QD/DD/CXSC (CXSC not yet implemented/tested, but has linked)
  * Removed the error from the previous commit in Matrix.h
  * Added TimeCount header for time measuring and stamping
    TimeCount can be accessed through several functions listed in TimeCount.h to be used by anyone uses Mesmer.
    Examples are also listed.
  * Commented out some unused type definitions in matrix.h
  * Some other minor modifications

_2007_09_28__14_16_39_ Chi-Hsiu Liang

  * QD for double-double and quad-double precisions.
  * Move normalization function into matrix.h
  * Completed writing of MesmerILT.cpp but not linked and tested.
  * Modified namings of variables:  ngrn -> MaximumGrain
  * Add README, MesmerPrecision.h
  * Mesmer FAQ file in documentation folder
  * Other minor modifications

_2007_09_25__10_31_44_ Chi-Hsiu Liang

  * Add a ToDo file
  * Add qd source into trunk directory
  * Precision definitions in MesmerConfig.h
  * More edits to MesmerILT.cpp
  * Modified namings of variables:  kfmc -> cellKfmc
                                    m_kfgrn -> m_GrainKfmc
                                    m_kfmc -> m_CellKfmc
                                    dosGrn -> grainDOS
                                    eGrn -> grainEne
                                    m_gdos -> m_grainDOS
                                    m_egrn -> m_grainEne
                                    rctDos -> rctDOS
                                    pdtDos -> pdtDOS

  * change CellEne and CellDOS to vectors
  * some other minor modifications

_2007_09_14__16_30_42_ Chi-Hsiu Liang

  * checked for new and delete declarations
  * reordered some dependencies
  * Modified namings of variables:  decll -> CellEne,
                                    ddos -> CellDOS,
                                    m_cdos -> m_CellDOS,
                                    m_ecll -> m_CellEne,
                                    pcollidingmolecule -> pCollidingMolecule,
                                    KCMLTOPCM -> KcalPerMolToRC,
                                    ddosTS -> TScellDOS,
                                    boltzmann -> boltzmann_RCpK
                                    pi -> M_PI

  * Modified naming of functions: Initialize() -> InitializeMolecule(),
                                  Initialize() -> InitializeReaction(),
                                  igsz() -> getGrainSize(),

  * updated source.ps
  * added MesmerILT.cpp, MesmerILT.h, MesmerMath.h (for Gamma function)

2007-09-04 Chi-Hsiu Liang

	* in Molecule.cpp, function void CollidingMolecule::collisionOperator(double beta):
			vector<double> work only needs to have size GetSys()->MAXGrn()
	* Question:
			In Molecule.cpp, line 388, double ei = log(m_gdos[i]) - beta*m_egrn[i] + 10.0; why adding 10.0
			if the 10.0 power of ten will be cancelled in line 397:         (*m_egme)[j][i] *= (work[i]/work[j]);
			Any special meaning?
	* Removed duplicated files MicroRateCalculator.cpp & .h
	* pre-fix function names of XML operations with Xml to remove ambiguity.
	* added some varieties for MesmerConfig.h (not sure about platform specification rules)
	* altered some i++, j++ to ++i, ++j for better efficiency
	* other minor modifications
	* Now compile with i386 RedHat Linux

2007-09-02 Chris Morley

	* added a partial data file for Dave's benzene system
	(enough for the diagram) Updated the xsl files to improve
	diagram.

2007-08-31 Chi-Hsiu Liang

	* cygwin rules
	* formatfloat.h includes
	* additional Makefile commands
	* Now compile with cywgin
	* Updated source.ps
	* Other minor code format adjustments (Molecule.h/cpp, MoleculeManager.cpp, etc.)
	* Resolved some g++ compiler complaints.

2007-08-29 Chi-Hsiu Liang

	Minor modifications on three header files, and merge with the
	current modifications.
	Update the dependency tree.

2007-08-29 Chris Morley

	Make separate headers for SimpleRRKM.cpp and SimpleILT.cpp.
	Rename x versions.

	* src/MesmerConfig.h: separate header to take all platform-
	dependent defines.

	Remove global pSys. Add member variable m_pSys and GetSys()
	to MoleculeManager, ReactionManager, Molecule and Reaction.
	Pass down a pointer to the System during construction or
	Initialization.

	* src/main.cpp: add mesmer:: to obErrorLog. Remove pSys.

	Include math.h in MicroRate.cpp and Molecule.cpp

2007-08-23 Chi-Hsiu Liang

	1. The dependencies are reorganised for simplicity.
	2. util.cpp deleted (conflict with formatfloat.cpp/h)
	3. Incoporated oberror.h functions into mesmer.
	4. Tabs are reformatted into two spaces.
	5. Removed tailing spaces for some files.
	6. A file source.ps provided to explain the dependencies for the current version.

2007-08-19  Struan Robertson

	* Minor changes relating to the Linux build.

2007-08-18  Struan Robertson

	* src/ReactionManager.cpp:  Added material related to association
        reactions together with some minor changes relating to dissociation
        reactions.

        * Windows VC8/Mesmer/pentyl_isomerization.xml: Updated the pentyl
        isomerization input file to include dissociation reactions.

2007-08-08  Chris Morley

	Add the error handling files oberror.h and oberror.cpp. These are
	slightly modified OpenBabel files. Not yet used in Mesmer code.

2007-07-28  Chris Morley

	Various xml, xsl, etc file. Display of output file has energy level
	diagram  and collapsable data sections.

2007-07-28  Chris Morley

	* src/MicroRate.cpp, .h, src/SimpleILTx.cpp, src/SimpleRRKMx.cpp:
	Mod of MicroRateCalulator classes to be plugin classes and to keep
	all their data in the Reaction class.

	* src/Molecule.h, .cpp: Remove diagCollisionOperator which is also
	in ReactionManager

	* Persistence.h, XMLPersist.h,.cpp:Add ReadBoolean() and WriteAttribute
	methods. Activate Read() and modify WriteMainElement(). More flexibilty
	found to be necessary.

	* src.System.h,.cpp:Add ReadRange() method and use it for T, P and conc.
	Not yet used properly in calculation.

2007-07-21  Struan Robertson

        * src/MicroRateCalculator.cpp/.h: Separated micro-rate calcuator base
        class into separate file and added test method to this class.

        * src/SimpleILT.cpp/.h: Added implementation of simple dissociation ILT
        method.

2007-07-09  Struan Robertson

        * src/Reaction.cpp/.h: Separated micro-rate calcuation code into
        calculator classes.

        * src/SimpleRRKM.cpp/.h and SimpleILT.ccp/.h calculator classes added to
        calculate micro. rate coeffs. via RKKM and ILT respectively.

2007-06-12  Struan Robertson

        * src/Reaction.cpp/.h: Isomer reaction terms reviewed and simplified,
        unnecessary methods and variables removed.

2007-06-10  Struan Robertson

	* src/ReactionManager.cpp:  Altered to invoke reaction objects to add details
        of reaction to collision operator.

        * src/Reaction.cpp/.h: altered to include detailed balancing and others
        methods for adding isomer reaction terms to the collision operator

        * Minor changes to System and Molecule classes to support the above
        changes.

        * Update of Linux Makefile.

2007-06-07  Chris Morley

	* src/Molecule.h: Remove MAXCELL and MAXGRN and (unused)
	member variables. Make calcDensityOfStates public.

	* src/System.cpp: Read <me:ModelParameters> for(at present)
	grain sizes and set in SetGrainParams().

	* src/main.cpp: Add pSys as a global variable to System.
	Catch a couple of input errors.

	* src/MoleculeManager.h: Add templated function
	GetNextMolecule() for iterating through the molecules of
	a requested type.

	src/Reaction.h,cpp: Save and access reaction id.

2007-05-22  Struan Robertson

	* Minor update to allow collision frequency to be calculated for all isomers.

2007-05-20  Struan Robertson

	* src/ReactionManager.cpp/.h: Altered so that it no longer uses the
        ReactionConnectivety class.

        * src/MoleculeManager.cpp/.h: Accessor methods added to locate the bath
        gas molecule. This is required in the calculation of bath collision
        frequencies. Knock on changes required to Molecule.cpp/.h and System.cpp/
        .h

2007-01-29  Chris Morley

	I/O rewritten to improve code isolation and allow TinyXML
	to be replaced if necessary. See description in Persistence.h

	* src/XMLPersist.h, src/XMLPersist.cpp added.
	* src/Persistence.cpp removed
	* src/util.cpp added. Contains formatFloat(), now a global
	function.

	Extensive changes to:
	* src/Persistence.h, (IPersistObject rename to IPersist)
	and most other files.

2007-01-18  Chris Morley

	* src/Persistence.h, Persistence.cpp: Added output utility
	functions WriteElement(), WriteMainElement() and
	WriteValueElement(). In IPersistObject at present, but maybe
	they should be elswhere.

	* src/Molecule.h, Reaction.h: Added member variable to retain
	object address in XML document.

	* src/Molecule.cpp(testDensityOfStates): Output also to XML

	* src/Reaction.cpp(testMicroRateCoeffs): Output also to XML

	* src/pentyl_isomerization.xml: Correct extra " typos

	* Windows VC8/Mesmer/mesmer1.xsl: Added. Provides formating when
	XML file viewed in a browser.

2007-01-18  Chris Morley

	* tinyxml/tinyxmlparser.cpp: small patch to allow xml-stylesheet
	instuction to be passed on. See:
	http://sourceforge.net/tracker/index.php?func=detail&aid=1618031&group_id=13559&atid=313559

	* src/main.cpp: Can specify output file with default of adding
	out before extension on inputfile name. Added usage function and some exit codes.

